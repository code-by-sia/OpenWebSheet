{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/FormulaBar.vue?4a0d","webpack:///./src/RibbonMenu.vue?b8dc","webpack:///./src/StatusBar.vue?8e66","webpack:///./src/OpenSheet.vue?a150","webpack:///./src/components/ColorPicker.vue?0781","webpack:///./src/components/ActionGroup.vue?e91a","webpack:///./src/components/ControlBox.vue?9c70","webpack:///./src/components/ActionButton.vue?0052","webpack:///./src/lib/core/formula/Evaluator.ts","webpack:///./src/components/CellBorderStyle.vue?305f","webpack:///./src/App.vue?77b8","webpack:///./src/RibbonMenu.vue?d10b","webpack:///./src/components/Ribbon.vue?5e11","webpack:///./src/components/Ribbon.vue?b53c","webpack:///./src/components/Ribbon.vue?cede","webpack:///./src/components/Ribbon.vue","webpack:///./src/components/ControlBox.vue?2181","webpack:///./src/components/ControlBox.vue?82d6","webpack:///./src/components/ControlBox.vue?2f2c","webpack:///./src/components/ControlBox.vue","webpack:///./src/components/CellBorderStyle.vue?43b0","webpack:///./src/components/CellBorderStyle.vue?7aa2","webpack:///./src/components/CellBorderStyle.vue?fab7","webpack:///./src/components/CellBorderStyle.vue","webpack:///./src/components/FontSizeSelector.vue?2989","webpack:///./src/components/FontSizeSelector.vue?b442","webpack:///./src/components/FontSizeSelector.vue?37f2","webpack:///./src/components/FontSizeSelector.vue","webpack:///./src/components/ActionGroup.vue?7869","webpack:///./src/components/ActionButton.vue?00f4","webpack:///./src/components/ActionButton.vue?8270","webpack:///./src/components/ActionButton.vue?ec0a","webpack:///./src/components/ActionButton.vue","webpack:///./src/components/ActionGroup.vue?803c","webpack:///./src/components/ActionGroup.vue?8c07","webpack:///./src/components/ActionGroup.vue","webpack:///./src/components/ColorPicker.vue?d464","webpack:///./src/components/ColorPicker.vue?d0c2","webpack:///./src/lib/core/Appearance.ts","webpack:///./src/components/ColorPicker.vue?8049","webpack:///./src/components/ColorPicker.vue","webpack:///./src/components/FontNameSelector.vue?4247","webpack:///./src/components/FontNameSelector.vue?d6d6","webpack:///./src/components/FontNameSelector.vue?491e","webpack:///./src/components/FontNameSelector.vue","webpack:///./src/RibbonMenu.vue?22cb","webpack:///./src/RibbonMenu.vue?490c","webpack:///./src/RibbonMenu.vue","webpack:///./src/FormulaBar.vue?9705","webpack:///./src/FormulaBar.vue?076b","webpack:///./src/FormulaBar.vue?08ff","webpack:///./src/FormulaBar.vue","webpack:///./src/OpenSheet.vue?4e09","webpack:///./src/lib/core/Cell.ts","webpack:///./src/lib/common/constants.ts","webpack:///./src/lib/core/Sheet.ts","webpack:///./src/lib/common/utils.ts","webpack:///./src/lib/core/Commander.ts","webpack:///./src/lib/rendering/canvas/LayoutDirection.ts","webpack:///./src/lib/core/Document.ts","webpack:///./src/lib/rendering/canvas/ContextMask.ts","webpack:///./src/lib/rendering/canvas/Context.ts","webpack:///./src/lib/rendering/canvas/Point.ts","webpack:///./src/lib/rendering/canvas/CanvasRendering.ts","webpack:///./src/lib/editor/CellEditor.ts","webpack:///./src/lib/editor/UIHandler.ts","webpack:///./src/lib/editor/DocumentHandler.ts","webpack:///./src/lib/editor/SheetUIHandler.ts","webpack:///./src/lib/editor/ResizeHandler.ts","webpack:///./src/lib/editor/UIHandlerControler.ts","webpack:///./src/lib/UI.ts","webpack:///./src/OpenSheet.vue?8675","webpack:///./src/OpenSheet.vue?e09b","webpack:///./src/OpenSheet.vue","webpack:///./src/SheetSelector.vue?af57","webpack:///src/SheetSelector.vue","webpack:///./src/SheetSelector.vue?ba24","webpack:///./src/SheetSelector.vue","webpack:///./src/StatusBar.vue?6fd7","webpack:///./src/StatusBar.vue?bccc","webpack:///./src/StatusBar.vue?7f1b","webpack:///./src/StatusBar.vue","webpack:///./src/App.vue?ec60","webpack:///./src/App.vue?640d","webpack:///./src/App.vue","webpack:///./src/registerServiceWorker.ts","webpack:///./src/main.ts","webpack:///./src/components/Ribbon.vue?62e4"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","Env","ranges","dataProvider","txt","_M_E_","this","_R_A_N_G_E_","PI","Math","E","SUM","selector","reduce","x","y","MIN","min","MAX","max","SIN","v","sin","COS","cos","TAN","tan","ASIN","asin","ACOS","acos","ATAN","atan","ASINH","asinh","ACOSH","acosh","ATANH","atanh","ABS","abs","SQRT","sqrt","CBRT","cbrt","LOG","log","EXP","exp","TRUNC","trunc","CEIL","ceil","FLOOR","floor","eval","getEvaluatedValue","Evaluator","str","regex","valueRegex","temp","range_index","exec","index","lastIndex","forEach","match","groupIndex","indexOf","replace","ev","Eval","substr","err","_vm","_h","$createElement","_c","_self","attrs","appearance","state","on","onModeChanged","onAction","label","onCommit","onAbort","model","callback","$$v","$set","expression","ref","onReady","onChange","staticRenderFns","menu","active","slot","staticStyle","staticClass","$event","changeMode","_v","fontFamily","fontSize","fontStyle","foreColor","fillColor","textAlignment","onAlign","class","isMerged","toggleMerge","borderColor","onBorderChanged","_l","item","_s","_t","newValue","$emit","required","component","style","display","grid","_e","default","directives","rawName","$$selectedVal","Array","filter","target","options","selected","map","val","_value","selectedSize","multiple","size","domProps","sizes","action","disabled","components","ActionButton","$slots","composing","color","TextAlign","BorderStyle","SolidThin","border","Border","textAlign","Left","fontName","toLowerCase","Right","Center","Error","horizontalBorder","verticalBorder","textStyle","ensureTextStyle","bold","italic","app","Appearance","text","background","from","selectedFamily","family","families","fileMode","newMode","borderStructure","alignment","actionName","args","activeStyle","underline","newSize","newFont","FontFamilySelector","ColorPicker","ActionGroup","FontSizeSelector","CellBorderStyle","ControlBox","Ribbon","formula","_m","newFormula","columnId","rowId","colSpan","rowSpan","reference","_columnId","_rowId","evaluated","evaluatedValue","format","formattedValue","to","update","top","left","bottom","right","cell","Cell","SheetTitleHeight","SheetTitleWidth","ColumnHeaderHeight","RowHeaderWidth","RowDefaultHeight","COLOR_LIGHT","COLOR_1","COLOR_2","COLOR_3","title","defaultAppearance","defaultRowHeight","defaultColumnWidth","columnAppearance","rowAppearance","rowHeight","columnWidth","scrollX","scrollY","change_listeners","selection","single","selectNextRowCell","invalidSelection","selectNextColumnCell","selectPreviousRowCell","selectPreviousColumnCell","parts","split","a","getCellPos","b","res","getCellEvaluatedValue","undefined","silent","forceGetCell","startsWith","updateDependees","removeCell","scrollColumn","getColumnWidth","getColumnLeft","scrollRow","getRowHeight","getRowTop","colX","colId","colW","rowY","findColumnIdByX","findRowIdByY","getCell","x1","y1","x2","y2","stop","sbottom","sleft","sright","selectedCell","ftop","fbottom","fleft","fright","scroll","height","width","parseInt","setCell","xcell","cx","row","column","getCellAppearance","col","getColumnAppearance","getRowAppearance","def","handler","ix","measure","Sheet","get_columnName","test","pos","getColumnIndex","sum","pwr","st","ch","charCodeAt","setCellValue","setCellAppearance","getCellName","getAppearance","az","columnString","columnNumber","currentLetterNumber","currentLetter","sheet","sh","fill","clone","obj","JSON","parse","stringify","LayoutDirection","doc","history","commands","font","topBorder","noBorder","leftBorder","rightBorder","bottomBorder","outsideBorder","crossBorder","setVertical","setHorizontal","merge","unmerge","align","alignTextTo","changeValue","delta","alterColumn","alterRow","commandName","has","console","warn","logAppearanceOnlyCommand","horizontal","vertical","sel","Selection","ActiveSheet","historyItem","SelectedAppearance","SelectionData","w","meta","setColumnWidth","h","setRowHeight","logDataOnlyCommand","method","apps","sheets","activeSheetIndex","init","commander","addOnChange","cmd","do","save","load","addSheet","get_right","get_bottom","get_width","get_height","get_left","get_top","ContextMask","context","direction","LeftToRight","fillStyle","strokeStyle","strokeSize","contentFillStyle","maskStack","context2d","measureText","translate","currentMask","cmask","rect","clip","restore","affectPreviousMask","get_directed_x","get_combinedMask","pop","clearRect","applyFill","beginPath","fillRect","applyStroke","strokeRect","stroke","moveTo","lineTo","close","point","drpx","drx","closePath","points","internalPath","applyContent","textWidth","get_textWidth","fillText","grd","createLinearGradient","stops","addColorStop","lineWidth","trim","path","container","document","rendering","renderFrameRate","initialize","render","createElements","resize","canvas","createElement","appendChild","pixelRatio","devicePixelRatio","clientWidth","clientHeight","getContext","scale","setTimeout","doRender","get_context2D","renderSheetTitles","renderSheet","cornerWidth","fillClosePath","renderTopCorner","rHeight","createGradient","Sheets","sheetWidth","getWidth","line","sheetTitleHeight","maskHeight","setMask","lastRow","renderRows","lastColumn","renderColumns","unmask","renderCells","cumulativeHeight","rw","paintRow","toString","cumulativeWidth","cl","paintColumn","cellHeight","getCellHeight","cellWidth","getCellWidth","paintCell","horStyle","verStyle","controler","editMode","websheet","select","editorArea","position","overflow","renderer","Element","selectionElement","transitionDuration","editorElement","type","zIndex","textIndent","forceEditMode","EditMode","addEventListener","anchorElement","borderRadius","cursor","SelectedValue","Value","updateEditorAppearance","getCurrentCell","IsDirty","execCommand","getCurrentAppearance","getTextAlign","fontWeight","textDecoration","animation","enableAnimation","disableAnimation","getColumnRight","getRowBottom","editorY","editorX","focus","readOnly","controller","dx","dy","evt","lock","unlock","locked","changeActiveSheet","wheelDeltaX","wheelDeltaY","scrollRight","scrollLeft","scrollUp","scrollDown","oldX","oldY","selectCell","commit","shiftKey","deselect","preventDefault","selectByXY","engaged","hitColumn","hitRow","changeCursor","resetCursor","rowH","handlers","lockedOn","cellEditor","addHandlers","attachEvents","uiHandler","element","overlay","getXY","offsetX","layerX","clientX","offsetLeft","offsetY","layerY","clientY","offsetTop","getTouchXY","touch","touches","changedTouches","mouseDown","mouseMove","mouseUp","click","dblClick","mouseWheel","stopPropagation","keyDown","keyPress","keyUp","ActiveSheetIndex","uiController","raiseOnChangeEventListener","openDocument","SelectionLabel","command","ui","execCmd","file","$refs","addOnChangeEventListener","originalValue","uiManager","localStorage","setItem","onLoad","onSave","getItem","win","File","FileReader","FileList","Blob","f","accept","files","reader","loadEvt","rawData","readAsText","alert","content","uriContent","encodeURIComponent","download","href","StatusBar","SheetSelector","OpenSheet","FormulaBar","RibbonMenu","ready","registered","cached","updatefound","updated","offline","error","config","productionTip","$mount"],"mappings":"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","file":"js/app.1a3f57e0.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/OpenWebSheet/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./FormulaBar.vue?vue&type=style&index=0&id=88f8b63a&lang=scss&scoped=true&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./FormulaBar.vue?vue&type=style&index=0&id=88f8b63a&lang=scss&scoped=true&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./RibbonMenu.vue?vue&type=style&index=0&id=18ab77ce&scoped=true&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./RibbonMenu.vue?vue&type=style&index=0&id=18ab77ce&scoped=true&lang=css&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./StatusBar.vue?vue&type=style&index=0&id=2c4dd48e&lang=scss&scoped=true&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./StatusBar.vue?vue&type=style&index=0&id=2c4dd48e&lang=scss&scoped=true&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./OpenSheet.vue?vue&type=style&index=0&id=6835bc7c&scoped=true&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./OpenSheet.vue?vue&type=style&index=0&id=6835bc7c&scoped=true&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ColorPicker.vue?vue&type=style&index=0&id=1bf526e3&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ColorPicker.vue?vue&type=style&index=0&id=1bf526e3&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionGroup.vue?vue&type=style&index=0&id=5f4b089e&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionGroup.vue?vue&type=style&index=0&id=5f4b089e&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBox.vue?vue&type=style&index=0&id=fd2a2e58&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBox.vue?vue&type=style&index=0&id=fd2a2e58&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionButton.vue?vue&type=style&index=0&id=13139c76&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionButton.vue?vue&type=style&index=0&id=13139c76&lang=scss&scoped=true&\"","export interface IDateProvider {\n  getEvaluatedValue(key: string): any;\n}\n\n\nclass Env {\n  constructor(private ranges: any, private dataProvider: any) {\n  }\n\n  public Eval(txt: string) {\n    const _M_E_ = this;\n    const _R_A_N_G_E_ = this.ranges;\n\n    const PI = Math.PI;\n    const E = Math.E;\n\n    function SUM(selector: any) {\n      return _M_E_.data(selector).reduce((x: number, y: number) => x * 1 + y * 1, 0);\n    }\n\n    function MIN(selector: any) {\n      return _M_E_.data(selector).reduce((x: number, y: number) => Math.min(x * 1, y * 1), 0);\n    }\n\n    function MAX(selector: any) {\n      return _M_E_.data(selector).reduce((x: number, y: number) => Math.max(x * 1, y * 1), 0);\n    }\n\n    function SIN(v: number) {\n      return Math.sin(v);\n    }\n\n    function COS(v: number) {\n      return Math.cos(v);\n    }\n\n    function TAN(v: number) {\n      return Math.tan(v);\n    }\n\n    function ASIN(v: number) {\n      return Math.asin(v);\n    }\n\n    function ACOS(v: number) {\n      return Math.acos(v);\n    }\n\n    function ATAN(v: number) {\n      return Math.atan(v);\n    }\n\n    function ASINH(v: number) {\n      return Math.asinh(v);\n    }\n\n    function ACOSH(v: number) {\n      return Math.acosh(v);\n    }\n\n    function ATANH(v: number) {\n      return Math.atanh(v);\n    }\n\n    function ABS(v: number) {\n      return Math.abs(v);\n    }\n\n    function SQRT(v: number) {\n      return Math.sqrt(v);\n    }\n\n    function CBRT(v: number) {\n      return Math.cbrt(v);\n    }\n\n    function LOG(v: number) {\n      return Math.log(v);\n    }\n\n    function EXP(v: number) {\n      return Math.exp(v);\n    }\n\n    function TRUNC(v: number) {\n      return Math.trunc(v);\n    }\n\n    function CEIL(v: number) {\n      return Math.ceil(v);\n    }\n\n    function FLOOR(v: number) {\n      return Math.floor(v);\n    }\n\n\n    return eval(txt);\n  }\n\n  private data(selector: any) {\n    return this.dataProvider.getEvaluatedValue(selector);\n  }\n}\n\nexport class Evaluator {\n\n  public static Eval(dataProvider: IDateProvider, str: string) {\n    if (str.length < 1 || str[0] != '=') {\n      return str;\n    }\n\n    let m;\n    const regex = this.valueRegex;\n    let temp = str;\n\n    const ranges: any[] = [];\n    let range_index = 0;\n    while ((m = regex.exec(str)) !== null) {\n      // This is necessary to avoid infinite loops with zero-width matches\n      if (m.index === regex.lastIndex) {\n        regex.lastIndex++;\n      }\n\n      m.forEach((match, groupIndex) => {\n        if (match && match.indexOf(':') != -1) {\n          ranges.push(match);\n          temp = temp.replace(match + '', `_R_A_N_G_E_[${range_index++}]`);\n        } else if (groupIndex == 0) {\n          const ev = dataProvider.getEvaluatedValue(match);\n          temp = temp.replace(match, ev);\n        }\n      });\n    }\n\n    try {\n      return new Env(ranges, dataProvider).Eval(temp.substr(1));\n    } catch (err) {\n      return '#ERR';\n    }\n\n  }\n\n\n  private static valueRegex = /(([a-zA-Z]+[0-9])+\\:?([a-zA-Z]+[0-9]+)?)/g;\n\n\n}\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CellBorderStyle.vue?vue&type=style&index=0&id=10426fd3&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CellBorderStyle.vue?vue&type=style&index=0&id=10426fd3&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('ribbon-menu',{attrs:{\"appearance\":_vm.appearance,\"state\":_vm.state},on:{\"mode-changed\":_vm.onModeChanged,\"action\":_vm.onAction}}),_c('formula-bar',{attrs:{\"label\":_vm.state.label},on:{\"commit\":_vm.onCommit,\"abort\":_vm.onAbort},model:{value:(_vm.state.value),callback:function ($$v) {_vm.$set(_vm.state, \"value\", $$v)},expression:\"state.value\"}}),_c('open-sheet',{ref:\"sheet\",on:{\"ready\":_vm.onReady,\"change\":_vm.onChange}}),_c('status-bar')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('ribbon',{attrs:{\"menu\":_vm.menu},model:{value:(_vm.active),callback:function ($$v) {_vm.active=$$v},expression:\"active\"}},[_c('div',{attrs:{\"slot\":\"menu-home\"},slot:\"menu-home\"},[(_vm.isLocalMode)?_c('control-box',{attrs:{\"label\":\"Local Storage\"}},[_c('span',{staticStyle:{\"display\":\"flex\",\"align-content\":\"center\",\"flex-direction\":\"column\",\"align-items\":\"center\"}},[_c('i',{staticClass:\"far fa-times-circle xx-large-font flat-button\",on:{\"click\":function($event){return _vm.changeMode('file')}}}),_c('span',{staticStyle:{\"padding\":\"5px\"}},[_vm._v(\" Back to file mode \")])])]):_c('control-box',{staticClass:\"last\",attrs:{\"label\":\"Document\"}},[_c('div',{staticStyle:{\"display\":\"flex\",\"padding\":\"10px 5px\",\"text-align\":\"center\"}},[_c('i',{staticClass:\"fas fa-save x-large-font flat-button\",on:{\"click\":function($event){return _vm.onAction('save-ows')}}}),_c('span',{staticClass:\"seperator\"}),_c('i',{staticClass:\"fas fa-folder x-large-font flat-button\",on:{\"click\":function($event){return _vm.onAction('load-ows')}}}),_c('span',{staticClass:\"seperator\"}),_c('i',{staticClass:\"fas fa-warehouse x-large-font flat-button\",on:{\"click\":function($event){return _vm.changeMode('local')}}})])]),_c('control-box',{staticClass:\"independent\",attrs:{\"label\":\"Font\"}},[_c('p',[_c('font-family-selector',{model:{value:(_vm.fontFamily),callback:function ($$v) {_vm.fontFamily=$$v},expression:\"fontFamily\"}}),_c('font-size-selector',{model:{value:(_vm.fontSize),callback:function ($$v) {_vm.fontSize=$$v},expression:\"fontSize\"}})],1),_c('p',[_c('action-group',{staticStyle:{\"float\":\"left\",\"margin-right\":\"15px\"},attrs:{\"value\":_vm.fontStyle},on:{\"action\":_vm.onAction}},[_c('i',{staticClass:\"fa fa-bold\",attrs:{\"slot\":\"bold\"},slot:\"bold\"}),_c('i',{staticClass:\"fa fa-italic\",attrs:{\"slot\":\"italic\"},slot:\"italic\"}),_c('i',{staticClass:\"fa fa-underline\",attrs:{\"slot\":\"underline\"},slot:\"underline\"})]),_c('color-picker',{model:{value:(_vm.foreColor),callback:function ($$v) {_vm.foreColor=$$v},expression:\"foreColor\"}},[_c('i',{staticClass:\"fas fa-palette\"})])],1)]),_c('control-box',{staticClass:\"last\",attrs:{\"label\":\"Format\"}},[_c('p',[_c('color-picker',{attrs:{\"label\":\"Fill color\"},model:{value:(_vm.fillColor),callback:function ($$v) {_vm.fillColor=$$v},expression:\"fillColor\"}},[_c('i',{staticClass:\"fa fa-fill\",attrs:{\"slot\":\"prefix\"},slot:\"prefix\"})])],1),_c('p',[_c('action-group',{attrs:{\"value\":_vm.textAlignment},on:{\"action\":_vm.onAlign}},[_c('i',{staticClass:\"fa fa-align-left\",attrs:{\"slot\":\"left\"},slot:\"left\"}),_c('i',{staticClass:\"fa fa-align-center\",attrs:{\"slot\":\"center\"},slot:\"center\"}),_c('i',{staticClass:\"fa fa-align-right\",attrs:{\"slot\":\"right\"},slot:\"right\"})])],1)]),_c('control-box',{staticClass:\"independent\",attrs:{\"label\":\"Cell\"}},[_c('p',[_c('action-button',{class:{on:_vm.state.isMerged},attrs:{\"label\":\"Merge\"},on:{\"click\":_vm.toggleMerge}},[_c('i',{staticClass:\"fa fa-th\",attrs:{\"slot\":\"prefix\"},slot:\"prefix\"})])],1),_c('p',[_c('color-picker',{attrs:{\"label\":\"Border\"},model:{value:(_vm.borderColor),callback:function ($$v) {_vm.borderColor=$$v},expression:\"borderColor\"}})],1)]),_c('control-box',{attrs:{\"label\":\"Borders\"}},[_c('cell-border-style',{on:{\"change\":_vm.onBorderChanged}})],1)],1),_c('div',{attrs:{\"slot\":\"menu-formulas\"},slot:\"menu-formulas\"},[_c('control-box',{staticStyle:{\"flex\":\"1\"},attrs:{\"label\":\"Mathematical\"}}),_c('control-box',{staticClass:\"last\",staticStyle:{\"flex\":\"1\"},attrs:{\"label\":\"Statistics\"}}),_c('control-box',{staticClass:\"independent\",staticStyle:{\"flex\":\"3\"},attrs:{\"label\":\"User Defined Functions\"}})],1),_c('div',{attrs:{\"slot\":\"menu-data\"},slot:\"menu-data\"},[_c('control-box',{attrs:{\"label\":\"File\"}},[_c('div',{staticStyle:{\"margin\":\"10px 20px\"}},[_c('i',{staticClass:\"fa fa-file-excel\",staticStyle:{\"font-size\":\"xx-large\"}})])]),_c('control-box',{attrs:{\"label\":\"Open Office\"}},[_c('action-group',{attrs:{\"value\":[{name:'import',label:'Import'},{name:'export',label:'Export'}]}})],1),_c('control-box',{staticClass:\"last\",staticStyle:{\"flex\":\"1\"},attrs:{\"label\":\"MS Excel\"}},[_c('action-group',{attrs:{\"value\":[{name:'import',label:'Import'},{name:'export',label:'Export'}]}})],1),_c('control-box',{staticStyle:{\"flex\":\"4\"},attrs:{\"label\":\"3rd Parties\"}})],1),_c('div',{attrs:{\"slot\":\"menu-view\"},slot:\"menu-view\"},[_c('control-box',{attrs:{\"label\":\"Print\"}},[_c('div',{staticStyle:{\"margin\":\"5px 20px\"}},[_c('i',{staticClass:\"fa fa-print\",staticStyle:{\"font-size\":\"xx-large\"}})])]),_c('control-box',{staticStyle:{\"flex\":\"1\"},attrs:{\"label\":\"Layout\"}})],1),_c('div',{staticStyle:{\"flex\":\"1\"},attrs:{\"slot\":\"menu-info\"},slot:\"menu-info\"},[_c('control-box',{attrs:{\"label\":\"OSI\"}},[_c('span',{staticStyle:{\"font-size\":\"xx-large\",\"color\":\"#00454d\",\"font-weight\":\"bold\"}},[_c('i',{staticClass:\"fab fa-osi\"})])]),_c('control-box',{staticStyle:{\"flex\":\"1\"},attrs:{\"label\":\"About Open Web Sheet Project\",\"grid\":false}},[_c('span',{staticStyle:{\"flex\":\"1\"}},[_vm._v(\" Designed and developed by \"),_c('strong',[_vm._v(\"Siamand\")]),_c('br'),_vm._v(\" 3rd Parties: \"),_c('strong',[_vm._v(\"FontAwesome Icons\")]),_vm._v(\" & \"),_c('strong',[_vm._v(\"Google noto web font\")]),_c('br'),_vm._v(\" Licence: \"),_c('strong',[_vm._v(\"MIT Licence\")])]),_c('span',{staticStyle:{\"align-self\":\"flex-start\"}},[_c('a',{attrs:{\"href\":\"https://siamand.cc\"}},[_c('i',{staticClass:\"fa fa-link\"}),_vm._v(\" Developer's site\")]),_vm._v(\" | \"),_c('a',{attrs:{\"href\":\"https://github.com/code-by-sia/OpenWebSheet\"}},[_c('i',{staticClass:\"fab fa-github\"}),_vm._v(\" Source Code\")])])])],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"ribbon-menu\"},[_c('ul',{staticClass:\"menu\",attrs:{\"data-qa\":\"menu\"}},_vm._l((_vm.menu),function(item){return _c('li',{key:item.name,staticClass:\"menu-label\",class:{'active':_vm.active===item.name},attrs:{\"data-qa\":item},on:{\"click\":function($event){_vm.active = item.name}}},[_vm._v(\" \"+_vm._s(item.label)+\" \")])}),0),_c('div',{staticClass:\"menu-content\"},_vm._l((_vm.menu),function(item){return _c('div',{key:item.name,staticClass:\"menu-content-item\",class:{'active': (_vm.active === item.name)}},[_vm._t(item.name,[_c('fieldset',[_c('legend',[_vm._v(_vm._s(item.label))]),_c('span',{staticClass:\"default-place-holder\"},[_vm._v(\"placeholder for \"+_vm._s(item.name))])])])],2)}),0)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\nimport { Component, Prop, Vue } from 'vue-property-decorator';\nimport { RibbonMenuItem } from '@/components/RibbonMenu';\n\n@Component({name: 'Ribbon'})\nexport default class Ribbon extends Vue {\n  @Prop({required: true})\n  public value!: string;\n\n  @Prop({required: true})\n  public menu!: RibbonMenuItem[];\n\n  get active() {\n    return this.value;\n  }\n\n  set active(newValue) {\n    this.$emit('input', newValue);\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ribbon.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ribbon.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Ribbon.vue?vue&type=template&id=244e0240&scoped=true&\"\nimport script from \"./Ribbon.vue?vue&type=script&lang=ts&\"\nexport * from \"./Ribbon.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Ribbon.vue?vue&type=style&index=0&id=244e0240&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"244e0240\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"control-box\",attrs:{\"data-qa\":\"control-box\"}},[_c('div',{staticClass:\"control-box-controls\",style:({display:_vm.grid?'grid':'flex'}),attrs:{\"data-qa\":\"content\"}},[_vm._t(\"default\")],2),(_vm.label)?_c('div',{staticClass:\"control-box-header\",attrs:{\"data-qa\":\"header\"}},[_vm._v(_vm._s(_vm.label))]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\nimport { Component, Prop } from 'vue-property-decorator';\nimport Vue from 'vue';\n\n@Component({name: 'ControlBox'})\nexport default class ControlBox extends Vue {\n  @Prop()\n  public label?: string;\n\n  @Prop({default: true})\n  public grid!: boolean;\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBox.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBox.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ControlBox.vue?vue&type=template&id=fd2a2e58&scoped=true&\"\nimport script from \"./ControlBox.vue?vue&type=script&lang=ts&\"\nexport * from \"./ControlBox.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ControlBox.vue?vue&type=style&index=0&id=fd2a2e58&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"fd2a2e58\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"cell-border-style\",attrs:{\"data-qa\":\"cell-border\"}},[_c('div',{staticClass:\"borders all\",attrs:{\"data-qa\":\"full\"},on:{\"click\":function($event){return _vm.$emit('change','full-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders inside\",attrs:{\"data-qa\":\"cross\"},on:{\"click\":function($event){return _vm.$emit('change','cross-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders horizontal\",attrs:{\"data-qa\":\"hor\"},on:{\"click\":function($event){return _vm.$emit('change','horizontal-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders vertical\",attrs:{\"data-qa\":\"ver\"},on:{\"click\":function($event){return _vm.$emit('change','vertical-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders outside\",attrs:{\"data-qa\":\"out\"},on:{\"click\":function($event){return _vm.$emit('change','outside-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders left\",attrs:{\"data-qa\":\"left\"},on:{\"click\":function($event){return _vm.$emit('change','left-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders top\",attrs:{\"data-qa\":\"top\"},on:{\"click\":function($event){return _vm.$emit('change','top-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders right\",attrs:{\"data-qa\":\"right\"},on:{\"click\":function($event){return _vm.$emit('change','right-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders bottom\",attrs:{\"data-qa\":\"bottom\"},on:{\"click\":function($event){return _vm.$emit('change','bottom-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders\",attrs:{\"data-qa\":\"no\"},on:{\"click\":function($event){return _vm.$emit('change','no-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\nimport { Component } from 'vue-property-decorator';\nimport Vue from 'vue';\n\n@Component({name: 'cell-border-style'})\nexport default class CellBorderStyle extends Vue {\n\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CellBorderStyle.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CellBorderStyle.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./CellBorderStyle.vue?vue&type=template&id=10426fd3&scoped=true&\"\nimport script from \"./CellBorderStyle.vue?vue&type=script&lang=ts&\"\nexport * from \"./CellBorderStyle.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./CellBorderStyle.vue?vue&type=style&index=0&id=10426fd3&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"10426fd3\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.selectedSize),expression:\"selectedSize\"}],staticClass:\"font-size\",on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.selectedSize=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},_vm._l((_vm.sizes),function(size){return _c('option',{key:size,domProps:{\"value\":size}},[_vm._v(\" \"+_vm._s(size)+\" \")])}),0)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\nimport { Component, Prop } from 'vue-property-decorator';\nimport Vue from 'vue';\n\n@Component({name: 'font-size-selector'})\nexport default class FontSizeSelector extends Vue {\n  @Prop({default: 12})\n  public value!: number;\n\n  public sizes = [6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 20, 22, 24, 26, 28, 32, 36, 48, 72];\n\n  get selectedSize() {\n    return this.value;\n  }\n\n  set selectedSize(newValue: number) {\n    this.$emit('input', newValue);\n    this.$emit('change', newValue);\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FontSizeSelector.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FontSizeSelector.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./FontSizeSelector.vue?vue&type=template&id=0c8e833d&\"\nimport script from \"./FontSizeSelector.vue?vue&type=script&lang=ts&\"\nexport * from \"./FontSizeSelector.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"action-group\",attrs:{\"data-qa\":\"action-group\"}},_vm._l((_vm.actions),function(action){return _c('action-button',{key:action.name,staticClass:\"action-group-item\",class:{'on':action.selected},attrs:{\"disabled\":action.disabled,\"data-qa\":\"action-item\",\"data-qa-name\":action.name},on:{\"click\":function($event){return _vm.$emit('action',action.name)}}},[_vm._t(action.name,[_vm._v(\" \"+_vm._s(action.label)+\" \")])],2)}),1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('button',{staticClass:\"action\",attrs:{\"disabled\":_vm.disabled,\"data-qa\":\"action\"},on:{\"click\":function($event){return _vm.$emit('click')}}},[_vm._t(\"default\",[_vm._t(\"prefix\"),_vm._v(\" \"+_vm._s(_vm.label)+\" \"),_vm._t(\"postfix\")])],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop } from 'vue-property-decorator';\nimport Vue from 'vue';\n\n@Component({name: 'ActionButton'})\nexport default class ActionButton extends Vue {\n  @Prop()\n  public label?: string;\n\n  @Prop({default: false})\n  public disabled!: boolean;\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ActionButton.vue?vue&type=template&id=13139c76&scoped=true&\"\nimport script from \"./ActionButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./ActionButton.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ActionButton.vue?vue&type=style&index=0&id=13139c76&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"13139c76\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop } from 'vue-property-decorator';\nimport Vue from 'vue';\nimport Action from './Action';\nimport ActionButton from '@/components/ActionButton.vue';\n\n\n@Component({\n  name: 'ActionGroup',\n  components: {ActionButton},\n})\nexport default class ActionGroup extends Vue {\n  @Prop({required: true})\n  public value!: Action[];\n\n  get actions() {\n    return this.value;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionGroup.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionGroup.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ActionGroup.vue?vue&type=template&id=5f4b089e&scoped=true&\"\nimport script from \"./ActionGroup.vue?vue&type=script&lang=ts&\"\nexport * from \"./ActionGroup.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ActionGroup.vue?vue&type=style&index=0&id=5f4b089e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5f4b089e\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"color-picker\",attrs:{\"data-qa\":\"color-picker\"}},[_c('label',{attrs:{\"data-qa\":\"label\"}},[_vm._t(\"default\",[(!!_vm.$slots['prefix'])?_c('span',{staticClass:\"prefix\"},[_vm._t(\"prefix\")],2):_vm._e(),_vm._v(\" \"+_vm._s(_vm.label)+\" \"),_vm._t(\"postfix\")])],2),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.color),expression:\"color\"}],attrs:{\"type\":\"color\",\"data-qa\":\"input-el\"},domProps:{\"value\":(_vm.color)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.color=$event.target.value}}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\nimport { Component, Prop } from 'vue-property-decorator';\nimport Vue from 'vue';\n\n@Component({name: 'ColorPicker'})\nexport default class ColorPicker extends Vue {\n  @Prop({default: '#ffffff'})\n  public value!: string;\n\n  @Prop()\n  public label?: string;\n\n  get color() {\n    if (!this.value) {\n      return '#ffffff';\n    }\n    return this.value;\n  }\n\n  set color(newValue) {\n    this.$emit('input', newValue);\n  }\n}\n","import { Color } from '@/lib/common/types';\n\nexport enum TextAlign {\n  Left,\n  Right,\n  Center,\n}\n\nexport enum BorderStyle {\n  SolidThin,\n  SolidThick,\n  SolidDouble,\n  DottedThin,\n  DottedThick,\n  DashedThin,\n  DashedThick,\n  DotDashedThin,\n  DotDashedThick,\n}\n\nexport class Border {\n\n  public static from(data: { style: BorderStyle, color: string }): Border {\n    const border = new Border();\n    border.style = data.style;\n    border.color = data.color;\n    return border;\n  }\n\n  public style: BorderStyle = BorderStyle.SolidThin;\n  public constructor(public color: string | null = null) {\n\n  }\n}\n\nexport class Appearance {\n\n  public get bold() {\n    return !!(this.textStyle && this.textStyle.indexOf('bold') != -1);\n  }\n\n  public set bold(value: boolean) {\n    this.ensureTextStyle();\n    if (this.bold == value) { return; }\n    if (value) { this.textStyle = `${this.textStyle} bold`; } else { this.textStyle = this.textStyle.replace('bold', ''); }\n  }\n\n  public get italic() {\n    return !!(this.textStyle && this.textStyle.indexOf('italic') != -1);\n  }\n\n  public set italic(value: boolean) {\n    this.ensureTextStyle();\n    if (this.italic == value) { return; }\n    if (value) { this.textStyle = `${this.textStyle} italic`; } else { this.textStyle = this.textStyle.replace('italic', ''); }\n  }\n\n  public get underline() {\n    return !!(this.textStyle && this.textStyle.indexOf('underline') != -1);\n  }\n\n  public set underline(value: boolean) {\n    this.ensureTextStyle();\n    if (this.italic == value || !this.textStyle) { return; }\n    if (value) { this.textStyle = `${this.textStyle} underline`; } else { this.textStyle = this.textStyle.replace('underline', ''); }\n  }\n\n  public static from(data: {\n    textAlign: any,\n    textStyle: any,\n    fontName: string,\n    fontSize: number,\n    text: string,\n    background: string,\n    horizontalBorder: any,\n    verticalBorder: any,\n  }) {\n    const app = new Appearance();\n    app.textAlign = data.textAlign;\n    app.textStyle = data.textStyle;\n    app.fontName = data.fontName;\n    app.fontSize = data.fontSize;\n    app.text = data.text;\n    app.background = data.background;\n    app.horizontalBorder = data.horizontalBorder && Border.from(data.horizontalBorder);\n    app.verticalBorder = data.verticalBorder && Border.from(data.verticalBorder);\n\n    return app;\n  }\n  public textAlign: TextAlign = TextAlign.Left;\n  public fontName: string = 'Lato';\n  public fontSize: number = 12;\n  public textStyle: any;\n  public text: any;\n  public background: any;\n  public horizontalBorder?: Border | null;\n  public verticalBorder?: Border | null;\n\n  public alignTextTo(value: string) {\n    if (value.toLowerCase() == 'right') {\n      this.textAlign = TextAlign.Right;\n    } else if (value.toLowerCase() == 'center') {\n      this.textAlign = TextAlign.Center;\n    } else if (value.toLowerCase() == 'left') {\n      this.textAlign = TextAlign.Left;\n    } else {\n      throw new Error(`invalid text-align '${value}'`);\n    }\n\n  }\n\n  public setHorizontal(value: Color) {\n    this.horizontalBorder = new Border();\n    this.horizontalBorder.style = BorderStyle.SolidThin;\n    this.horizontalBorder.color = value;\n  }\n\n  public setVertical(value: Color) {\n    this.verticalBorder = new Border();\n    this.verticalBorder.style = BorderStyle.SolidThin;\n    this.verticalBorder.color = value;\n  }\n\n  private ensureTextStyle() {\n    if (!this.textStyle) {\n      this.textStyle = '';\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ColorPicker.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ColorPicker.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ColorPicker.vue?vue&type=template&id=1bf526e3&scoped=true&\"\nimport script from \"./ColorPicker.vue?vue&type=script&lang=ts&\"\nexport * from \"./ColorPicker.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ColorPicker.vue?vue&type=style&index=0&id=1bf526e3&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1bf526e3\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.selectedFamily),expression:\"selectedFamily\"}],staticClass:\"font-family\",attrs:{\"data-qa\":\"font-name-selector\"},on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.selectedFamily=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},_vm._l((_vm.families),function(family){return _c('option',{key:family,domProps:{\"value\":family}},[_vm._v(\" \"+_vm._s(family)+\" \")])}),0)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\nimport { Component, Prop } from 'vue-property-decorator';\nimport Vue from 'vue';\n\n@Component({name: 'font-family-selector'})\nexport default class FontFamilySelector extends Vue {\n  @Prop({default: 'Lato'})\n  public value!: string;\n\n  public families = ['Lato', 'Sans', 'Serif', 'Courier', 'Courier New'];\n\n  get selectedFamily() {\n    return this.value;\n  }\n\n  set selectedFamily(newValue: string) {\n    this.$emit('input', newValue);\n    this.$emit('change', newValue);\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FontNameSelector.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FontNameSelector.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./FontNameSelector.vue?vue&type=template&id=2e2433a7&\"\nimport script from \"./FontNameSelector.vue?vue&type=script&lang=ts&\"\nexport * from \"./FontNameSelector.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\nimport { Component, Prop } from 'vue-property-decorator';\nimport Vue from 'vue';\nimport { RibbonMenuItem } from '@/components/RibbonMenu';\nimport Ribbon from '@/components/Ribbon.vue';\nimport ControlBox from '@/components/ControlBox.vue';\nimport CellBorderStyle from '@/components/CellBorderStyle.vue';\nimport FontSizeSelector from '@/components/FontSizeSelector.vue';\nimport ActionGroup from '@/components/ActionGroup.vue';\nimport ColorPicker from '@/components/ColorPicker.vue';\nimport ActionButton from '@/components/ActionButton.vue';\nimport { Appearance, TextAlign } from '@/lib/core/Appearance';\nimport FontFamilySelector from '@/components/FontNameSelector.vue';\nimport { Color } from '@/lib/common/types';\n\n@Component({\n  name: 'RibbonMenu',\n  components: {\n    FontFamilySelector,\n    ActionButton, ColorPicker, ActionGroup, FontSizeSelector, CellBorderStyle, ControlBox, Ribbon,\n  },\n})\nexport default class RibbonMenu extends Vue {\n\n  get isLocalMode() {\n    return this.fileMode === 'local';\n  }\n\n  get activeStyle() {\n    return this.appearance || new Appearance();\n  }\n\n  get textAlignment() {\n    return [\n      {\n        name: 'left',\n        selected: this.activeStyle.textAlign === TextAlign.Left,\n      },\n      {\n        name: 'center',\n        selected: this.activeStyle.textAlign === TextAlign.Center,\n      },\n      {\n        name: 'right',\n        selected: this.activeStyle.textAlign === TextAlign.Right,\n      },\n    ];\n  }\n\n  get fontStyle() {\n    return [\n      {name: 'bold', selected: this.activeStyle.bold},\n      {name: 'italic', selected: this.activeStyle.italic},\n      {name: 'underline', selected: this.activeStyle.underline},\n    ];\n  }\n\n  get foreColor() {\n    return this.activeStyle.text;\n  }\n\n  set foreColor(color: string) {\n    this.onAction('fg-color', color);\n  }\n\n  get fillColor() {\n    return this.activeStyle.background;\n  }\n\n  set fillColor(color: string) {\n    this.onAction('bg-color', color);\n  }\n\n  get fontSize() {\n    return this.activeStyle.fontSize;\n  }\n\n  set fontSize(newSize: number) {\n    this.onAction('font-size', newSize);\n  }\n\n  get fontFamily() {\n    return this.activeStyle.fontName;\n  }\n\n  set fontFamily(newFont: string) {\n    this.onAction('font-name', newFont);\n  }\n  public active = 'menu-home';\n\n  @Prop()\n  public appearance!: Appearance;\n\n  @Prop({default: () => ({isMerged: true})})\n  public state!: { isMerged: boolean };\n\n  public borderColor: Color = 'black';\n\n  public menu: RibbonMenuItem[] = [\n    {name: 'menu-home', label: 'Home'},\n    {name: 'menu-formulas', label: 'Formulas'},\n    {name: 'menu-data', label: 'Data'},\n    {name: 'menu-view', label: 'View'},\n    {name: 'menu-info', label: 'About'},\n  ];\n  private fileMode = 'file';\n\n  public changeMode(newMode: string) {\n    this.fileMode = newMode;\n    this.$emit('mode-changed', newMode );\n  }\n\n  public onBorderChanged(borderStructure: string) {\n    this.onAction(borderStructure, this.borderColor);\n  }\n\n  public onAlign(alignment: string) {\n    this.onAction('align', alignment);\n  }\n\n  public toggleMerge() {\n    this.onAction(this.state.isMerged ? 'unmerge' : 'merge');\n  }\n\n  public onAction(actionName: string, args?: any) {\n    this.$emit('action', {actionName, args});\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./RibbonMenu.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./RibbonMenu.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./RibbonMenu.vue?vue&type=template&id=18ab77ce&scoped=true&\"\nimport script from \"./RibbonMenu.vue?vue&type=script&lang=ts&\"\nexport * from \"./RibbonMenu.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./RibbonMenu.vue?vue&type=style&index=0&id=18ab77ce&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"18ab77ce\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"formula-bar\",class:{active: _vm.active}},[_c('input',{staticClass:\"cell-name\",attrs:{\"type\":\"text\",\"placeholder\":\"SELECTION\"},domProps:{\"value\":_vm.label}}),_c('span',{staticClass:\"side\"},[_c('span',{staticClass:\"actions\"},[_c('i',{staticClass:\"fa fa-times cancel\",on:{\"click\":function($event){return _vm.$emit('abort')}}}),_c('i',{staticClass:\"fa fa-check commit\",on:{\"click\":function($event){return _vm.$emit('commit')}}})]),_vm._v(\" 𝑓𝑥 \")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.formula),expression:\"formula\"}],staticClass:\"formula\",attrs:{\"id\":\"formula-input\",\"type\":\"text\"},domProps:{\"value\":(_vm.formula)},on:{\"focusin\":function($event){_vm.active=true},\"focusout\":function($event){_vm.active=false},\"input\":function($event){if($event.target.composing){ return; }_vm.formula=$event.target.value}}}),_vm._m(0)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"arrow\"},[_c('i',{staticClass:\"fas fa-angle-down\"})])}]\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop } from 'vue-property-decorator';\nimport Vue from 'vue';\n\n@Component({name: 'FormulaBar'})\nexport default class FormulaBar extends Vue {\n  public active = false;\n\n  @Prop()\n  public value!: string;\n\n  @Prop()\n  public label!: string;\n\n  get formula() {\n    return this.value;\n  }\n\n  set formula(newFormula: string) {\n    this.$emit('input', newFormula);\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./FormulaBar.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./FormulaBar.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./FormulaBar.vue?vue&type=template&id=88f8b63a&scoped=true&\"\nimport script from \"./FormulaBar.vue?vue&type=script&lang=ts&\"\nexport * from \"./FormulaBar.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./FormulaBar.vue?vue&type=style&index=0&id=88f8b63a&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"88f8b63a\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"canvas-container\",staticClass:\"open-sheet\"})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export class Cell {\n\n  public get isMerged() {\n    return this.reference !== null;\n  }\n\n  public get columnId() {\n    return this._columnId;\n  }\n\n  public get rowId() {\n    return this._rowId;\n  }\n\n  public get label() {\n    return this.formattedValue;\n  }\n\n  public get value() {\n    return this._value;\n  }\n\n  public set value(newValue) {\n    this.update(newValue, newValue);\n  }\n\n  public get top(): number {\n    if (this.isMerged && this.reference) {\n      return this.reference.top;\n    }\n\n    return this.rowId;\n  }\n\n  public get left(): number {\n    if (this.isMerged && this.reference) {\n      return this.reference.left;\n    }\n\n    return this.columnId;\n  }\n\n  public get bottom(): number {\n    if (this.isMerged && this.reference) {\n      return this.reference.bottom;\n    }\n\n    return this.rowId + this.rowSpan;\n  }\n\n  public get right(): number {\n    if (this.isMerged && this.reference) {\n      return this.reference.right;\n    }\n\n    return this.columnId + this.colSpan;\n  }\n\n  public static from(data: any): Cell {\n    const cell = new Cell(data.columnId, data.rowId);\n    cell.colSpan = data.colSpan;\n    cell.rowSpan = data.rowSpan;\n    cell.formattedValue = data.formattedValue;\n    cell.evaluatedValue = data.evaluatedValue;\n    cell._columnId = data._columnId;\n    cell._rowId = data._rowId;\n    cell._value = data._value;\n    cell.reference = data.reference && this.from(data.reference);\n    return cell;\n  }\n  public colSpan: number = 1;\n  public rowSpan: number = 1;\n\n  // merged cell has following value\n  public reference: Cell | null = null;\n\n  private formattedValue?: string;\n  private evaluatedValue?: string;\n  private _columnId: number;\n  private _rowId: number;\n  private _value: any = null;\n\n  public constructor(columnId: number, rowId: number) {\n    this._columnId = columnId;\n    this._rowId = rowId;\n  }\n\n  public update(newValue: any, evaluated: any): void {\n    this._value = newValue;\n    this.evaluatedValue = evaluated;\n    this.format();\n  }\n\n  public to(): any {\n    return {\n      colSpan: this.colSpan,\n      rowSpan: this.rowSpan,\n      formattedValue: this.formattedValue,\n      evaluatedValue: this.evaluatedValue,\n      _columnId: this._columnId,\n      _rowId: this._rowId,\n      _value: this._value,\n      reference: this.reference && this.reference.to(),\n    };\n  }\n\n  private format() {\n    this.formattedValue = this.evaluatedValue;\n  }\n}\n","export const SheetTitleHeight: number = 30;\nexport const SheetTitleWidth: number = 110;\nexport const ColumnHeaderHeight: number = 30;\nexport const ColumnDefaultWidth: number = 100;\nexport const RowHeaderWidth: number = 30;\nexport const RowDefaultHeight: number = 30;\n\nexport const COLOR_LIGHT = '#fff';\nexport const COLOR_GRAY  = '#ccc';\nexport const COLOR_LIGHT_GRAY  = '#fafafa';\nexport const COLOR_CREAM = '#fffdd0';\nexport const COLOR_0 = '#4CAF50';\nexport const COLOR_1 = '#00897b';\nexport const COLOR_2 = '#00796b';\nexport const COLOR_3 = '#00454d';\n","import { Cell } from './Cell';\nimport { Appearance, Border } from './Appearance';\nimport { ColumnDefaultWidth, RowDefaultHeight, SheetTitleWidth } from '../common/constants';\nimport { Evaluator, IDateProvider } from './formula/Evaluator';\n\n\nexport class CellSelection {\n  public left: number = 0;\n  public top: number = 0;\n  public right: number = 0;\n  public bottom: number = 0;\n\n  public rowId: number = 0;\n  public columnId: number = 0;\n\n  public get single() {\n    return this.right == this.left && this.top == this.bottom;\n  }\n\n  public toString() {\n    return `${this.top} ${this.left} - ${this.bottom} ${this.right}`;\n  }\n}\n\nexport class Sheet implements IDateProvider {\n\n  public get SelectionLabel() {\n    return this.getCellName(this.selection.columnId, this.selection.rowId);\n  }\n\n  public get SelectedValue() {\n    return this.selectedCell && this.selectedCell.value;\n  }\n\n  public get SelectedAppearance() {\n    return this.getAppearance(this.selection.columnId, this.selection.rowId);\n  }\n\n  get selectedCell() {\n    return this.getCell(this.selection.columnId, this.selection.rowId);\n  }\n\n  private get invalidSelection() {\n    return this.selectedCell && this.selectedCell.isMerged;\n  }\n\n  public get scrollColumn() {\n    return this.scrollX;\n  }\n\n  public get scrollRow() {\n    return this.scrollY;\n  }\n\n  public static get_columnName(column: number) {\n    const az = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\n    let columnString = '';\n    let columnNumber = column + 1;\n    while (columnNumber > 0) {\n      const currentLetterNumber = (columnNumber - 1) % 26;\n      const currentLetter = az[currentLetterNumber];\n      columnString = currentLetter + columnString;\n      columnNumber = (columnNumber - (currentLetterNumber + 1)) / 26;\n    }\n    return columnString;\n  }\n\n  public static load(sheet: any): Sheet {\n    const sh = new Sheet(sheet.title);\n    sh.fill(sheet.data);\n    sh.style(sheet.appearance);\n    sh.columnAppearance = sheet.columnAppearance;\n    sh.rowAppearance = sheet.rowAppearance;\n    sh.columnWidth = sheet.columnWidth;\n    sh.rowHeight = sheet.rowHeight;\n    sh.scrollX = sheet.scrollX;\n    sh.scrollY = sheet.scrollY;\n    sh.selection = sheet.selection;\n\n    return sh;\n  }\n  public defaultAppearance: Appearance = new Appearance();\n  public defaultRowHeight = 30;\n  public defaultColumnWidth = 100;\n  public selection: CellSelection;\n\n  private data: any[] = [];\n  private appearance: any[] = [];\n  private columnAppearance: Appearance[] = [];\n  private rowAppearance: Appearance[] = [];\n  private rowHeight: number[] = [];\n  private columnWidth: number[] = [];\n  private scrollX: number = 0;\n  private scrollY: number = 0;\n  private change_listeners: Array<() => void> = [];\n\n  constructor(public title: string) {\n    this.defaultAppearance.background = null;\n    this.defaultAppearance.fontName = 'Lato';\n    this.defaultAppearance.fontSize = 12;\n    this.defaultAppearance.horizontalBorder = null;\n    this.defaultAppearance.verticalBorder = null;\n    this.defaultAppearance.text = '#333333';\n\n\n    this.selection = new CellSelection();\n    this.selection.top = 0;\n    this.selection.left = 0;\n    this.selection.right = 0;\n    this.selection.bottom = 0;\n    this.selection.rowId = 0;\n    this.selection.columnId = 0;\n  }\n\n  public selectNextColumnCell() {\n    this.selection.columnId++;\n\n    if (this.selection.single) {\n      this.selection.right = this.selection.columnId;\n      this.selection.left = this.selection.columnId;\n      this.onChange();\n      return;\n    }\n\n    if (this.selection.columnId > this.selection.right) {\n      this.selection.columnId = this.selection.left;\n      if (this.selection.rowId == this.selection.bottom) {\n        this.selection.rowId = this.selection.top;\n      } else {\n        this.selectNextRowCell();\n      }\n\n    }\n\n    if (this.invalidSelection) { this.selectNextColumnCell(); }\n    this.onChange();\n  }\n\n  public selectPreviousColumnCell() {\n    if (this.selection.columnId == 0) { return; }\n    this.selection.columnId--;\n\n    if (this.selection.single) {\n      this.selection.right = this.selection.columnId;\n      this.selection.left = this.selection.columnId;\n      this.onChange();\n      return;\n    }\n\n    if (this.selection.columnId < this.selection.left) {\n      this.selection.columnId = this.selection.right;\n      if (this.selection.rowId == this.selection.top) {\n        this.selection.rowId = this.selection.bottom;\n      } else {\n        this.selectPreviousRowCell();\n      }\n    }\n\n    if (this.invalidSelection) { this.selectPreviousColumnCell(); }\n    this.onChange();\n  }\n\n  public selectNextRowCell() {\n\n    this.selection.rowId++;\n    if (this.selection.single) {\n      this.selection.top = this.selection.rowId;\n      this.selection.bottom = this.selection.rowId;\n      this.onChange();\n      return;\n    }\n\n    if (this.selection.rowId > this.selection.bottom) {\n      this.selection.rowId = this.selection.top;\n      if (this.selection.columnId == this.selection.right) {\n        this.selection.columnId = this.selection.left;\n      } else {\n        this.selectNextColumnCell();\n      }\n    }\n\n    if (this.invalidSelection) { this.selectNextRowCell(); }\n    this.onChange();\n  }\n\n  public selectPreviousRowCell() {\n    if (this.selection.rowId == 0) { return; }\n    this.selection.rowId--;\n    if (this.selection.single) {\n      this.selection.top = this.selection.rowId;\n      this.selection.bottom = this.selection.rowId;\n      this.onChange();\n      return;\n    }\n\n    if (this.selection.rowId < this.selection.top) {\n      this.selection.rowId = this.selection.bottom;\n      if (this.selection.columnId == this.selection.left) {\n        this.selection.columnId = this.selection.right;\n      } else {\n        this.selectPreviousColumnCell();\n      }\n    }\n\n    if (this.invalidSelection) { this.selectPreviousRowCell(); }\n    this.onChange();\n  }\n\n  public getEvaluatedValue(exp: any): any[] {\n    if (('' + exp).indexOf(':') != -1) {\n      const parts = exp.split(':');\n      const a = this.getCellPos(parts[0]);\n      const b = this.getCellPos(parts[1]);\n      const res = [];\n      for (let c = a.columnId; c <= b.columnId; c++) {\n        for (let r = a.rowId; r <= b.rowId; r++) {\n          res.push(this.getCellEvaluatedValue(c, r));\n        }\n      }\n      return res;\n    }\n\n    const {rowId, columnId} = this.getCellPos(exp);\n    return this.getCellEvaluatedValue(columnId, rowId);\n  }\n\n  public removeCell(columnId: number, rowId: number) {\n    if (this.data[columnId] && this.data[columnId][rowId]) {\n      this.data[columnId][rowId] = undefined;\n    }\n  }\n\n  public setCellValue(columnId: number, rowId: number, value: any, silent = false): any {\n    if (value == null) {\n      this.removeCell(columnId, rowId);\n      return;\n    }\n    const cell = this.forceGetCell(columnId, rowId);\n    if (value.startsWith('=')) {\n      const evaluatedValue = Evaluator.Eval(this, value);\n      cell.update(value, evaluatedValue);\n    } else {\n      cell.value = value;\n    }\n    if (!silent) {\n      this.updateDependees(columnId, rowId);\n      this.onChange();\n    }\n  }\n\n  public getColumnLeft(columnId: number) {\n    let result = 0;\n    for (let i = this.scrollColumn; i < columnId; i++) {\n      result += this.getColumnWidth(i);\n    }\n    return result;\n  }\n\n  public getColumnRight(columnId: number) {\n    return this.getColumnLeft(columnId) + this.getColumnWidth(columnId);\n  }\n\n  public getRowTop(rowId: number) {\n    let result = 0;\n    for (let i = this.scrollRow; i < rowId; i++) {\n      result += this.getRowHeight(i);\n    }\n    return result;\n  }\n\n  public getRowBottom(rowId: number) {\n    return this.getRowTop(rowId) + this.getRowHeight(rowId);\n  }\n\n  public findColumnIdByX(x: number) {\n    if (x < 0) { return 0; }\n    let colX = 0;\n    for (let colId = this.scrollColumn; ; colId++) {\n      if (colId > this.scrollColumn + 100) { return 0; }\n      const colW = this.getColumnWidth(colId);\n      if (x > colX && x < colX + colW) {\n        return colId;\n      }\n      colX += colW;\n    }\n  }\n\n  public findRowIdByY(y: number) {\n    let rowY = this.getRowHeight(this.scrollRow);\n    let rowId = this.scrollRow;\n    while (rowY < y) {\n      rowId++;\n      rowY += this.getRowHeight(rowId);\n    }\n    return rowId;\n  }\n\n\n  public findCellByXY(x: number, y: number) {\n    const colId = this.findColumnIdByX(x);\n    const rowId = this.findRowIdByY(y);\n    return this.getCell(colId, rowId);\n  }\n\n\n  public selectByXY(x1: number, y1: number, x2: number, y2: number): any {\n    const top = Math.min(y1, y2);\n    const left = Math.min(x1, x2);\n    const right = Math.max(x1, x2);\n    const bottom = Math.max(y1, y2);\n\n    const stop = this.findRowIdByY(top);\n    const sbottom = this.findRowIdByY(bottom);\n    const sleft = this.findColumnIdByX(left);\n    const sright = this.findColumnIdByX(right);\n    let rowId = this.findRowIdByY(y1);\n    let columnId = this.findColumnIdByX(x1);\n    const selectedCell = this.getCell(columnId, rowId);\n    if (selectedCell && selectedCell.reference && selectedCell.isMerged) {\n      rowId = selectedCell.reference.rowId;\n      columnId = selectedCell.reference.columnId;\n    }\n\n    let ftop = stop;\n    let fbottom = sbottom + 1;\n    let fleft = sleft;\n    let fright = sright + 1;\n\n    for (let x = sleft; x <= sright; x++) {\n      for (let y = stop; y <= sbottom; y++) {\n        const cell = this.getCell(x, y);\n        if (cell) {\n          ftop = Math.min(ftop, cell.top);\n          fleft = Math.min(fleft, cell.left);\n          fbottom = Math.max(fbottom, cell.bottom);\n          fright = Math.max(fright, cell.right);\n        }\n      }\n    }\n\n    this.selection.top = ftop;\n    this.selection.left = fleft;\n    this.selection.right = fright - 1;\n    this.selection.bottom = fbottom - 1;\n    this.selection.rowId = rowId;\n    this.selection.columnId = columnId;\n    this.onChange();\n  }\n\n  public scrollDown(): any {\n    this.scroll(this.scrollColumn, this.scrollRow + 1);\n  }\n\n  public scrollUp(): any {\n    this.scroll(this.scrollColumn, this.scrollRow - 1);\n  }\n\n  public scrollLeft(): any {\n    this.scroll(this.scrollColumn + 1, this.scrollRow);\n  }\n\n  public scrollRight(): any {\n    this.scroll(this.scrollColumn - 1, this.scrollRow);\n  }\n\n  public getCellHeight(cell: Cell): number {\n    let height = 0;\n    for (let i = cell.rowId; i < cell.rowId + cell.rowSpan; i++) {\n      height += this.getRowHeight(i);\n    }\n    return height;\n  }\n\n  public getCellWidth(cell: Cell): number {\n    let width = 0;\n    for (let i = cell.columnId; i < cell.columnId + cell.colSpan; i++) {\n      width += this.getColumnWidth(i);\n    }\n    return width;\n  }\n\n  public scroll(columnId: number, rowId: number) {\n    if (columnId < 0) { return; }\n    if (rowId < 0) { return; }\n    for (const x in this.data) {\n      for (const y in this.data[x]) {\n        const cell: Cell = this.data[x][y];\n        if (cell.columnId < parseInt(x)) {\n          columnId = cell.columnId + cell.colSpan;\n        }\n        if (cell.rowId < parseInt(y)) {\n          rowId = cell.rowId + cell.rowSpan;\n        }\n      }\n    }\n\n    this.scrollX = columnId;\n    this.scrollY = rowId;\n\n    this.onChange();\n  }\n\n  public merge(columnId: number, rowId: number, width: number, height: number) {\n    const cell = this.forceGetCell(columnId, rowId);\n    cell.colSpan = width;\n    cell.rowSpan = height;\n    this.setCell(columnId, rowId, cell);\n\n    for (let x = columnId; x < columnId + width; x++) {\n      for (let y = rowId; y < rowId + height; y++) {\n        if (y != rowId || x != columnId) {\n          const xcell = this.forceGetCell(x, y);\n          xcell.reference = cell;\n          this.setCell(x, y, xcell);\n        }\n      }\n    }\n\n    this.onChange();\n  }\n\n  public unmerge(columnId: number, rowId: number) {\n    const cell = this.getCell(columnId, rowId);\n    if (!cell || (cell.rowSpan == 1 && cell.colSpan == 1)) { return; }\n\n    for (let i = 0; i < cell.colSpan; i++) {\n      for (let j = 0; j < cell.rowSpan; j++) {\n        const cx = this.getCell(i + columnId, j + rowId);\n        if (!cx) { continue; }\n        cx.reference = null;\n        this.setCell(i + columnId, j + rowId, cx, true);\n      }\n    }\n\n    cell.rowSpan = 1;\n    cell.colSpan = 1;\n    this.setCell(columnId, rowId, cell, true);\n    this.onChange();\n\n  }\n\n  public forceGetCell(columnId: number, rowId: number) {\n    let cell = this.getCell(columnId, rowId);\n    if (!cell) {\n      cell = new Cell(columnId, rowId);\n      this.setCell(columnId, rowId, cell);\n    }\n\n    return cell;\n  }\n\n  public getCell(columnId: number, rowId: number): Cell | null {\n    if (!this.data[columnId] || !this.data[columnId][rowId]) {\n      return null;\n    }\n\n    return this.data[columnId][rowId];\n  }\n\n  public setCell(columnId: number, rowId: number, cell: Cell, silent = false) {\n    if (!this.data[columnId]) {\n      this.data[columnId] = [];\n    }\n\n    this.data[columnId][rowId] = cell;\n    if (!silent) { this.onChange(); }\n  }\n\n\n  public getColumnAppearance(columnId: number): Appearance {\n    return this.columnAppearance[columnId];\n  }\n\n  public getRowAppearance(rowId: number): Appearance {\n    return this.rowAppearance[rowId];\n  }\n\n  public getCellAppearance(columnId: number, rowId: number): Appearance | null {\n    if (!this.appearance[columnId] || !this.appearance[columnId][rowId]) {\n      return null;\n    }\n\n    return this.appearance[columnId][rowId];\n  }\n\n  public setCellAppearance(columnId: number, rowId: number, appearance: Appearance, silent = false) {\n    if (!this.appearance[columnId]) {\n      this.appearance[columnId] = [];\n    }\n\n    this.appearance[columnId][rowId] = appearance;\n    if (!silent) { this.onChange(); }\n  }\n\n  public setColumAppearance(columnId: number, Appearance: Appearance) {\n    this.columnAppearance[columnId] = Appearance;\n    this.onChange();\n  }\n\n  public setRowAppearance(rowId: number, Appearance: Appearance) {\n    this.rowAppearance[rowId] = Appearance;\n    this.onChange();\n  }\n\n  public getRowHeight(rowId: number): number {\n    return this.rowHeight[rowId] || this.defaultRowHeight;\n  }\n\n  public setRowHeight(row: number, height: number) {\n    this.rowHeight[row] = height;\n    this.onChange();\n  }\n\n  public getColumnWidth(columnId: number): number {\n    return this.columnWidth[columnId] || this.defaultColumnWidth;\n  }\n\n  public setColumnWidth(column: number, width: number): any {\n    this.columnWidth[column] = width;\n    this.onChange();\n  }\n\n  public getAppearance(columnId: number, rowId: number): Appearance {\n    const appearance = new Appearance();\n\n    const cell = this.getCellAppearance(columnId, rowId);\n    const col = this.getColumnAppearance(columnId);\n    const row = this.getRowAppearance(rowId);\n    const def = this.defaultAppearance;\n\n    appearance.background = (cell && cell.background) || (col && col.background) || (row && row.background) || def.background;\n    appearance.fontName = (cell && cell.fontName) || (col && col.fontName) || (row && row.fontName) || def.fontName;\n    appearance.fontSize = (cell && cell.fontSize) || (col && col.fontSize) || (row && row.fontSize) || def.fontSize;\n    appearance.horizontalBorder = (cell && cell.horizontalBorder) || (col && col.horizontalBorder) || (row && row.horizontalBorder) || def.horizontalBorder;\n    appearance.verticalBorder = (cell && cell.verticalBorder) || (col && col.verticalBorder) || (row && row.verticalBorder) || def.verticalBorder;\n    appearance.text = (cell && cell.text) || (col && col.text) || (row && row.text) || def.text;\n    appearance.textAlign = (cell && cell.textAlign) || (col && col.textAlign) || (row && row.textAlign) || def.textAlign;\n    appearance.textStyle = (cell && cell.textStyle) || (col && col.textStyle) || (row && row.textStyle) || def.textStyle;\n\n    return appearance;\n\n  }\n\n  public addOnChange(handler: () => void) {\n    this.change_listeners.push(handler);\n  }\n\n  public removeOnChange(handler: () => void) {\n    const ix = this.change_listeners.indexOf(handler);\n    if (ix >= 0) {\n      this.change_listeners.splice(ix, 1);\n    }\n  }\n\n  public getWidth(measure: (text: string) => number) {\n    return SheetTitleWidth;\n    // return Math.max(SheetTitleWidth, measure(this.title) + 10); TODO: use this\n  }\n\n  public save() {\n    return {\n      title: this.title,\n      data: this.data,\n      appearance: this.appearance,\n      columnAppearance: this.columnAppearance,\n      rowAppearance: this.rowAppearance,\n      rowHeight: this.rowHeight,\n      columnWidth: this.columnWidth,\n      scrollX: this.scrollX,\n      scrollY: this.scrollY,\n      selection: this.selection,\n    };\n  }\n\n  private getCellName(columnId: number, rowId: number) {\n    return `${Sheet.get_columnName(columnId)}${rowId + 1}`;\n  }\n\n  private getCellPos(name: string) {\n    const regex = /([a-zA-z]+)([0-9]+)/g;\n    if (!(/([a-zA-z]+)([0-9]+)/g).test(name)) {\n      throw new Error('invalid cell name ' + name);\n    }\n    const pos: any = regex.exec(name);\n    const columnId = this.getColumnIndex(pos[1]);\n    const rowId = parseInt(pos[2]) - 1;\n\n    return {rowId, columnId};\n  }\n\n  private getColumnIndex(name: string) {\n    let sum = 0;\n    let pwr = 1;\n    let st = 65;\n    for (let i = name.length - 1; i >= 0; i--) {\n      const ch = name.charCodeAt(i) - st;\n      sum += ch * pwr;\n      pwr *= 26;\n      st = 64;\n    }\n    return sum;\n  }\n\n  private getCellEvaluatedValue(columnId: number, rowId: number) {\n    const cell = this.getCell(columnId, rowId);\n    if (cell == null) {\n      return null;\n    }\n\n    return Evaluator.Eval(this, cell.value); // TODO: should be cached and check cycles\n\n  }\n\n  private updateDependees(columnId: number, rowId: number) {\n    // TODO:bad performance\n    for (const d of this.data) {\n      if (!d) { continue; }\n      for (const c of d) {\n        if (!c || !c.value) { continue; }\n        if (c.value.length && c.value[0] == '=') {\n          this.setCellValue(c.columnId, c.rowId, c.value, true);\n        }\n      }\n    }\n  }\n\n  private onChange() {\n    this.change_listeners.forEach((m) => m());\n  }\n\n  private fill(data: any) {\n    this.data = [];\n    for (const d of data) {\n      if (!d) { continue; }\n      for (const c of d) {\n        if (!c) { continue; }\n        const cell = Cell.from(c);\n        this.setCell(cell.columnId, cell.rowId, cell, true);\n      }\n    }\n  }\n\n  private style(app: any) {\n    this.appearance = [];\n    if (!app) { return; }\n    for (const d of app) {\n      if (!d) { continue; }\n      for (const c of d) {\n        if (!c) { continue; }\n        const a = Appearance.from(c);\n        const col = app.indexOf(d);\n        const row = d.indexOf(c);\n        this.setCellAppearance(col, row, a, true);\n      }\n    }\n  }\n}\n","export function clone(obj: any) {\n  return JSON.parse(JSON.stringify(obj));\n}\n\nexport function isComma(ch: string) {\n  return (ch === ',');\n}\n\nexport function isDigit(ch: string) {\n  return /\\d/.test(ch);\n}\n\nexport function isLetter(ch: string) {\n  return /[a-z]/i.test(ch);\n}\n\nexport function isOperator(ch: string) {\n  return /\\+|-|\\*|\\/|\\^/.test(ch);\n}\n\nexport function isLeftParenthesis(ch: string) {\n  return (ch === '(');\n}\n\nexport function isRightParenthesis(ch: string) {\n  return (ch == ')');\n}\n","import { OpenDocument } from './Document';\nimport { CommandHistory } from './CommandHistory';\nimport { Sheet } from './Sheet';\nimport { clone } from '../common/utils';\nimport { Color } from '../common/types';\nimport { Appearance, TextAlign } from './Appearance';\n\nexport class Commander {\n\n  private get ActiveSheet(): Sheet {\n    return this.doc.ActiveSheet;\n  }\n\n  private get Selection() {\n    return this.ActiveSheet.selection;\n  }\n\n  private get SelectedAppearance(): Appearance [] {\n    const sel = this.Selection;\n    const sheet = this.doc.ActiveSheet;\n    const apps = [];\n    for (let r = sel.top; r <= sel.bottom; r++) {\n      for (let c = sel.left; c <= sel.right; c++) {\n        const app = sheet.getCellAppearance(sel.columnId, sel.rowId);\n        if (app) {\n          apps.push(clone(app));\n        }\n      }\n    }\n    return apps;\n  }\n\n  private get SelectionData() {\n    const sel = this.Selection;\n    const sheet = this.doc.ActiveSheet;\n    const data = [];\n\n    for (let c = sel.left; c <= sel.right; c++) {\n      for (let r = sel.top; r <= sel.bottom; r++) {\n        const cell = sheet.getCell(c, r);\n        data.push(clone(cell));\n      }\n    }\n\n    return data;\n  }\n  private history: CommandHistory[] = [];\n  private commands: any = {};\n\n  public constructor(private doc: OpenDocument) {\n    this.commands.bold = () => this.appearance((app) => app.bold = !app.bold);\n    this.commands.italic = () => this.appearance((app) => app.italic = !app.italic);\n    this.commands.underline = () => this.appearance((app) => app.underline = !app.underline);\n    this.commands['font-size'] = (size: number) => this.appearance((app) => app.fontSize = size);\n    this.commands['font-name'] = (font: string) => this.appearance((app) => app.fontName = font);\n    this.commands['bg-color'] = (color: Color) => this.appearance((app) => app.background = color);\n    this.commands['fg-color'] = (color: Color) => this.appearance((app) => app.text = color);\n    this.commands['top-border'] = (color: Color) => this.topBorder(color);\n    this.commands['no-border'] = () => this.noBorder();\n    this.commands['left-border'] = (color: Color) => this.leftBorder(color);\n    this.commands['right-border'] = (color: Color) => this.rightBorder(color);\n    this.commands['bottom-border'] = (color: Color) => this.bottomBorder(color);\n    this.commands['outside-border'] = (color: Color) => this.outsideBorder(color);\n    this.commands['horizontal-border'] = (color: Color) => this.horizontalBorder(color);\n    this.commands['vertical-border'] = (color: Color) => this.verticalBorder(color);\n    this.commands['cross-border'] = (color: Color) => this.crossBorder(color);\n    this.commands['full-border'] = (color: Color) => {\n      this.topBorder(color, false);\n      this.leftBorder(color, false);\n      this.bottomBorder(color, false);\n      this.rightBorder(color, false);\n      this.appearance((app) => {\n        app.setVertical(color);\n        app.setHorizontal(color);\n      });\n    };\n    this.commands.merge = () => this.merge();\n    this.commands.unmerge = () => this.unmerge();\n    this.commands.align = (value: any) => this.appearance((app) => app.alignTextTo(value));\n    this.commands['change-value'] = (columnId: number, rowId: number, value: string) => this.changeValue(columnId, rowId, value);\n    this.commands['alter-column'] = (columnId: number, delta: number) => this.alterColumn(columnId, delta);\n    this.commands['alter-row'] = (rowId: number, delta: number) => this.alterRow(rowId, delta);\n  }\n\n  public do(commandName: string, ...args: any[]) {\n    if (!this.has(commandName)) {\n      console.warn(`command ${commandName} does not exsits!`);\n    }\n\n    this.commands[commandName](...args);\n  }\n\n  public undo() {\n    throw new Error('undo has not been implemented');\n  }\n\n  public redo() {\n    throw new Error('redo has not been implemented');\n  }\n\n  private has(commandName: string) {\n    return !!this.commands[commandName];\n  }\n\n  private outsideBorder(color: Color) {\n    this.logAppearanceOnlyCommand();\n    this.topBorder(color, false);\n    this.rightBorder(color, false);\n    this.bottomBorder(color, false);\n    this.leftBorder(color, false);\n  }\n\n  private horizontalBorder(color: Color) {\n    this.crossBorder(color, true, false);\n  }\n\n  private verticalBorder(color: Color) {\n    this.crossBorder(color, false, true);\n  }\n\n  private crossBorder(color: Color, horizontal = true, vertical = true) {\n    this.logAppearanceOnlyCommand();\n    const sel = this.Selection;\n    const sheet = this.doc.ActiveSheet;\n    for (let c = sel.left; c <= sel.right; c++) {\n      for (let r = sel.top; r <= sel.bottom; r++) {\n        const app = this.ActiveSheet.getCellAppearance(c, r) || new Appearance();\n        if (horizontal && r < sel.bottom) { app.setHorizontal(color); }\n        if (vertical && c < sel.right) { app.setVertical(color); }\n        this.ActiveSheet.setCellAppearance(c, r, app, false);\n      }\n    }\n  }\n\n  private noBorder() {\n    this.logAppearanceOnlyCommand();\n    this.topBorder(null, false);\n    this.leftBorder(null, false);\n    this.appearance((app) => {\n      app.setVertical(null);\n      app.setHorizontal(null);\n    });\n  }\n\n  private topBorder(color: Color, log = true) {\n    if (log) {\n      this.logAppearanceOnlyCommand();\n    }\n    const sel = this.Selection;\n    const sheet = this.doc.ActiveSheet;\n    const r = sel.top - 1;\n    for (let c = sel.left; c <= sel.right; c++) {\n      const app = this.ActiveSheet.getCellAppearance(c, r) || new Appearance();\n      app.setHorizontal(color);\n      this.ActiveSheet.setCellAppearance(c, r, app, false);\n    }\n  }\n\n  private leftBorder(color: Color, log = true) {\n    if (log) {\n      this.logAppearanceOnlyCommand();\n    }\n    const sel = this.Selection;\n    const sheet = this.doc.ActiveSheet;\n    const c = sel.left - 1;\n    for (let r = sel.top; r <= sel.bottom; r++) {\n      const app = this.ActiveSheet.getCellAppearance(c, r) || new Appearance();\n      app.setVertical(color);\n      this.ActiveSheet.setCellAppearance(c, r, app, false);\n    }\n  }\n\n  private rightBorder(color: Color, log = true) {\n    if (log) {\n      this.logAppearanceOnlyCommand();\n    }\n    const sel = this.Selection;\n    const sheet = this.doc.ActiveSheet;\n    const c = sel.right;\n    for (let r = sel.top; r <= sel.bottom; r++) {\n      const app = this.ActiveSheet.getCellAppearance(c, r) || new Appearance();\n      app.setVertical(color);\n      this.ActiveSheet.setCellAppearance(c, r, app, false);\n    }\n  }\n\n  private bottomBorder(color: Color, log = true) {\n    if (log) {\n      this.logAppearanceOnlyCommand();\n    }\n    const sel = this.Selection;\n    const sheet = this.doc.ActiveSheet;\n    for (let c = sel.left; c <= sel.right; c++) {\n      const app = sheet.getCellAppearance(c, sel.bottom) || new Appearance();\n      app.setHorizontal(color);\n      sheet.setCellAppearance(c, sel.bottom, app, false);\n    }\n  }\n\n  private logAppearanceOnlyCommand() {\n    const sel = this.Selection;\n    const historyItem: CommandHistory = {\n      selection: sel,\n      appearance: this.SelectedAppearance,\n    };\n\n    this.history.push(historyItem);\n  }\n\n  private logDataOnlyCommand() {\n    const sel = this.Selection;\n    const historyItem: CommandHistory = {\n      selection: sel,\n      data: this.SelectionData,\n    };\n\n    this.history.push(historyItem);\n  }\n\n  private alterColumn(column: number, delta: number) {\n    const w = this.doc.ActiveSheet.getColumnWidth(column);\n    this.history.push({\n      selection: column,\n      data: w,\n      meta: 'COLUMN',\n    });\n\n    this.doc.ActiveSheet.setColumnWidth(column, w + delta);\n  }\n\n  private alterRow(row: number, delta: number) {\n    const h = this.doc.ActiveSheet.getRowHeight(row);\n    this.history.push({\n      selection: row,\n      data: h,\n      meta: 'ROW',\n    });\n\n    this.doc.ActiveSheet.setRowHeight(row, h + delta);\n  }\n\n  private changeValue(columnId: number, rowId: number, value: string) {\n    this.logDataOnlyCommand();\n    if (columnId == null) { columnId = this.Selection.columnId; }\n    if (rowId == null) { rowId = this.Selection.rowId; }\n    this.ActiveSheet.setCellValue(columnId, rowId, value);\n  }\n\n  private merge() {\n    this.logDataOnlyCommand();\n    const sel = this.Selection;\n    const c = Math.min(sel.right, sel.left);\n    const r = Math.min(sel.top, sel.bottom);\n    const w = Math.abs(sel.right - sel.left) + 1;\n    const h = Math.abs(sel.top - sel.bottom) + 1;\n    this.ActiveSheet.merge(c, r, w, h);\n  }\n\n  private unmerge() {\n    this.logDataOnlyCommand();\n    const sel = this.Selection;\n    this.ActiveSheet.unmerge(sel.columnId, sel.rowId);\n  }\n\n  private appearance(method: (app: Appearance) => void): void {\n    this.logAppearanceOnlyCommand();\n    const sel = this.Selection;\n    for (let r = sel.top; r <= sel.bottom; r++) {\n      for (let c = sel.left; c <= sel.right; c++) {\n        const app = this.ActiveSheet.getCellAppearance(c, r) || new Appearance();\n        method(app);\n        this.ActiveSheet.setCellAppearance(c, r, app);\n      }\n    }\n  }\n\n}\n","export enum LayoutDirection {\n  LeftToRight = 1,\n  RightToLeft = 2,\n}\n","import { Sheet } from './Sheet';\nimport { Commander } from './Commander';\n\nexport class OpenDocument {\n\n  public get ActiveSheet() {\n    return this.sheets[this.activeSheetIndex];\n  }\n\n  public get ActiveSheetIndex() {\n    return this.activeSheetIndex;\n  }\n\n  public set ActiveSheetIndex(index: number) {\n    if (index < 0 || index >= this.sheets.length) {\n      throw new Error('invalid sheet index');\n    }\n\n    this.activeSheetIndex = index;\n    this.onChange();\n  }\n\n  public get Sheets(): Sheet[] {\n    return this.sheets;\n  }\n\n  private sheets: Sheet[] = [];\n  private activeSheetIndex = 0;\n  private commander: Commander;\n  private change_listeners: Array<() => void> = [];\n\n  public constructor() {\n    this.init();\n    this.commander = new Commander(this);\n  }\n\n  public addSheet(name: string) {\n    const sheet = new Sheet(name);\n    sheet.addOnChange(() => this.onChange());\n    this.sheets.push(sheet);\n    this.onChange();\n  }\n\n  public addOnChange(handler: () => void) {\n    this.change_listeners.push(handler);\n  }\n\n  public removeOnChange(handler: () => void) {\n    const ix = this.change_listeners.indexOf(handler);\n    if (ix >= 0) {\n      this.change_listeners.splice(ix, 1);\n    }\n  }\n\n  public onChange() {\n    this.change_listeners.forEach((m) => m());\n  }\n\n  public execCommand(cmd: string, ...args: any[]) {\n    this.commander.do(cmd, ...args);\n  }\n\n  public save() {\n    return {\n      sheets: this.sheets.map((sh) => sh.save()),\n      activeSheetIndex: this.activeSheetIndex,\n    };\n  }\n\n  public load(obj: any) {\n    this.sheets = obj.sheets.map((sh: any) => Sheet.load(sh));\n    this.activeSheetIndex = obj.activeSheetIndex;\n    this.onChange();\n  }\n\n  private init() {\n    this.addSheet('Sheet1');\n    this.addSheet('Sheet2');\n    this.addSheet('Sheet3');\n  }\n}\n","export class ContextMask {\n\n  private x: number = 0;\n  private y: number = 0;\n  private width: number = 0;\n  private height: number = 0;\n\n  constructor(left: number, top: number, width: number, height: number) {\n    this.x = left;\n    this.y = top;\n    this.width = width;\n    this.height = height;\n  }\n\n\n  public get_left() {\n    return this.x;\n  }\n\n  public set_left(value: number) {\n    this.x = value;\n  }\n\n  public get_top() {\n    return this.y;\n  }\n\n  public get_right() {\n    return this.x + this.width;\n  }\n\n  public get_bottom() {\n    return this.y + this.height;\n  }\n\n  public set_top(value: number) {\n    this.y = value;\n  }\n\n  public get_width() {\n    return this.width;\n  }\n\n  public set_width(value: number) {\n    this.width = value;\n  }\n\n  public get_height() {\n    return this.height;\n  }\n\n  public set_height(value: number) {\n    this.height = value;\n  }\n\n  public set_value(x: number, y: number, w: number, h: number) {\n    this.x = x;\n    this.y = y;\n    this.width = w;\n    this.height = h;\n  }\n\n  public get_combinedMask(x: number, y: number, w: number, h: number) {\n    const x2 = Math.min(x + w, this.get_right());\n    const y2 = Math.min(y + h, this.get_bottom());\n\n    w = Math.min(x2 - x, this.get_width());\n    h = Math.min(y2 - y, this.get_height());\n\n    x = Math.max(x, this.get_left());\n    y = Math.max(y, this.get_top());\n\n    return new ContextMask(x, y, w, h);\n  }\n\n}\n","import { TextAlign } from '../../core/Appearance';\nimport { LayoutDirection } from '@/lib/rendering/canvas/LayoutDirection';\nimport { Point } from '@/lib/rendering/canvas/Point';\nimport { ContextMask } from '@/lib/rendering/canvas/ContextMask';\n\n/**\n * Created by SiamandM on 6/16/2016.\n */\nexport class Context {\n\n  public direction: LayoutDirection = LayoutDirection.LeftToRight;\n  public textAlign: TextAlign = TextAlign.Left;\n  public fillStyle: any = '#fff';\n  public strokeStyle = '#000';\n  public strokeSize = 1;\n  public contentFillStyle = '#000';\n  public fontStyle = '';\n  public fontSize = 12;\n  public fontName = 'Tahoma';\n\n  private context2d: CanvasRenderingContext2D;\n  private width: number;\n  private height: number;\n  private currentMask!: ContextMask | null;\n  private maskStack: ContextMask[] = [];\n\n  constructor(context: CanvasRenderingContext2D, width: number, height: number) {\n    this.context2d = context;\n    this.width = width;\n    this.height = height;\n  }\n\n  public get_directed_x(x: number, width: number = 0) {\n    if (this.direction === LayoutDirection.LeftToRight) {\n      return x;\n    }\n    return this.width - x - width;\n  }\n\n  public get_textWidth(text: string) {\n    return this.context2d.measureText(text).width;\n  }\n\n  public save() {\n    this.context2d.save();\n    this.context2d.translate(-0.5, -0.5);\n    if (this.currentMask) {\n      const cmask = this.currentMask;\n\n      this.context2d.rect(cmask.get_left(), cmask.get_top(), cmask.get_width(), cmask.get_height());\n      this.context2d.clip();\n    }\n\n  }\n\n  public restore() {\n    this.context2d.restore();\n  }\n\n  public setMask(x: number, y: number, w: number, h: number, affectPreviousMask: boolean = false) {\n    x = this.get_directed_x(x, w);\n\n    if (this.currentMask) {\n      this.maskStack.push(this.currentMask);\n    }\n    if (affectPreviousMask && this.currentMask) {\n      this.currentMask = this.currentMask.get_combinedMask(x, y, w, h);\n    } else {\n      this.currentMask = new ContextMask(x, y, w, h);\n    }\n  }\n\n  public unmask() {\n    if (this.maskStack.length > 0) {\n      this.currentMask = (this.maskStack.pop() as ContextMask);\n    } else {\n      this.currentMask = null;\n    }\n  }\n\n  public clearRect(x: number, y: number, w: number, h: number) {\n    x = this.get_directed_x(x, w);\n    this.save();\n    this.context2d.clearRect(x, y, w, h);\n    this.restore();\n  }\n\n  public fillRect(x: number, y: number, w: number, h: number) {\n    x = this.get_directed_x(x, w);\n    this.save();\n    this.applyFill();\n    this.context2d.beginPath();\n    this.context2d.fillRect(x, y, w, h);\n    this.context2d.fill();\n    this.restore();\n  }\n\n  public strokeRect(x: number, y: number, w: number, h: number) {\n    x = this.get_directed_x(x, w);\n    this.save();\n    this.applyStroke();\n    this.context2d.beginPath();\n    this.context2d.strokeRect(x, y, w, h);\n    this.context2d.stroke();\n    this.restore();\n  }\n\n  public line(x1: number, y1: number, x2: number, y2: number) {\n    x1 = this.get_directed_x(x1);\n    x2 = this.get_directed_x(x2);\n\n    this.save();\n    this.applyStroke();\n    this.context2d.beginPath();\n    this.context2d.moveTo(x1, y1);\n    this.context2d.lineTo(x2, y2);\n    this.context2d.stroke();\n    this.restore();\n  }\n\n  public path(close: boolean, stroke: boolean, fill: boolean, ...points: Point[]) {\n    this.save();\n    this.applyStroke();\n    this.applyFill();\n    this.context2d.beginPath();\n    let point = points[0];\n    const drpx = this.get_directed_x(point.x);\n    this.context2d.moveTo(drpx, point.y);\n    for (let i = 1; i < points.length; i++) {\n      point = points[i];\n      const drx = this.get_directed_x(point.x);\n      this.context2d.lineTo(drx, point.y);\n    }\n    if (close) {\n      this.context2d.closePath();\n    }\n    if (fill) {\n      this.context2d.fill();\n    }\n    if (stroke) {\n      this.context2d.stroke();\n    }\n\n    this.restore();\n  }\n\n  public openPath(...points: Point[]) {\n    this.internalPath(false, true, false, points);\n  }\n\n  public closePath(...points: Point[]) {\n    this.internalPath(true, true, false, points);\n  }\n\n  public fillOpenPath(...points: Point[]) {\n    this.internalPath(false, true, true, points);\n  }\n\n  public fillClosePath(...points: Point[]) {\n    this.internalPath(true, false, true, points);\n  }\n\n  public rect(x: number, y: number, w: number, h: number) {\n    x = this.get_directed_x(x, w);\n    this.fillRect(x, y, w, h);\n    this.strokeRect(x, y, w, h);\n  }\n\n  public fillText(text: string, x: number, y: number, width: number) {\n    x = this.get_directed_x(x, width);\n    this.save();\n    this.applyContent();\n    let delta = 0;\n    const textWidth = this.get_textWidth(text);\n    if (this.textAlign === TextAlign.Center) {\n      delta = (width - textWidth) / 2;\n    } else if (this.textAlign === TextAlign.Right) {\n      delta = width - textWidth - 10; // TODO: fix that constant value [indent]\n    }\n    if (this.fontStyle && this.fontStyle.indexOf('underline') !== -1) {\n      this.rect(x, y + this.fontSize + 2, this.context2d.measureText(text).width, 0);\n    }\n\n    this.context2d.fillText(text, x + delta, y + this.fontSize);\n    this.restore();\n  }\n\n  public createGradient(x: number, y: number, w: number, h: number, ...stops: any[]) {\n    const grd = this.context2d.createLinearGradient(x, y, x + w, y + h);\n    for (const n of stops) {\n      grd.addColorStop(n[0], n[1]);\n    }\n    return grd;\n  }\n\n\n  private applyFill() {\n    this.context2d.fillStyle = this.fillStyle;\n  }\n\n  private applyStroke() {\n    this.context2d.strokeStyle = this.strokeStyle;\n    this.context2d.lineWidth = this.strokeSize;\n  }\n\n  private applyContent() {\n    const style = this.fontStyle.replace('underline', '');\n    this.context2d.fillStyle = this.contentFillStyle;\n    this.context2d.font = (`${this.fontStyle} ${this.fontSize}px ${this.fontName}`).trim();\n    this.context2d.textAlign = 'left';\n  }\n\n  private internalPath(close: boolean, stroke: boolean, fill: boolean, points: Point[]) {\n    const args: any = [close, stroke, fill];\n    for (const point of points) {\n      args.push(point);\n    }\n    this.path.apply(this, args);\n  }\n}\n","export class Point {\n\n  public x: number;\n  public y: number;\n\n  constructor(x: number = 0, y: number = 0) {\n    this.x = x;\n    this.y = y;\n  }\n}\n","import {\n  RowDefaultHeight,\n  ColumnHeaderHeight,\n  RowHeaderWidth,\n  SheetTitleHeight,\n  COLOR_3,\n  COLOR_1,\n  COLOR_LIGHT,\n  COLOR_CREAM,\n} from '../../common/constants';\nimport { DocumentRenderer } from '../DocumentRenderer';\nimport { OpenDocument } from '../../core/Document';\nimport { Context} from './Context';\nimport { TextAlign } from '../../core/Appearance';\nimport { Sheet } from '../../core/Sheet';\nimport { Point } from '@/lib/rendering/canvas/Point';\n\n\nexport class CanvasRenderer implements DocumentRenderer {\n\n  public get Element(): HTMLElement {\n    return this.container;\n  }\n\n  public width!: number;\n  public height!: number;\n  private canvas!: HTMLCanvasElement;\n  private rendering: boolean = false;\n  private renderFrameRate: number = 10; // FPS\n  private context!: Context;\n\n\n  public constructor(private container: HTMLElement, private document: OpenDocument) {\n    this.initialize();\n    document.addOnChange(() => this.render());\n  }\n\n  public initialize() {\n    this.createElements();\n    this.resize();\n    this.render();\n  }\n\n  public createElements() {\n    this.canvas = document.createElement('canvas');\n    this.container.appendChild(this.canvas);\n  }\n\n  public resize() {\n    const pixelRatio = window.devicePixelRatio;\n    this.width = this.container.clientWidth;\n    this.height = this.container.clientHeight;\n    if (pixelRatio > 1) {\n      this.canvas.width = this.width * pixelRatio;\n      this.canvas.height = this.height * pixelRatio;\n      this.canvas.style.width = this.width + 'px';\n      this.canvas.style.height = this.height + 'px';\n    } else {\n      this.canvas.width = this.width;\n      this.canvas.height = this.height;\n    }\n    this.render();\n  }\n\n  public get_context2D() {\n    const pixelRatio = window.devicePixelRatio;\n    this.canvas.width = this.canvas.width;\n    const context = this.canvas.getContext('2d') as CanvasRenderingContext2D;\n    context.scale(pixelRatio, pixelRatio);\n    return context;\n  }\n\n  public render() {\n    if (this.rendering) {\n      return;\n    }\n\n    this.rendering = true;\n    setTimeout(() => {\n      this.doRender();\n      this.rendering = false;\n    }, 1000 / this.renderFrameRate);\n\n  }\n\n  public doRender() {\n    console.log('%cRender', `color:${COLOR_1}`);\n    const context2d = this.get_context2D();\n    this.context = new Context(context2d, this.width, this.height);\n    this.renderSheetTitles();\n    this.renderSheet();\n  }\n\n  private renderTopCorner() {\n    this.context.fillStyle = '#ececec';\n    this.context.fontSize = 12;\n    const cornerWidth = RowHeaderWidth - 2;\n    this.context.fillClosePath(new Point(2, cornerWidth), new Point(cornerWidth, cornerWidth), new Point(cornerWidth, 1));\n\n  }\n\n  private renderSheetTitles() {\n    this.renderTopCorner();\n\n    this.context.strokeSize = 1;\n    const x1 = 0;\n    const y1 = this.height - SheetTitleHeight - .5;\n    const rHeight = SheetTitleHeight + 5;\n    const h = this.height - SheetTitleHeight - 0.5;\n    this.context.rect(x1, y1, this.width, rHeight);\n    this.context.fillStyle = this.context.createGradient(0, h, 0, SheetTitleHeight / 3, [0, '#f0f0f0'], [1, '#fff']);\n    this.context.fillRect(x1, y1, this.width, rHeight);\n    this.context.textAlign = TextAlign.Center;\n\n    let x = RowHeaderWidth;\n    const active = this.document.ActiveSheet;\n    const delta = 5;\n    for (const sh of this.document.Sheets) {\n      const sheetWidth = sh.getWidth((str) => this.context.get_textWidth(str));\n      this.context.strokeStyle = '#aaa';\n      this.context.fillStyle = '#fafafa';\n      this.context.fontStyle = 'italic';\n      if (sh === active) {\n        this.context.fillStyle = '#fff';\n        this.context.fontStyle = 'bold';\n      }\n      this.context.rect(x, h, sheetWidth, SheetTitleHeight - delta);\n      this.context.fillText(sh.title, x, h + delta, sheetWidth);\n      if (sh === active) {\n        this.context.fillStyle = COLOR_3;\n        this.context.fillRect(x, h + SheetTitleHeight - delta, sheetWidth, 2);\n        this.context.strokeStyle = COLOR_LIGHT;\n      }\n      this.context.line(x, h, x + sheetWidth, h);\n\n      x += sheetWidth + delta;\n    }\n    this.context.fontStyle = '';\n  }\n\n  private renderSheet() {\n    const width = this.width;\n    const height = this.height;\n\n    const sheetTitleHeight = SheetTitleHeight;\n    const maskHeight = height - sheetTitleHeight;\n    const context = this.context;\n\n    context.setMask(0, 0, width, height - (sheetTitleHeight + 1.5));\n    const lastRow = this.renderRows();\n    const lastColumn = this.renderColumns();\n    context.unmask();\n\n    context.setMask(ColumnHeaderHeight + .5, RowHeaderWidth, width, maskHeight - RowHeaderWidth - .5);\n    this.renderCells(lastColumn, lastRow);\n    context.unmask();\n  }\n\n  private renderRows() {\n    const context = this.context;\n    const height = this.height - RowHeaderWidth - SheetTitleHeight;\n    let cumulativeHeight = RowDefaultHeight;\n    const sheet = this.document.ActiveSheet;\n\n    let rw = sheet.scrollRow;\n    for (; cumulativeHeight < height; rw++) {\n      const rowHeight = sheet.getRowHeight(rw);\n      this.paintRow(cumulativeHeight, (rw + 1).toString());\n      cumulativeHeight += rowHeight;\n    }\n\n    return rw;\n  }\n\n  private paintRow(top: number, label: string): any {\n    const context = this.context;\n    context.save();\n    context.strokeSize = 1;\n    context.strokeStyle = '#ccc';\n    context.fillStyle = '#fafafa';\n    context.rect(0, top, RowHeaderWidth, this.height);\n    context.fillRect(0, top, RowHeaderWidth, this.height);\n    context.fontSize = 12;\n    context.textAlign = TextAlign.Center;\n    context.fillText(label, 0, top + (RowDefaultHeight - 12) / 2, RowHeaderWidth);\n    context.restore();\n  }\n\n  private renderColumns() {\n    const width = this.width;\n    const sheet = this.document.ActiveSheet;\n    let cumulativeWidth = RowHeaderWidth + .5;\n    let cl = sheet.scrollColumn;\n\n    for (; cumulativeWidth <= width; cl++) {\n      const columnWidth = sheet.getColumnWidth(cl);\n      this.paintColumn(cumulativeWidth, Sheet.get_columnName(cl), columnWidth);\n      cumulativeWidth += columnWidth;\n    }\n    return cl;\n  }\n\n  private paintColumn(left: number, label: string, columnWidth: number) {\n    const context = this.context;\n    context.strokeSize = 1;\n    context.strokeStyle = '#ccc';\n    context.fillStyle = '#fafafa';\n    context.fontName = 'Tahoma';\n    context.fontSize = 12;\n    context.rect(left, 0, this.width, ColumnHeaderHeight - 1);\n    context.fillRect(left, 0, this.width, ColumnHeaderHeight - 1);\n    context.fillText(label, left, 7, columnWidth);\n  }\n\n  private renderCells(lastColumn: number, lastRow: number) {\n    let x: number = 0;\n    let y: number = 0;\n\n    const sheet = this.document.ActiveSheet;\n    const cellsToPaint = [];\n    const context = this.context;\n    context.strokeStyle = '#eee';\n    context.strokeSize = 1;\n    for (let r = sheet.scrollRow - 1; r < lastRow; r++) {\n      const rowHeight = sheet.getRowHeight(r);\n      x = 0;\n      for (let c = sheet.scrollColumn; c <= lastColumn; c++) {\n        const columnWidth = sheet.getColumnWidth(c);\n        const cell = sheet.getCell(c, r);\n        const cellHeight = cell ? sheet.getCellHeight(cell) : sheet.getRowHeight(r);\n        const cellWidth = cell ? sheet.getCellWidth(cell) : sheet.getColumnWidth(c);\n        const appearance = sheet.getAppearance(c, r);\n        context.fillStyle = appearance.text;\n        this.paintCell(c, r, x, y);\n\n        if (y > 0 && (!cell || !cell.isMerged)) {\n          const horStyle = appearance.horizontalBorder;\n          const verStyle = appearance.verticalBorder;\n\n          context.strokeStyle = (horStyle && horStyle.color) || '#eeeeee';\n          if (appearance.background == null || horStyle != null) {\n            context.line(x + RowHeaderWidth, y + cellHeight, x + RowHeaderWidth + cellWidth, y + cellHeight);\n          }\n          context.strokeStyle = (verStyle && verStyle.color) || '#eeeeee';\n          if (appearance.background == null || verStyle != null) {\n            context.line(x + RowHeaderWidth + cellWidth, y, x + RowHeaderWidth + cellWidth, y + cellHeight);\n          }\n        }\n        x += columnWidth;\n      }\n      y += rowHeight;\n    }\n  }\n\n  private paintCell(columnId: number, rowId: number, x: number, y: number) {\n    const context = this.context;\n    const sheet = this.document.ActiveSheet;\n    const cell = sheet.getCell(columnId, rowId);\n    if (cell && cell.isMerged) { return; }\n\n    const appearance = sheet.getAppearance(columnId, rowId);\n    const left = x + ColumnHeaderHeight;\n    if (y < RowDefaultHeight) { return; }\n\n    if (appearance.fontSize) { context.fontSize = parseInt(appearance.fontSize + ''); }\n    if (appearance.fontName) { context.fontName = appearance.fontName; }\n    context.fontStyle = (appearance.textStyle) ? appearance.textStyle : '';\n\n    const cellWidth = cell ? sheet.getCellWidth(cell) : sheet.getColumnWidth(columnId);\n    const cellHeight = cell ? sheet.getCellHeight(cell) : sheet.getRowHeight(rowId);\n\n    context.setMask(left, y, cellWidth, cellHeight);\n    if (appearance.background) {\n      context.fillStyle = appearance.background;\n      context.fillRect(left, y, cellWidth, cellHeight);\n    }\n    if (cell && cell.label) {\n      context.contentFillStyle = appearance.text;\n      context.strokeStyle = appearance.text;\n      context.textAlign = appearance.textAlign;\n      context.fillText(cell.label, x + ColumnHeaderHeight + 5, y + 7, cellWidth);\n    }\n    context.unmask();\n  }\n\n}\n","import { OpenDocument } from '../core/Document';\nimport { UIHandlerController } from './UIHandlerControler';\nimport { ColumnHeaderHeight, RowHeaderWidth, SheetTitleHeight, COLOR_1, COLOR_2 } from '../common/constants';\nimport { Cell } from '../core/Cell';\nimport { Sheet } from '../core/Sheet';\nimport { TextAlign } from '../core/Appearance';\nimport { CellValue } from '@/lib/common/types';\n\n/**\n * Created by SiamandM on 6/23/2016.\n */\n/// <reference path=\"UIHandler.ts\"/>\n\nexport class CellEditor {\n\n  public get Value() {\n    if (this.editorElement.value == '') {\n      return null;\n    }\n\n    return this.editorElement.value;\n  }\n\n  public set Value(newValue: CellValue) {\n    if (this.editorElement) {\n      this.editorElement.value = newValue ? newValue + '' : '';\n    }\n  }\n\n  public get IsDirty() {\n    const cell = this.getCurrentCell();\n    return (cell.value != this.Value);\n  }\n\n  public get EditMode() {\n    return this.editMode;\n  }\n\n  public set EditMode(mode: boolean) {\n    this.editMode = mode;\n    if (mode) {\n      this.editorElement.readOnly = false;\n    } else {\n      this.editorElement.readOnly = true;\n    }\n    this.editorElement.focus();\n  }\n\n  private websheet: OpenDocument;\n  private editorArea!: HTMLDivElement;\n  private selectionElement!: HTMLElement;\n  private editorElement!: HTMLInputElement;\n  private anchorElement!: HTMLSpanElement;\n  private editMode = false;\n\n  constructor(public controler: UIHandlerController) {\n    this.websheet = controler.websheet;\n    this.initialize();\n    this.select();\n  }\n\n  public initialize() {\n    this.editorArea = document.createElement('div');\n    this.editorArea.style.position = 'absolute';\n    this.editorArea.style.top = ColumnHeaderHeight + 'px';\n    this.editorArea.style.left = RowHeaderWidth + 'px';\n    this.editorArea.style.bottom = SheetTitleHeight + 'px';\n    this.editorArea.style.right = '0px';\n    this.editorArea.style.overflow = 'visible';\n    this.controler.renderer.Element.appendChild(this.editorArea);\n\n    this.selectionElement = document.createElement('div');\n    this.selectionElement.style.position = 'absolute';\n    this.selectionElement.style.border = `solid 2px ${COLOR_1}`;\n    this.selectionElement.style.overflow = 'hidden';\n    this.selectionElement.style.background = 'rgba(0,0,0,.1)';\n    this.selectionElement.style.transitionDuration = '.1s';\n    this.editorArea.appendChild(this.selectionElement);\n\n    this.editorElement = document.createElement('input');\n    this.editorElement.type = 'text';\n    this.editorElement.style.display = 'block';\n    this.editorElement.style.zIndex = '10000';\n    this.editorElement.style.position = 'absolute';\n    this.editorElement.style.background = '#fff';\n    this.editorElement.style.textIndent = '3px';\n    this.editorElement.style.border = 'none';\n\n    const forceEditMode = () => {\n      if (!this.EditMode) {\n        this.EditMode = true;\n      }\n    };\n\n    this.editorElement.addEventListener('click', forceEditMode);\n    this.editorElement.addEventListener('change', forceEditMode);\n    this.editorElement.addEventListener('touchstart', forceEditMode);\n\n    this.selectionElement.appendChild(this.editorElement);\n\n    this.anchorElement = document.createElement('span');\n    this.anchorElement.style.position = 'absolute';\n    this.anchorElement.style.right = '0';\n    this.anchorElement.style.bottom = '0';\n    this.anchorElement.style.width = '6px';\n    this.anchorElement.style.height = '6px';\n    this.anchorElement.style.borderRadius = '2px';\n    this.anchorElement.style.border = 'solid 1px #fff';\n    this.anchorElement.style.background = COLOR_2;\n    this.anchorElement.style.zIndex = '10000';\n    this.anchorElement.style.cursor = 'cell';\n    this.editorArea.appendChild(this.anchorElement);\n\n    this.websheet.addOnChange(() => {\n      const value = this.websheet.ActiveSheet.SelectedValue;\n      if (value != this.Value) {\n        this.Value = value;\n      }\n\n      this.updateEditorAppearance();\n      this.select(true);\n    });\n\n  }\n\n  public disableAnimation() {\n    this.selectionElement.style.transitionDuration = '';\n    this.anchorElement.style.transitionDuration = '';\n  }\n\n  public enableAnimation() {\n    this.selectionElement.style.transitionDuration = '.1s';\n    this.anchorElement.style.transitionDuration = '.1s';\n  }\n\n  public deselect() {\n    const cell = this.getCurrentCell();\n    if (this.IsDirty) {\n      this.controler.websheet.execCommand('change-value', cell.columnId, cell.rowId, this.Value);\n    }\n  }\n\n  public updateEditorAppearance() {\n    const app = this.getCurrentAppearance();\n\n    this.editorElement.style.textAlign = this.getTextAlign(app.textAlign);\n    this.editorElement.style.fontStyle = app.italic ? 'italic' : '';\n    this.editorElement.style.fontWeight = app.bold ? 'bold' : '';\n    this.editorElement.style.background = app.background;\n    this.editorElement.style.fontFamily = app.fontName;\n    this.editorElement.style.fontSize = `${app.fontSize}px`;\n    this.editorElement.style.color = app.text;\n    this.editorElement.style.textDecoration = app.underline ? 'underline' : '';\n  }\n\n  public select(animation = true) {\n    if (animation) {\n      this.enableAnimation();\n    } else {\n      this.disableAnimation();\n    }\n\n    this.updateEditorAppearance();\n\n    const sheet = this.controler.websheet.ActiveSheet;\n    const selection = sheet.selection;\n\n    const x1 = sheet.getColumnLeft(selection.left);\n    const y1 = sheet.getRowTop(selection.top);\n    const x2 = sheet.getColumnRight(selection.right);\n    const y2 = sheet.getRowBottom(selection.bottom);\n\n    const w = x2 - x1;\n    const h = y2 - y1;\n\n    this.selectionElement.style.left = (x1 - 2) + 'px';\n    this.selectionElement.style.top = (y1 - 2) + 'px';\n    this.selectionElement.style.width = (w - 2) + 'px';\n    this.selectionElement.style.height = (h - 2) + 'px';\n\n    const selectedCell = this.getCurrentCell();\n\n    const editorY = sheet.getRowTop(selection.rowId);\n    const editorX = sheet.getColumnLeft(selection.columnId);\n\n    this.editorElement.style.left = (editorX - x1) + 'px';\n    this.editorElement.style.top = (editorY - y1) + 'px';\n    this.editorElement.style.width = (sheet.getCellWidth(selectedCell) - 3) + 'px';\n    this.editorElement.style.height = (sheet.getCellHeight(selectedCell) - 3) + 'px';\n\n    this.editorElement.focus();\n\n    this.anchorElement.style.left = `${x2 - 5}px`;\n    this.anchorElement.style.top = `${y2 - 5}px`;\n\n  }\n\n  private getCurrentCell() {\n    const sheet = this.controler.websheet.ActiveSheet;\n    const selection = sheet.selection;\n    return sheet.getCell(selection.columnId, selection.rowId) || new Cell(selection.columnId, selection.rowId);\n  }\n\n  private getCurrentAppearance() {\n    const sheet = this.controler.websheet.ActiveSheet;\n    const selection = sheet.selection;\n    return sheet.getAppearance(selection.columnId, selection.rowId);\n  }\n\n  private getTextAlign(textAlign: TextAlign) {\n    if (textAlign == TextAlign.Center) { return 'center'; }\n    if (textAlign == TextAlign.Left) { return 'left'; }\n    if (textAlign == TextAlign.Right) { return 'right'; }\n    return '';\n  }\n\n}\n","///<reference path=\"../core/Sheet.ts\"/>\n///<reference path=\"./CellEditor.ts\"/>\n\nimport { Sheet } from '../core/Sheet';\nimport { UIHandlerController } from './UIHandlerControler';\n\n// import {CellEditor} from \"./CellEditor\"\n/**\n * Created by SiamandM on 6/17/2016.\n */\n\nexport interface IUIHandler {\n  click(): void;\n\n  dblClick(): void;\n\n  mouseDown(x: number, y: number): void;\n\n  mouseMove(x: number, y: number): void;\n\n  mouseUp(x: number, y: number): void;\n\n  mouseWheel(dx: number, dy: number): void;\n\n  keyDown(evt: any): void;\n\n  keyPress(evt: any): void;\n\n  keyUp(evt: any): void;\n}\n\nexport class UIHandler implements IUIHandler {\n  constructor(protected controller: UIHandlerController) {\n\n  }\n\n  public click() {\n  }\n\n  public dblClick() {\n  }\n\n  public mouseDown(x: number, y: number) {\n  }\n\n  public mouseMove(x: number, y: number) {\n  }\n\n  public mouseUp(x: number, y: number) {\n  }\n\n  public mouseWheel(dx: number, dy: number) {\n  }\n\n  public keyDown(evt: KeyboardEvent) {\n  }\n\n\n  public keyPress(evt: any) {\n  }\n\n  public keyUp(evt: any) {\n  }\n\n  get locked() {\n    return this.controller.locked;\n  }\n\n  public lock() {\n    this.controller.lock(this);\n  }\n\n  public unlock() {\n    this.controller.unlock();\n  }\n\n}\n","import { UIHandler } from './UIHandler';\nimport { SheetTitleHeight, RowHeaderWidth, SheetTitleWidth } from '../common/constants';\n\nexport class WebSheetUIHandler extends UIHandler {\n\n  public mouseUp(x: number, y: number) {\n    if (y < this.controller.renderer.Element.clientHeight - SheetTitleHeight) {\n      return;\n    }\n\n    const j = Math.floor((x - RowHeaderWidth) / (SheetTitleWidth + 5));\n    const n = (x - RowHeaderWidth) % (SheetTitleWidth + 5);\n    if (n < SheetTitleWidth && j < this.controller.websheet.Sheets.length) {\n      this.controller.changeActiveSheet(j);\n    }\n  }\n\n\n}\n","import { UIHandler } from './UIHandler';\nimport { ColumnHeaderHeight, RowHeaderWidth, SheetTitleHeight } from '../common/constants';\nimport { UIHandlerController } from '@/lib/editor/UIHandlerControler';\nimport { Sheet } from '@/lib/core/Sheet';\n\nexport class SheetUIHandler extends UIHandler {\n\n  private wheelDeltaX: number = 0;\n  private wheelDeltaY: number = 0;\n\n  private oldX!: number;\n  private oldY!: number;\n  private sheet: Sheet;\n\n  constructor(controller: UIHandlerController) {\n    super(controller);\n    this.sheet = controller.websheet.ActiveSheet;\n  }\n\n  public mouseWheel(dx: number, dy: number) {\n\n    this.wheelDeltaX += dx;\n    this.wheelDeltaY += dy;\n\n    const websheet = this.controller.websheet;\n    const sheet = websheet.ActiveSheet;\n    const delta = 120;\n\n    if (this.wheelDeltaX > delta) {\n      sheet.scrollRight();\n      this.wheelDeltaX = 0;\n    } else if (this.wheelDeltaX < -delta) {\n      sheet.scrollLeft();\n      this.wheelDeltaX = 0;\n    }\n\n    if (this.wheelDeltaY > delta) {\n      sheet.scrollUp();\n      this.wheelDeltaY = 0;\n    } else if (this.wheelDeltaY < -delta) {\n      sheet.scrollDown();\n      this.wheelDeltaY = 0;\n    }\n    this.controller.renderer.render();\n    this.controller.select();\n\n  }\n\n  public mouseDown(x: number, y: number) {\n    this.oldX = x;\n    this.oldY = y;\n  }\n\n  public mouseUp(x: number, y: number) {\n    this.selectCell(x, y);\n  }\n\n  public keyPress(evt: KeyboardEvent) {\n    if (evt.key == 'Enter') {\n      if (!this.controller.EditMode) {\n        this.controller.EditMode = true;\n        return;\n      } else {\n        this.controller.commit();\n        this.controller.EditMode = false;\n      }\n      if (evt.shiftKey) {\n        this.sheet.selectPreviousRowCell();\n      } else {\n        this.sheet.selectNextRowCell();\n      }\n    }\n  }\n\n  public keyDown(evt: KeyboardEvent) {\n    if (evt.key == 'Tab') {\n      this.controller.deselect();\n      if (evt.shiftKey) {\n        this.sheet.selectPreviousColumnCell();\n      } else {\n        this.sheet.selectNextColumnCell();\n      }\n      evt.preventDefault();\n      this.controller.select(true);\n    }\n    if (this.controller.EditMode) {\n      return;\n    }\n    if (evt.key == 'ArrowRight' || evt.key == 'ArrowLeft' || evt.key == 'ArrowUp' || evt.key == 'ArrowDown') {\n      this.controller.deselect();\n      if (evt.key == 'ArrowRight') {\n        this.sheet.selectNextColumnCell();\n      } else if (evt.key == 'ArrowLeft') {\n        this.sheet.selectPreviousColumnCell();\n      } else if (evt.key == 'ArrowUp') {\n        this.sheet.selectPreviousRowCell();\n      } else if (evt.key == 'ArrowDown') {\n        this.sheet.selectNextRowCell();\n      }\n      evt.preventDefault();\n      this.controller.select(true);\n    }\n  }\n\n  public dblClick() {\n    if (!this.controller.EditMode) {\n      this.controller.EditMode = true;\n    }\n  }\n\n  private selectCell(x: number, y: number) {\n    if (y < ColumnHeaderHeight || x < RowHeaderWidth) {\n      return;\n    }\n    if (y > this.controller.renderer.Element.clientHeight - SheetTitleHeight) {\n      return;\n    }\n    const sheet = this.controller.websheet.ActiveSheet;\n    const x1 = this.oldX - RowHeaderWidth;\n    const y1 = this.oldY - ColumnHeaderHeight;\n    const x2 = x - RowHeaderWidth;\n    const y2 = y - ColumnHeaderHeight;\n    this.controller.deselect();\n    sheet.selectByXY(x1, y1, x2, y2);\n    this.controller.select(true);\n  }\n\n}\n","import { UIHandler } from './UIHandler';\nimport { RowHeaderWidth, ColumnHeaderHeight } from '../common/constants';\n\nconst delta = 4;\n\nexport class ResizeHandler extends UIHandler {\n\n  private col: any;\n  private row: any;\n  private oldX!: number;\n  private oldY!: number;\n  private engaged = false;\n\n  public mouseMove(x: number, y: number) {\n    const c = this.hitColumn(x - RowHeaderWidth, y);\n    const r = this.hitRow(x, y - ColumnHeaderHeight);\n    if (c !== false) {\n      this.controller.changeCursor('col-resize');\n    } else if (r !== false) {\n      this.controller.changeCursor('row-resize');\n    } else if (!this.engaged) {\n      this.controller.resetCursor();\n    }\n  }\n\n  public mouseDown(x: number, y: number) {\n    this.col = this.hitColumn(x - RowHeaderWidth, y);\n    this.row = this.hitRow(x, y - ColumnHeaderHeight);\n    this.oldX = x;\n    this.oldY = y;\n    if (this.col !== false || this.row !== false) {\n      this.lock();\n\n      if (this.col !== false) {\n        this.controller.changeCursor('col-resize');\n      } else if (this.row !== false) {\n        this.controller.changeCursor('row-resize');\n      }\n      this.engaged = true;\n    } else {\n      this.engaged = false;\n    }\n  }\n\n  public mouseUp(x: number, y: number) {\n    if (!this.engaged) { return; }\n    if (this.col !== false) {\n      this.controller.alterColumn(this.col, x - this.oldX);\n      this.controller.resetCursor();\n    }\n\n    if (this.row !== false) {\n      this.controller.alterRow(this.row, y - this.oldY);\n      this.controller.resetCursor();\n    }\n\n    this.unlock();\n  }\n\n  private hitRow(x: number, y: number): any {\n    if (x > RowHeaderWidth) { return false; }\n    const rowH = (r: any) => this.controller.websheet.ActiveSheet.getRowHeight(r);\n    let j = 0;\n    for (let i = rowH(j++); i < y + delta; i += rowH(j++)) {\n      if ((y > (i - delta)) && (y < (i + delta))) {\n        return j - 1;\n      }\n    }\n\n    return false;\n  }\n\n  private hitColumn(x: number, y: number): any {\n    if (y > ColumnHeaderHeight) { return false; }\n    const colW = (c: any) => this.controller.websheet.ActiveSheet.getColumnWidth(c);\n    let j = 0;\n    for (let i = colW(j++); i < x + delta; i += colW(j++)) {\n      if ((x > (i - delta)) && (x < (i + delta))) {\n        return j - 1;\n      }\n    }\n\n    return false;\n  }\n}\n","import { UIHandler } from './UIHandler';\nimport { CellEditor } from './CellEditor';\nimport { WebSheetUIHandler } from './DocumentHandler';\nimport { SheetUIHandler } from './SheetUIHandler';\nimport { OpenDocument } from '../core/Document';\nimport { DocumentRenderer } from '../rendering/DocumentRenderer';\nimport { ResizeHandler } from './ResizeHandler';\n\nexport class UIHandlerController {\n\n  public get EditMode() {\n    return this.cellEditor.EditMode;\n  }\n\n  public set EditMode(mode: boolean) {\n    this.cellEditor.EditMode = mode;\n  }\n\n  get locked() {\n    return !!this.lockedOn;\n  }\n\n  private handlers: UIHandler[] = [];\n  private lockedOn: UIHandler | null = null;\n  private cellEditor!: CellEditor;\n\n  constructor(public websheet: OpenDocument, public renderer: DocumentRenderer) {\n    this.cellEditor = new CellEditor(this);\n    this.addHandlers();\n    this.attachEvents();\n    websheet.addOnChange(() => this.cellEditor.updateEditorAppearance());\n  }\n\n  public select(animation: boolean = true) {\n    this.cellEditor.select(animation);\n  }\n\n  public deselect() {\n    this.cellEditor.deselect();\n  }\n\n  public alterColumn(columnId: number, delta: number) {\n    this.websheet.execCommand('alter-column', columnId, delta);\n  }\n\n  public alterRow(rowId: number, delta: number) {\n    this.websheet.execCommand('alter-row', rowId, delta);\n  }\n\n  public lock(uiHandler: UIHandler) {\n    this.lockedOn = uiHandler;\n  }\n\n  public unlock() {\n    this.lockedOn = null;\n  }\n\n  public resetCursor() {\n    this.renderer.Element.style.cursor = '';\n  }\n\n  public changeCursor(cursor: string) {\n    this.renderer.Element.style.cursor = cursor;\n  }\n\n  public attachEvents() {\n    const element = this.renderer.Element;\n    const overlay = document.createElement('div');\n    overlay.style.position = 'absolute';\n    overlay.style.top = '0';\n    overlay.style.left = '0';\n    overlay.style.right = '0';\n    overlay.style.bottom = '0';\n    overlay.style.zIndex = '9999';\n    element.appendChild(overlay);\n\n    const controler = this;\n\n    const getXY = function(evt: MouseEvent) {\n      const x = evt.offsetX || evt.layerX || (evt.clientX - element.offsetLeft);\n      const y = evt.offsetY || evt.layerY || (evt.clientY - element.offsetTop);\n\n      return {x, y};\n    };\n\n    const getTouchXY = function(evt: TouchEvent) {\n      const touch = evt.touches.length ? evt.touches[0] : evt.changedTouches[0];\n      const x = touch.clientX - element.offsetLeft;\n      const y = touch.clientY - element.offsetTop;\n      return {x, y};\n    };\n\n    overlay.addEventListener('touchstart', (evt: TouchEvent) => {\n      if (evt.touches.length == 1) {\n        const pos = getTouchXY(evt);\n        controler.mouseDown(pos.x, pos.y);\n        evt.preventDefault();\n      }\n    });\n\n    overlay.addEventListener('touchmove', (evt: TouchEvent) => {\n        const pos = getTouchXY(evt);\n        controler.mouseMove(pos.x, pos.y);\n    });\n\n    overlay.addEventListener('touchend', (evt: TouchEvent) => {\n        const pos = getTouchXY(evt);\n        controler.mouseUp(pos.x, pos.y);\n    });\n\n    overlay.addEventListener('touchcancel', (evt: TouchEvent) => {\n      const pos = getTouchXY(evt);\n      controler.mouseUp(pos.x, pos.y);\n    });\n\n    overlay.addEventListener('mousedown', (evt: MouseEvent) => {\n      const pos = getXY(evt);\n      controler.mouseDown(pos.x, pos.y);\n    });\n\n    overlay.addEventListener('mousemove', (evt: MouseEvent) => {\n      const pos = getXY(evt);\n      controler.mouseMove(pos.x, pos.y);\n    });\n\n    overlay.addEventListener('mouseup', (evt: MouseEvent) => {\n      const pos = getXY(evt);\n      controler.mouseUp(pos.x, pos.y);\n    });\n\n    overlay.addEventListener('click', (evt: MouseEvent) => controler.click());\n    overlay.addEventListener('dblclick', (evt: MouseEvent) => controler.dblClick());\n    overlay.addEventListener('mousewheel', (evt: any) => {\n      const dx = evt.wheelDeltaX;\n      const dy = evt.wheelDeltaY;\n      controler.mouseWheel(dx, dy);\n      evt.preventDefault();\n      evt.stopPropagation();\n      return false;\n    });\n\n    window.addEventListener('keydown', (evt: any) => controler.keyDown(evt));\n    window.addEventListener('keypress', (evt: any) => controler.keyPress(evt));\n    window.addEventListener('keyup', (evt: any) => controler.keyUp(evt));\n    window.addEventListener('resize', () => this.renderer.resize());\n\n  }\n\n  public click() {\n    if (this.lockedOn) {\n      this.lockedOn.click();\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].click();\n    }\n  }\n\n  public dblClick() {\n    if (this.lockedOn) {\n      this.lockedOn.dblClick();\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].dblClick();\n    }\n  }\n\n  public mouseDown(x: number, y: number) {\n    if (this.lockedOn) {\n      this.lockedOn.mouseDown(x, y);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].mouseDown(x, y);\n    }\n  }\n\n  public mouseMove(x: number, y: number) {\n    if (this.lockedOn) {\n      this.lockedOn.mouseMove(x, y);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].mouseMove(x, y);\n    }\n  }\n\n  public mouseUp(x: number, y: number) {\n    if (this.lockedOn) {\n      this.lockedOn.mouseUp(x, y);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].mouseUp(x, y);\n    }\n  }\n\n  public mouseWheel(dx: number, dy: number) {\n    if (this.lockedOn) {\n      this.lockedOn.mouseWheel(dx, dy);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].mouseWheel(dx, dy);\n    }\n  }\n\n  public keyDown(evt: any) {\n    if (this.lockedOn) {\n      this.lockedOn.keyDown(evt);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].keyDown(evt);\n    }\n  }\n\n  public keyPress(evt: any) {\n    if (this.lockedOn) {\n      this.lockedOn.keyPress(evt);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].keyPress(evt);\n    }\n  }\n\n  public keyUp(evt: any) {\n    if (this.lockedOn) {\n      this.lockedOn.keyUp(evt);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].keyUp(evt);\n    }\n  }\n\n  public changeActiveSheet(index: number) {\n    this.cellEditor.deselect();\n    this.websheet.ActiveSheetIndex = index;\n    this.cellEditor.select(false);\n  }\n\n  public commit() {\n    this.cellEditor.deselect();\n    this.cellEditor.select(false);\n  }\n\n  private addHandlers() {\n    this.handlers.push(new WebSheetUIHandler(this));\n    this.handlers.push(new SheetUIHandler(this));\n    this.handlers.push(new ResizeHandler(this));\n  }\n}\n","import { OpenDocument } from './core/Document';\nimport { DocumentRenderer } from './rendering/DocumentRenderer';\nimport { CanvasRenderer } from './rendering/canvas/CanvasRendering';\nimport { UIHandlerController } from './editor/UIHandlerControler';\n\nexport class UI {\n\n  get isMerged() {\n    const cell = this.selectedCell;\n    if (!cell) { return false; }\n    return (cell.colSpan > 1) || (cell.rowSpan > 1);\n  }\n\n  public get selectedCell() {\n    return this.document.ActiveSheet.selectedCell;\n  }\n\n  public get SelectedCellLabel() {\n    return this.document.ActiveSheet.SelectionLabel;\n  }\n\n  public get SelectedValue() {\n    return this.document.ActiveSheet.SelectedValue;\n  }\n\n  public get SelectedAppearance() {\n    return this.document.ActiveSheet.SelectedAppearance;\n  }\n\n  private handlers: Array<(doc: OpenDocument) => void> = [];\n  private document: OpenDocument = new OpenDocument();\n  private readonly render: DocumentRenderer | null = null;\n  private uiController: UIHandlerController;\n\n  public constructor(private element: HTMLElement) {\n    this.render = new CanvasRenderer(element, this.document);\n    this.uiController = new UIHandlerController(this.document, this.render);\n    this.document.addOnChange(() => this.raiseOnChangeEventListener());\n    this.render.render();\n\n    (element as any).openDocument = this.document;\n  }\n\n  public execCmd(cmd: string, ...args: any[]) {\n    console.log(`the command _${cmd}_ executed.`);\n    this.uiController.commit();\n    this.document.execCommand(cmd, ...args);\n  }\n\n  public addOnChangeEventListener(handler: (doc: OpenDocument) => void) {\n    this.handlers.push(handler);\n  }\n\n  public removeOnChangeEventListener(handler: (doc: OpenDocument) => void) {\n    const ix = this.handlers.indexOf(handler);\n    if (ix != -1) {\n      this.handlers.splice(ix, 1);\n    }\n  }\n\n  public save() {\n    return JSON.stringify(this.document.save());\n  }\n\n  public load(data: any) {\n    const obj = JSON.parse(data);\n    this.document.load(obj);\n  }\n\n  private raiseOnChangeEventListener() {\n    this.handlers.forEach((handler) => handler(this.document));\n  }\n}\n","\n\n\n\n\nimport { Component } from 'vue-property-decorator';\nimport Vue from 'vue';\nimport { UI } from '@/lib/UI';\nimport { OpenDocument } from '@/lib/core/Document';\n\n@Component({name: 'OpenSheet'})\nexport default class OpenSheet extends Vue {\n  private ui!: UI;\n\n  public execute(command: string, args?: any) {\n    this.ui.execCmd(command, args);\n  }\n\n  public load(file: string) {\n    this.ui.load(file);\n  }\n\n  public mounted() {\n    this.ui = new UI(this.$refs['canvas-container'] as HTMLElement);\n    this.$emit('ready', this.ui);\n    this.ui.addOnChangeEventListener((doc: OpenDocument) => {\n      this.$emit('change', doc);\n    });\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./OpenSheet.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./OpenSheet.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./OpenSheet.vue?vue&type=template&id=6835bc7c&scoped=true&\"\nimport script from \"./OpenSheet.vue?vue&type=script&lang=ts&\"\nexport * from \"./OpenSheet.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./OpenSheet.vue?vue&type=style&index=0&id=6835bc7c&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6835bc7c\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_vm._v(\"Sheets1 | Sheet 2 | Sheet 3\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div>Sheets1 | Sheet 2 | Sheet 3</div>\n</template>\n\n<script>\n  export default {\n    name: \"SheetSelector\"\n  }\n</script>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SheetSelector.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SheetSelector.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SheetSelector.vue?vue&type=template&id=0be19af6&\"\nimport script from \"./SheetSelector.vue?vue&type=script&lang=js&\"\nexport * from \"./SheetSelector.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"status-bar\"})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\nexport default {\n  name: 'StatusBar',\n};\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./StatusBar.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./StatusBar.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StatusBar.vue?vue&type=template&id=2c4dd48e&scoped=true&\"\nimport script from \"./StatusBar.vue?vue&type=script&lang=ts&\"\nexport * from \"./StatusBar.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./StatusBar.vue?vue&type=style&index=0&id=2c4dd48e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2c4dd48e\",\n  null\n  \n)\n\nexport default component.exports","\nimport { Component, Vue } from 'vue-property-decorator';\nimport RibbonMenu from '@/RibbonMenu.vue';\nimport FormulaBar from '@/FormulaBar.vue';\nimport OpenSheet from '@/OpenSheet.vue';\nimport SheetSelector from '@/SheetSelector.vue';\nimport StatusBar from '@/StatusBar.vue';\nimport { OpenDocument } from '@/lib/core/Document';\nimport { UI } from '@/lib/UI';\nimport { Appearance } from '@/lib/core/Appearance';\n\n@Component({\n  components: {\n    StatusBar,\n    SheetSelector,\n    OpenSheet,\n    FormulaBar,\n    RibbonMenu,\n  },\n})\nexport default class App extends Vue {\n  private uiManager!: UI;\n  private appearance: Appearance = new Appearance();\n  private fileMode: 'local' | 'file' = 'file';\n  private state = {\n    isMerged: false,\n    label: 'A1',\n    value: null,\n    originalValue: null,\n  };\n\n  public onReady(ui: UI) {\n    this.uiManager = ui;\n  }\n\n  public onChange(doc: OpenDocument) {\n    this.appearance = doc.ActiveSheet.SelectedAppearance;\n    this.state.isMerged = this.uiManager.isMerged;\n    this.state.label = doc.ActiveSheet.SelectionLabel;\n    this.state.value = doc.ActiveSheet.SelectedValue;\n    this.state.originalValue = doc.ActiveSheet.SelectedValue;\n\n    if (this.fileMode === 'local') {\n      localStorage.setItem('data', JSON.stringify(doc.save()));\n    }\n  }\n\n  public onCommit() {\n    if (this.state.value !== this.state.originalValue) {\n      this.uiManager.execCmd('change-value', null, null, this.state.value);\n    }\n  }\n\n  public onAbort() {\n    this.state.value = this.state.originalValue;\n  }\n\n  public onAction({actionName, args}: { actionName: string, args: any }) {\n    if (actionName === 'save-ows') {\n      this.onSave();\n      return;\n    } else if (actionName === 'load-ows') {\n      this.onLoad();\n      return;\n    }\n    this.uiManager.execCmd(actionName, args);\n  }\n\n  public onModeChanged(newMode: 'file' | 'local') {\n    if (this.fileMode === 'file' && localStorage.getItem('data') !== null) {\n      (this.$refs.sheet as any).load(localStorage.getItem('data'));\n    }\n    this.fileMode = newMode;\n  }\n\n  public onLoad() {\n    const win = window as any;\n    const ui = this.uiManager;\n\n    if (win.File && win.FileReader && win.FileList && win.Blob) {\n      const f = document.createElement('input');\n      f.type = 'file';\n      f.accept = '.ows';\n      f.addEventListener('change', function(evt: any) {\n        const file = evt.target.files[0];\n        const reader = new FileReader();\n        reader.addEventListener('load', function(loadEvt: any) {\n          const rawData = loadEvt.target.result;\n          ui.load(rawData);\n        });\n        reader.readAsText(file, 'utf8');\n      });\n      f.click();\n    } else {\n      alert('The File APIs are not fully supported in this browser.');\n    }\n  }\n\n  public onSave() {\n    const content = this.uiManager.save();\n    const uriContent = 'data:application/octet-stream,' + encodeURIComponent(content);\n    const a = document.createElement('a');\n    a.download = 'document.ows';\n    a.href = uriContent;\n    a.target = '_blank';\n    a.click();\n  }\n\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=98553306&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","/* tslint:disable:no-console */\n\nimport { register } from 'register-service-worker';\n\nif (process.env.NODE_ENV === 'production') {\n  register(`service-worker.js`, {\n    ready() {\n      console.log(\n        'App is being served from cache by a service worker.\\n' +\n        'For more details, visit https://goo.gl/AFskqB',\n      );\n    },\n    registered() {\n      console.log('Service worker has been registered.');\n    },\n    cached() {\n      console.log('Content has been cached for offline use.');\n    },\n    updatefound() {\n      console.log('New content is downloading.');\n    },\n    updated() {\n      console.log('New content is available; please refresh.');\n    },\n    offline() {\n      console.log('No internet connection found. App is running in offline mode.');\n    },\n    error(error) {\n      console.error('Error during service worker registration:', error);\n    },\n  });\n}\n","import Vue from 'vue';\nimport App from './App.vue';\nimport './registerServiceWorker';\n\nVue.config.productionTip = false;\n\nnew Vue({\n  render: (h) => h(App),\n}).$mount('#app');\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ribbon.vue?vue&type=style&index=0&id=244e0240&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ribbon.vue?vue&type=style&index=0&id=244e0240&lang=scss&scoped=true&\""],"sourceRoot":""}