{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/FormulaBar.vue?4a0d","webpack:///./src/RibbonMenu.vue?b8dc","webpack:///./src/StatusBar.vue?8e66","webpack:///./src/OpenSheet.vue?a150","webpack:///./src/components/ColorPicker.vue?0781","webpack:///./src/components/ActionGroup.vue?e91a","webpack:///./src/components/ControlBox.vue?9c70","webpack:///./src/components/ActionButton.vue?0052","webpack:///./src/lib/core/formula/Evaluator.ts","webpack:///./src/components/CellBorderStyle.vue?305f","webpack:///./src/App.vue?77b8","webpack:///./src/RibbonMenu.vue?d10b","webpack:///./src/components/Ribbon.vue?5e11","webpack:///./src/components/Ribbon.vue?b53c","webpack:///./src/components/Ribbon.vue?cede","webpack:///./src/components/Ribbon.vue","webpack:///./src/components/ControlBox.vue?2181","webpack:///./src/components/ControlBox.vue?82d6","webpack:///./src/components/ControlBox.vue?2f2c","webpack:///./src/components/ControlBox.vue","webpack:///./src/components/CellBorderStyle.vue?43b0","webpack:///./src/components/CellBorderStyle.vue?7aa2","webpack:///./src/components/CellBorderStyle.vue?fab7","webpack:///./src/components/CellBorderStyle.vue","webpack:///./src/components/FontSizeSelector.vue?2989","webpack:///./src/components/FontSizeSelector.vue?b442","webpack:///./src/components/FontSizeSelector.vue?37f2","webpack:///./src/components/FontSizeSelector.vue","webpack:///./src/components/ActionGroup.vue?7869","webpack:///./src/components/ActionButton.vue?00f4","webpack:///./src/components/ActionButton.vue?8270","webpack:///./src/components/ActionButton.vue?ec0a","webpack:///./src/components/ActionButton.vue","webpack:///./src/components/ActionGroup.vue?803c","webpack:///./src/components/ActionGroup.vue?8c07","webpack:///./src/components/ActionGroup.vue","webpack:///./src/components/ColorPicker.vue?d464","webpack:///./src/components/ColorPicker.vue?d0c2","webpack:///./src/lib/core/Appearance.ts","webpack:///./src/components/ColorPicker.vue?8049","webpack:///./src/components/ColorPicker.vue","webpack:///./src/components/FontNameSelector.vue?4247","webpack:///./src/components/FontNameSelector.vue?d6d6","webpack:///./src/components/FontNameSelector.vue?491e","webpack:///./src/components/FontNameSelector.vue","webpack:///./src/RibbonMenu.vue?22cb","webpack:///./src/RibbonMenu.vue?490c","webpack:///./src/RibbonMenu.vue","webpack:///./src/FormulaBar.vue?9705","webpack:///./src/FormulaBar.vue?076b","webpack:///./src/FormulaBar.vue?08ff","webpack:///./src/FormulaBar.vue","webpack:///./src/OpenSheet.vue?4e09","webpack:///./src/lib/core/Cell.ts","webpack:///./src/lib/common/constants.ts","webpack:///./src/lib/core/Sheet.ts","webpack:///./src/lib/common/utils.ts","webpack:///./src/lib/core/Commander.ts","webpack:///./src/lib/core/Document.ts","webpack:///./src/lib/rendering/canvas/LayoutDirection.ts","webpack:///./src/lib/rendering/canvas/ContextMask.ts","webpack:///./src/lib/rendering/canvas/Context.ts","webpack:///./src/lib/rendering/canvas/Point.ts","webpack:///./src/lib/rendering/canvas/CanvasRendering.ts","webpack:///./src/lib/editor/CellEditor.ts","webpack:///./src/lib/editor/UIHandler.ts","webpack:///./src/lib/editor/DocumentHandler.ts","webpack:///./src/lib/editor/SheetUIHandler.ts","webpack:///./src/lib/editor/ResizeHandler.ts","webpack:///./src/lib/editor/UIHandlerControler.ts","webpack:///./src/lib/UI.ts","webpack:///./src/OpenSheet.vue?8675","webpack:///./src/OpenSheet.vue?e09b","webpack:///./src/OpenSheet.vue","webpack:///./src/SheetSelector.vue?af57","webpack:///src/SheetSelector.vue","webpack:///./src/SheetSelector.vue?ba24","webpack:///./src/SheetSelector.vue","webpack:///./src/StatusBar.vue?6fd7","webpack:///./src/StatusBar.vue?bccc","webpack:///./src/StatusBar.vue?7f1b","webpack:///./src/StatusBar.vue","webpack:///./src/App.vue?ec60","webpack:///./src/App.vue?640d","webpack:///./src/App.vue","webpack:///./src/registerServiceWorker.ts","webpack:///./src/main.ts","webpack:///./src/components/Ribbon.vue?62e4"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","Env","ranges","dataProvider","txt","_M_E_","this","_R_A_N_G_E_","PI","Math","E","SUM","selector","reduce","x","y","MIN","min","MAX","max","SIN","v","sin","COS","cos","TAN","tan","ASIN","asin","ACOS","acos","ATAN","atan","ASINH","asinh","ACOSH","acosh","ATANH","atanh","ABS","abs","SQRT","sqrt","CBRT","cbrt","LOG","log","EXP","exp","TRUNC","trunc","CEIL","ceil","FLOOR","floor","eval","getEvaluatedValue","Evaluator","str","regex","valueRegex","temp","range_index","exec","index","lastIndex","forEach","match","groupIndex","indexOf","replace","ev","Eval","substr","err","render","_vm","_h","$createElement","_c","_self","attrs","appearance","state","on","onModeChanged","onAction","label","onCommit","onAbort","model","callback","$$v","$set","expression","ref","onReady","onChange","staticRenderFns","menu","active","slot","staticStyle","staticClass","$event","changeMode","_v","fontFamily","fontSize","fontStyle","foreColor","fillColor","textAlignment","onAlign","class","isMerged","toggleMerge","borderColor","onBorderChanged","_l","item","_s","_t","newValue","$emit","required","component","style","display","grid","_e","default","directives","rawName","$$selectedVal","Array","filter","target","options","selected","map","val","_value","selectedSize","multiple","size","domProps","sizes","action","disabled","components","ActionButton","$slots","composing","color","TextAlign","BorderStyle","Border","SolidThin","border","Appearance","textAlign","Left","fontName","textStyle","ensureTextStyle","bold","italic","app","text","background","horizontalBorder","from","verticalBorder","toLowerCase","Right","Center","Error","selectedFamily","family","families","fileMode","activeStyle","underline","newSize","newFont","newMode","borderStructure","alignment","actionName","args","FontFamilySelector","ColorPicker","ActionGroup","FontSizeSelector","CellBorderStyle","ControlBox","Ribbon","formula","_m","newFormula","Cell","columnId","rowId","colSpan","rowSpan","reference","_columnId","_rowId","formattedValue","update","top","left","bottom","right","cell","evaluatedValue","evaluated","format","to","SheetTitleHeight","SheetTitleWidth","ColumnHeaderHeight","RowHeaderWidth","RowDefaultHeight","COLOR_LIGHT","COLOR_1","COLOR_2","COLOR_3","CellSelection","title","defaultAppearance","defaultRowHeight","defaultColumnWidth","columnAppearance","rowAppearance","rowHeight","columnWidth","scrollX","scrollY","change_listeners","selection","getCellName","selectedCell","getAppearance","getCell","column","az","columnString","columnNumber","currentLetterNumber","currentLetter","sheet","sh","fill","single","selectNextRowCell","invalidSelection","selectNextColumnCell","selectPreviousRowCell","selectPreviousColumnCell","parts","split","a","getCellPos","b","res","getCellEvaluatedValue","undefined","silent","forceGetCell","startsWith","updateDependees","removeCell","scrollColumn","getColumnWidth","getColumnLeft","scrollRow","getRowHeight","getRowTop","colX","colId","colW","rowY","findColumnIdByX","findRowIdByY","x1","y1","x2","y2","stop","sbottom","sleft","sright","ftop","fbottom","fleft","fright","scroll","height","width","parseInt","setCell","xcell","cx","row","getCellAppearance","col","getColumnAppearance","getRowAppearance","def","handler","ix","measure","get_columnName","test","pos","getColumnIndex","sum","pwr","st","ch","charCodeAt","setCellValue","setCellAppearance","clone","obj","JSON","parse","stringify","doc","history","commands","font","topBorder","noBorder","leftBorder","rightBorder","bottomBorder","outsideBorder","crossBorder","setVertical","setHorizontal","merge","unmerge","align","alignTextTo","changeValue","delta","alterColumn","alterRow","ActiveSheet","sel","Selection","apps","commandName","has","console","warn","logAppearanceOnlyCommand","horizontal","vertical","historyItem","SelectedAppearance","SelectionData","w","meta","setColumnWidth","h","setRowHeight","logDataOnlyCommand","method","sheets","activeSheetIndex","init","commander","addOnChange","cmd","do","save","load","addSheet","LayoutDirection","ContextMask","get_right","get_bottom","get_width","get_height","get_left","get_top","context","direction","LeftToRight","fillStyle","strokeStyle","strokeSize","contentFillStyle","maskStack","context2d","measureText","translate","currentMask","cmask","rect","clip","restore","affectPreviousMask","get_directed_x","get_combinedMask","pop","clearRect","applyFill","beginPath","fillRect","applyStroke","strokeRect","stroke","moveTo","lineTo","close","point","drpx","drx","closePath","points","internalPath","applyContent","textWidth","get_textWidth","fillText","grd","createLinearGradient","stops","addColorStop","lineWidth","trim","path","Point","container","document","rendering","renderFrameRate","initialize","createElements","resize","canvas","createElement","appendChild","pixelRatio","devicePixelRatio","clientWidth","clientHeight","getContext","scale","setTimeout","doRender","get_context2D","renderSheetTitles","renderSheet","cornerWidth","fillClosePath","renderTopCorner","rHeight","createGradient","Sheets","sheetWidth","getWidth","line","sheetTitleHeight","maskHeight","setMask","lastRow","renderRows","lastColumn","renderColumns","unmask","renderCells","cumulativeHeight","rw","paintRow","toString","cumulativeWidth","cl","paintColumn","cellHeight","getCellHeight","cellWidth","getCellWidth","paintCell","horStyle","verStyle","controler","editMode","websheet","select","editorElement","getCurrentCell","Value","readOnly","focus","editorArea","position","overflow","renderer","Element","selectionElement","transitionDuration","type","zIndex","textIndent","forceEditMode","EditMode","addEventListener","anchorElement","borderRadius","cursor","SelectedValue","updateEditorAppearance","IsDirty","execCommand","getCurrentAppearance","getTextAlign","fontWeight","textDecoration","animation","enableAnimation","disableAnimation","getColumnRight","getRowBottom","editorY","editorX","UIHandler","controller","dx","dy","evt","locked","lock","unlock","changeActiveSheet","super","wheelDeltaX","wheelDeltaY","scrollRight","scrollLeft","scrollUp","scrollDown","oldX","oldY","selectCell","commit","shiftKey","deselect","preventDefault","selectByXY","engaged","hitColumn","hitRow","changeCursor","resetCursor","rowH","handlers","lockedOn","cellEditor","addHandlers","attachEvents","uiHandler","element","overlay","getXY","offsetX","layerX","clientX","offsetLeft","offsetY","layerY","clientY","offsetTop","getTouchXY","touch","touches","changedTouches","mouseDown","mouseMove","mouseUp","click","dblClick","mouseWheel","stopPropagation","keyDown","keyPress","keyUp","ActiveSheetIndex","uiController","raiseOnChangeEventListener","openDocument","SelectionLabel","command","ui","execCmd","file","$refs","addOnChangeEventListener","originalValue","uiManager","localStorage","setItem","onLoad","onSave","getItem","win","File","FileReader","FileList","Blob","f","accept","files","reader","loadEvt","rawData","readAsText","alert","content","uriContent","encodeURIComponent","download","href","StatusBar","SheetSelector","OpenSheet","FormulaBar","RibbonMenu","error","config","productionTip","$mount"],"mappings":"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","file":"js/app.d413334a.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/OpenWebSheet/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./FormulaBar.vue?vue&type=style&index=0&id=88f8b63a&lang=scss&scoped=true&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./FormulaBar.vue?vue&type=style&index=0&id=88f8b63a&lang=scss&scoped=true&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./RibbonMenu.vue?vue&type=style&index=0&id=18ab77ce&scoped=true&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./RibbonMenu.vue?vue&type=style&index=0&id=18ab77ce&scoped=true&lang=css&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./StatusBar.vue?vue&type=style&index=0&id=2c4dd48e&lang=scss&scoped=true&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./StatusBar.vue?vue&type=style&index=0&id=2c4dd48e&lang=scss&scoped=true&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./OpenSheet.vue?vue&type=style&index=0&id=6835bc7c&scoped=true&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./OpenSheet.vue?vue&type=style&index=0&id=6835bc7c&scoped=true&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ColorPicker.vue?vue&type=style&index=0&id=1bf526e3&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ColorPicker.vue?vue&type=style&index=0&id=1bf526e3&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionGroup.vue?vue&type=style&index=0&id=5f4b089e&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionGroup.vue?vue&type=style&index=0&id=5f4b089e&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBox.vue?vue&type=style&index=0&id=fd2a2e58&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBox.vue?vue&type=style&index=0&id=fd2a2e58&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionButton.vue?vue&type=style&index=0&id=13139c76&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionButton.vue?vue&type=style&index=0&id=13139c76&lang=scss&scoped=true&\"","export interface IDateProvider {\n  getEvaluatedValue(key: string): any;\n}\n\n\nclass Env {\n  constructor(private ranges: any, private dataProvider: any) {\n  }\n\n  public Eval(txt: string) {\n    const _M_E_ = this;\n    const _R_A_N_G_E_ = this.ranges;\n\n    const PI = Math.PI;\n    const E = Math.E;\n\n    function SUM(selector: any) {\n      return _M_E_.data(selector).reduce((x: number, y: number) => x * 1 + y * 1, 0);\n    }\n\n    function MIN(selector: any) {\n      return _M_E_.data(selector).reduce((x: number, y: number) => Math.min(x * 1, y * 1), 0);\n    }\n\n    function MAX(selector: any) {\n      return _M_E_.data(selector).reduce((x: number, y: number) => Math.max(x * 1, y * 1), 0);\n    }\n\n    function SIN(v: number) {\n      return Math.sin(v);\n    }\n\n    function COS(v: number) {\n      return Math.cos(v);\n    }\n\n    function TAN(v: number) {\n      return Math.tan(v);\n    }\n\n    function ASIN(v: number) {\n      return Math.asin(v);\n    }\n\n    function ACOS(v: number) {\n      return Math.acos(v);\n    }\n\n    function ATAN(v: number) {\n      return Math.atan(v);\n    }\n\n    function ASINH(v: number) {\n      return Math.asinh(v);\n    }\n\n    function ACOSH(v: number) {\n      return Math.acosh(v);\n    }\n\n    function ATANH(v: number) {\n      return Math.atanh(v);\n    }\n\n    function ABS(v: number) {\n      return Math.abs(v);\n    }\n\n    function SQRT(v: number) {\n      return Math.sqrt(v);\n    }\n\n    function CBRT(v: number) {\n      return Math.cbrt(v);\n    }\n\n    function LOG(v: number) {\n      return Math.log(v);\n    }\n\n    function EXP(v: number) {\n      return Math.exp(v);\n    }\n\n    function TRUNC(v: number) {\n      return Math.trunc(v);\n    }\n\n    function CEIL(v: number) {\n      return Math.ceil(v);\n    }\n\n    function FLOOR(v: number) {\n      return Math.floor(v);\n    }\n\n\n    return eval(txt);\n  }\n\n  private data(selector: any) {\n    return this.dataProvider.getEvaluatedValue(selector);\n  }\n}\n\nexport class Evaluator {\n\n  public static Eval(dataProvider: IDateProvider, str: string) {\n    if (str.length < 1 || str[0] != '=') {\n      return str;\n    }\n\n    let m;\n    const regex = this.valueRegex;\n    let temp = str;\n\n    const ranges: any[] = [];\n    let range_index = 0;\n    while ((m = regex.exec(str)) !== null) {\n      // This is necessary to avoid infinite loops with zero-width matches\n      if (m.index === regex.lastIndex) {\n        regex.lastIndex++;\n      }\n\n      m.forEach((match, groupIndex) => {\n        if (match && match.indexOf(':') != -1) {\n          ranges.push(match);\n          temp = temp.replace(match + '', `_R_A_N_G_E_[${range_index++}]`);\n        } else if (groupIndex == 0) {\n          const ev = dataProvider.getEvaluatedValue(match);\n          temp = temp.replace(match, ev);\n        }\n      });\n    }\n\n    try {\n      return new Env(ranges, dataProvider).Eval(temp.substr(1));\n    } catch (err) {\n      return '#ERR';\n    }\n\n  }\n\n\n  private static valueRegex = /(([a-zA-Z]+[0-9])+\\:?([a-zA-Z]+[0-9]+)?)/g;\n\n\n}\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CellBorderStyle.vue?vue&type=style&index=0&id=10426fd3&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CellBorderStyle.vue?vue&type=style&index=0&id=10426fd3&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('ribbon-menu',{attrs:{\"appearance\":_vm.appearance,\"state\":_vm.state},on:{\"mode-changed\":_vm.onModeChanged,\"action\":_vm.onAction}}),_c('formula-bar',{attrs:{\"label\":_vm.state.label},on:{\"commit\":_vm.onCommit,\"abort\":_vm.onAbort},model:{value:(_vm.state.value),callback:function ($$v) {_vm.$set(_vm.state, \"value\", $$v)},expression:\"state.value\"}}),_c('open-sheet',{ref:\"sheet\",on:{\"ready\":_vm.onReady,\"change\":_vm.onChange}}),_c('status-bar')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('ribbon',{attrs:{\"menu\":_vm.menu},model:{value:(_vm.active),callback:function ($$v) {_vm.active=$$v},expression:\"active\"}},[_c('div',{attrs:{\"slot\":\"menu-home\"},slot:\"menu-home\"},[(_vm.isLocalMode)?_c('control-box',{attrs:{\"label\":\"Local Storage\"}},[_c('span',{staticStyle:{\"display\":\"flex\",\"align-content\":\"center\",\"flex-direction\":\"column\",\"align-items\":\"center\"}},[_c('i',{staticClass:\"far fa-times-circle xx-large-font flat-button\",on:{\"click\":function($event){return _vm.changeMode('file')}}}),_c('span',{staticStyle:{\"padding\":\"5px\"}},[_vm._v(\" Back to file mode \")])])]):_c('control-box',{staticClass:\"last\",attrs:{\"label\":\"Document\"}},[_c('div',{staticStyle:{\"display\":\"flex\",\"padding\":\"10px 5px\",\"text-align\":\"center\"}},[_c('i',{staticClass:\"fas fa-save x-large-font flat-button\",on:{\"click\":function($event){return _vm.onAction('save-ows')}}}),_c('span',{staticClass:\"seperator\"}),_c('i',{staticClass:\"fas fa-folder x-large-font flat-button\",on:{\"click\":function($event){return _vm.onAction('load-ows')}}}),_c('span',{staticClass:\"seperator\"}),_c('i',{staticClass:\"fas fa-warehouse x-large-font flat-button\",on:{\"click\":function($event){return _vm.changeMode('local')}}})])]),_c('control-box',{staticClass:\"independent\",attrs:{\"label\":\"Font\"}},[_c('p',[_c('font-family-selector',{model:{value:(_vm.fontFamily),callback:function ($$v) {_vm.fontFamily=$$v},expression:\"fontFamily\"}}),_c('font-size-selector',{model:{value:(_vm.fontSize),callback:function ($$v) {_vm.fontSize=$$v},expression:\"fontSize\"}})],1),_c('p',[_c('action-group',{staticStyle:{\"float\":\"left\",\"margin-right\":\"15px\"},attrs:{\"value\":_vm.fontStyle},on:{\"action\":_vm.onAction}},[_c('i',{staticClass:\"fa fa-bold\",attrs:{\"slot\":\"bold\"},slot:\"bold\"}),_c('i',{staticClass:\"fa fa-italic\",attrs:{\"slot\":\"italic\"},slot:\"italic\"}),_c('i',{staticClass:\"fa fa-underline\",attrs:{\"slot\":\"underline\"},slot:\"underline\"})]),_c('color-picker',{model:{value:(_vm.foreColor),callback:function ($$v) {_vm.foreColor=$$v},expression:\"foreColor\"}},[_c('i',{staticClass:\"fas fa-palette\"})])],1)]),_c('control-box',{staticClass:\"last\",attrs:{\"label\":\"Format\"}},[_c('p',[_c('color-picker',{attrs:{\"label\":\"Fill color\"},model:{value:(_vm.fillColor),callback:function ($$v) {_vm.fillColor=$$v},expression:\"fillColor\"}},[_c('i',{staticClass:\"fa fa-fill\",attrs:{\"slot\":\"prefix\"},slot:\"prefix\"})])],1),_c('p',[_c('action-group',{attrs:{\"value\":_vm.textAlignment},on:{\"action\":_vm.onAlign}},[_c('i',{staticClass:\"fa fa-align-left\",attrs:{\"slot\":\"left\"},slot:\"left\"}),_c('i',{staticClass:\"fa fa-align-center\",attrs:{\"slot\":\"center\"},slot:\"center\"}),_c('i',{staticClass:\"fa fa-align-right\",attrs:{\"slot\":\"right\"},slot:\"right\"})])],1)]),_c('control-box',{staticClass:\"independent\",attrs:{\"label\":\"Cell\"}},[_c('p',[_c('action-button',{class:{on:_vm.state.isMerged},attrs:{\"label\":\"Merge\"},on:{\"click\":_vm.toggleMerge}},[_c('i',{staticClass:\"fa fa-th\",attrs:{\"slot\":\"prefix\"},slot:\"prefix\"})])],1),_c('p',[_c('color-picker',{attrs:{\"label\":\"Border\"},model:{value:(_vm.borderColor),callback:function ($$v) {_vm.borderColor=$$v},expression:\"borderColor\"}})],1)]),_c('control-box',{attrs:{\"label\":\"Borders\"}},[_c('cell-border-style',{on:{\"change\":_vm.onBorderChanged}})],1)],1),_c('div',{attrs:{\"slot\":\"menu-formulas\"},slot:\"menu-formulas\"},[_c('control-box',{staticStyle:{\"flex\":\"1\"},attrs:{\"label\":\"Mathematical\"}}),_c('control-box',{staticClass:\"last\",staticStyle:{\"flex\":\"1\"},attrs:{\"label\":\"Statistics\"}}),_c('control-box',{staticClass:\"independent\",staticStyle:{\"flex\":\"3\"},attrs:{\"label\":\"User Defined Functions\"}})],1),_c('div',{attrs:{\"slot\":\"menu-data\"},slot:\"menu-data\"},[_c('control-box',{attrs:{\"label\":\"File\"}},[_c('div',{staticStyle:{\"margin\":\"10px 20px\"}},[_c('i',{staticClass:\"fa fa-file-excel\",staticStyle:{\"font-size\":\"xx-large\"}})])]),_c('control-box',{attrs:{\"label\":\"Open Office\"}},[_c('action-group',{attrs:{\"value\":[{name:'import',label:'Import'},{name:'export',label:'Export'}]}})],1),_c('control-box',{staticClass:\"last\",staticStyle:{\"flex\":\"1\"},attrs:{\"label\":\"MS Excel\"}},[_c('action-group',{attrs:{\"value\":[{name:'import',label:'Import'},{name:'export',label:'Export'}]}})],1),_c('control-box',{staticStyle:{\"flex\":\"4\"},attrs:{\"label\":\"3rd Parties\"}})],1),_c('div',{attrs:{\"slot\":\"menu-view\"},slot:\"menu-view\"},[_c('control-box',{attrs:{\"label\":\"Print\"}},[_c('div',{staticStyle:{\"margin\":\"5px 20px\"}},[_c('i',{staticClass:\"fa fa-print\",staticStyle:{\"font-size\":\"xx-large\"}})])]),_c('control-box',{staticStyle:{\"flex\":\"1\"},attrs:{\"label\":\"Layout\"}})],1),_c('div',{staticStyle:{\"flex\":\"1\"},attrs:{\"slot\":\"menu-info\"},slot:\"menu-info\"},[_c('control-box',{attrs:{\"label\":\"OSI\"}},[_c('span',{staticStyle:{\"font-size\":\"xx-large\",\"color\":\"#00454d\",\"font-weight\":\"bold\"}},[_c('i',{staticClass:\"fab fa-osi\"})])]),_c('control-box',{staticStyle:{\"flex\":\"1\"},attrs:{\"label\":\"About Open Web Sheet Project\",\"grid\":false}},[_c('span',{staticStyle:{\"flex\":\"1\"}},[_vm._v(\" Designed and developed by \"),_c('strong',[_vm._v(\"Siamand Maroufi\")]),_c('br'),_vm._v(\" 3rd Parties: \"),_c('strong',[_vm._v(\"FontAwesome Icons\")]),_vm._v(\" & \"),_c('strong',[_vm._v(\"Google noto web font\")]),_c('br'),_vm._v(\" Licence: \"),_c('strong',[_vm._v(\"MIT Licence\")])]),_c('span',{staticStyle:{\"align-self\":\"flex-start\"}},[_c('a',{attrs:{\"href\":\"https://siamand.cc\"}},[_c('i',{staticClass:\"fa fa-link\"}),_vm._v(\" Developer's site\")]),_vm._v(\" | \"),_c('a',{attrs:{\"href\":\"https://github.com/SiamandMaroufi/OpenWebSheet\"}},[_c('i',{staticClass:\"fab fa-github\"}),_vm._v(\" Source Code\")])])])],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"ribbon-menu\"},[_c('ul',{staticClass:\"menu\",attrs:{\"data-qa\":\"menu\"}},_vm._l((_vm.menu),function(item){return _c('li',{key:item.name,staticClass:\"menu-label\",class:{'active':_vm.active===item.name},attrs:{\"data-qa\":item},on:{\"click\":function($event){_vm.active = item.name}}},[_vm._v(\" \"+_vm._s(item.label)+\" \")])}),0),_c('div',{staticClass:\"menu-content\"},_vm._l((_vm.menu),function(item){return _c('div',{key:item.name,staticClass:\"menu-content-item\",class:{'active': (_vm.active === item.name)}},[_vm._t(item.name,[_c('fieldset',[_c('legend',[_vm._v(_vm._s(item.label))]),_c('span',{staticClass:\"default-place-holder\"},[_vm._v(\"placeholder for \"+_vm._s(item.name))])])])],2)}),0)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\nimport { Component, Prop, Vue } from 'vue-property-decorator';\nimport { RibbonMenuItem } from '@/components/RibbonMenu';\n\n@Component({name: 'Ribbon'})\nexport default class Ribbon extends Vue {\n  @Prop({required: true})\n  public value!: string;\n\n  @Prop({required: true})\n  public menu!: RibbonMenuItem[];\n\n  get active() {\n    return this.value;\n  }\n\n  set active(newValue) {\n    this.$emit('input', newValue);\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ribbon.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ribbon.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Ribbon.vue?vue&type=template&id=244e0240&scoped=true&\"\nimport script from \"./Ribbon.vue?vue&type=script&lang=ts&\"\nexport * from \"./Ribbon.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Ribbon.vue?vue&type=style&index=0&id=244e0240&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"244e0240\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"control-box\",attrs:{\"data-qa\":\"control-box\"}},[_c('div',{staticClass:\"control-box-controls\",style:({display:_vm.grid?'grid':'flex'}),attrs:{\"data-qa\":\"content\"}},[_vm._t(\"default\")],2),(_vm.label)?_c('div',{staticClass:\"control-box-header\",attrs:{\"data-qa\":\"header\"}},[_vm._v(_vm._s(_vm.label))]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\nimport { Component, Prop } from 'vue-property-decorator';\nimport Vue from 'vue';\n\n@Component({name: 'ControlBox'})\nexport default class ControlBox extends Vue {\n  @Prop()\n  public label?: string;\n\n  @Prop({default: true})\n  public grid!: boolean;\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBox.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBox.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ControlBox.vue?vue&type=template&id=fd2a2e58&scoped=true&\"\nimport script from \"./ControlBox.vue?vue&type=script&lang=ts&\"\nexport * from \"./ControlBox.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ControlBox.vue?vue&type=style&index=0&id=fd2a2e58&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"fd2a2e58\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"cell-border-style\",attrs:{\"data-qa\":\"cell-border\"}},[_c('div',{staticClass:\"borders all\",attrs:{\"data-qa\":\"full\"},on:{\"click\":function($event){return _vm.$emit('change','full-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders inside\",attrs:{\"data-qa\":\"cross\"},on:{\"click\":function($event){return _vm.$emit('change','cross-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders horizontal\",attrs:{\"data-qa\":\"hor\"},on:{\"click\":function($event){return _vm.$emit('change','horizontal-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders vertical\",attrs:{\"data-qa\":\"ver\"},on:{\"click\":function($event){return _vm.$emit('change','vertical-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders outside\",attrs:{\"data-qa\":\"out\"},on:{\"click\":function($event){return _vm.$emit('change','outside-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders left\",attrs:{\"data-qa\":\"left\"},on:{\"click\":function($event){return _vm.$emit('change','left-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders top\",attrs:{\"data-qa\":\"top\"},on:{\"click\":function($event){return _vm.$emit('change','top-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders right\",attrs:{\"data-qa\":\"right\"},on:{\"click\":function($event){return _vm.$emit('change','right-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders bottom\",attrs:{\"data-qa\":\"bottom\"},on:{\"click\":function($event){return _vm.$emit('change','bottom-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})]),_c('div',{staticClass:\"borders\",attrs:{\"data-qa\":\"no\"},on:{\"click\":function($event){return _vm.$emit('change','no-border')}}},[_c('div',{staticClass:\"top\"}),_c('div',{staticClass:\"right\"}),_c('div',{staticClass:\"left\"}),_c('div',{staticClass:\"bottom\"})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\nimport { Component } from 'vue-property-decorator';\nimport Vue from 'vue';\n\n@Component({name: 'cell-border-style'})\nexport default class CellBorderStyle extends Vue {\n\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CellBorderStyle.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CellBorderStyle.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./CellBorderStyle.vue?vue&type=template&id=10426fd3&scoped=true&\"\nimport script from \"./CellBorderStyle.vue?vue&type=script&lang=ts&\"\nexport * from \"./CellBorderStyle.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./CellBorderStyle.vue?vue&type=style&index=0&id=10426fd3&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"10426fd3\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.selectedSize),expression:\"selectedSize\"}],staticClass:\"font-size\",on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.selectedSize=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},_vm._l((_vm.sizes),function(size){return _c('option',{key:size,domProps:{\"value\":size}},[_vm._v(\" \"+_vm._s(size)+\" \")])}),0)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\nimport { Component, Prop } from 'vue-property-decorator';\nimport Vue from 'vue';\n\n@Component({name: 'font-size-selector'})\nexport default class FontSizeSelector extends Vue {\n  @Prop({default: 12})\n  public value!: number;\n\n  public sizes = [6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 20, 22, 24, 26, 28, 32, 36, 48, 72];\n\n  get selectedSize() {\n    return this.value;\n  }\n\n  set selectedSize(newValue: number) {\n    this.$emit('input', newValue);\n    this.$emit('change', newValue);\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FontSizeSelector.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FontSizeSelector.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./FontSizeSelector.vue?vue&type=template&id=0c8e833d&\"\nimport script from \"./FontSizeSelector.vue?vue&type=script&lang=ts&\"\nexport * from \"./FontSizeSelector.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"action-group\",attrs:{\"data-qa\":\"action-group\"}},_vm._l((_vm.actions),function(action){return _c('action-button',{key:action.name,staticClass:\"action-group-item\",class:{'on':action.selected},attrs:{\"disabled\":action.disabled,\"data-qa\":\"action-item\",\"data-qa-name\":action.name},on:{\"click\":function($event){return _vm.$emit('action',action.name)}}},[_vm._t(action.name,[_vm._v(\" \"+_vm._s(action.label)+\" \")])],2)}),1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('button',{staticClass:\"action\",attrs:{\"disabled\":_vm.disabled,\"data-qa\":\"action\"},on:{\"click\":function($event){return _vm.$emit('click')}}},[_vm._t(\"default\",[_vm._t(\"prefix\"),_vm._v(\" \"+_vm._s(_vm.label)+\" \"),_vm._t(\"postfix\")])],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop } from 'vue-property-decorator';\nimport Vue from 'vue';\n\n@Component({name: 'ActionButton'})\nexport default class ActionButton extends Vue {\n  @Prop()\n  public label?: string;\n\n  @Prop({default: false})\n  public disabled!: boolean;\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ActionButton.vue?vue&type=template&id=13139c76&scoped=true&\"\nimport script from \"./ActionButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./ActionButton.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ActionButton.vue?vue&type=style&index=0&id=13139c76&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"13139c76\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop } from 'vue-property-decorator';\nimport Vue from 'vue';\nimport Action from './Action';\nimport ActionButton from '@/components/ActionButton.vue';\n\n\n@Component({\n  name: 'ActionGroup',\n  components: {ActionButton},\n})\nexport default class ActionGroup extends Vue {\n  @Prop({required: true})\n  public value!: Action[];\n\n  get actions() {\n    return this.value;\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionGroup.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ActionGroup.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ActionGroup.vue?vue&type=template&id=5f4b089e&scoped=true&\"\nimport script from \"./ActionGroup.vue?vue&type=script&lang=ts&\"\nexport * from \"./ActionGroup.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ActionGroup.vue?vue&type=style&index=0&id=5f4b089e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5f4b089e\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"color-picker\",attrs:{\"data-qa\":\"color-picker\"}},[_c('label',{attrs:{\"data-qa\":\"label\"}},[_vm._t(\"default\",[(!!_vm.$slots['prefix'])?_c('span',{staticClass:\"prefix\"},[_vm._t(\"prefix\")],2):_vm._e(),_vm._v(\" \"+_vm._s(_vm.label)+\" \"),_vm._t(\"postfix\")])],2),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.color),expression:\"color\"}],attrs:{\"type\":\"color\",\"data-qa\":\"input-el\"},domProps:{\"value\":(_vm.color)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.color=$event.target.value}}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\nimport { Component, Prop } from 'vue-property-decorator';\nimport Vue from 'vue';\n\n@Component({name: 'ColorPicker'})\nexport default class ColorPicker extends Vue {\n  @Prop({default: '#ffffff'})\n  public value!: string;\n\n  @Prop()\n  public label?: string;\n\n  get color() {\n    if (!this.value) {\n      return '#ffffff';\n    }\n    return this.value;\n  }\n\n  set color(newValue) {\n    this.$emit('input', newValue);\n  }\n}\n","import { Color } from '@/lib/common/types';\n\nexport enum TextAlign {\n  Left,\n  Right,\n  Center,\n}\n\nexport enum BorderStyle {\n  SolidThin,\n  SolidThick,\n  SolidDouble,\n  DottedThin,\n  DottedThick,\n  DashedThin,\n  DashedThick,\n  DotDashedThin,\n  DotDashedThick,\n}\n\nexport class Border {\n\n  public static from(data: { style: BorderStyle, color: string }): Border {\n    const border = new Border();\n    border.style = data.style;\n    border.color = data.color;\n    return border;\n  }\n\n  public style: BorderStyle = BorderStyle.SolidThin;\n  public constructor(public color: string | null = null) {\n\n  }\n}\n\nexport class Appearance {\n\n  public get bold() {\n    return !!(this.textStyle && this.textStyle.indexOf('bold') != -1);\n  }\n\n  public set bold(value: boolean) {\n    this.ensureTextStyle();\n    if (this.bold == value) { return; }\n    if (value) { this.textStyle = `${this.textStyle} bold`; } else { this.textStyle = this.textStyle.replace('bold', ''); }\n  }\n\n  public get italic() {\n    return !!(this.textStyle && this.textStyle.indexOf('italic') != -1);\n  }\n\n  public set italic(value: boolean) {\n    this.ensureTextStyle();\n    if (this.italic == value) { return; }\n    if (value) { this.textStyle = `${this.textStyle} italic`; } else { this.textStyle = this.textStyle.replace('italic', ''); }\n  }\n\n  public get underline() {\n    return !!(this.textStyle && this.textStyle.indexOf('underline') != -1);\n  }\n\n  public set underline(value: boolean) {\n    this.ensureTextStyle();\n    if (this.italic == value || !this.textStyle) { return; }\n    if (value) { this.textStyle = `${this.textStyle} underline`; } else { this.textStyle = this.textStyle.replace('underline', ''); }\n  }\n\n  public static from(data: {\n    textAlign: any,\n    textStyle: any,\n    fontName: string,\n    fontSize: number,\n    text: string,\n    background: string,\n    horizontalBorder: any,\n    verticalBorder: any,\n  }) {\n    const app = new Appearance();\n    app.textAlign = data.textAlign;\n    app.textStyle = data.textStyle;\n    app.fontName = data.fontName;\n    app.fontSize = data.fontSize;\n    app.text = data.text;\n    app.background = data.background;\n    app.horizontalBorder = data.horizontalBorder && Border.from(data.horizontalBorder);\n    app.verticalBorder = data.verticalBorder && Border.from(data.verticalBorder);\n\n    return app;\n  }\n  public textAlign: TextAlign = TextAlign.Left;\n  public fontName: string = 'Lato';\n  public fontSize: number = 12;\n  public textStyle: any;\n  public text: any;\n  public background: any;\n  public horizontalBorder?: Border | null;\n  public verticalBorder?: Border | null;\n\n  public alignTextTo(value: string) {\n    if (value.toLowerCase() == 'right') {\n      this.textAlign = TextAlign.Right;\n    } else if (value.toLowerCase() == 'center') {\n      this.textAlign = TextAlign.Center;\n    } else if (value.toLowerCase() == 'left') {\n      this.textAlign = TextAlign.Left;\n    } else {\n      throw new Error(`invalid text-align '${value}'`);\n    }\n\n  }\n\n  public setHorizontal(value: Color) {\n    this.horizontalBorder = new Border();\n    this.horizontalBorder.style = BorderStyle.SolidThin;\n    this.horizontalBorder.color = value;\n  }\n\n  public setVertical(value: Color) {\n    this.verticalBorder = new Border();\n    this.verticalBorder.style = BorderStyle.SolidThin;\n    this.verticalBorder.color = value;\n  }\n\n  private ensureTextStyle() {\n    if (!this.textStyle) {\n      this.textStyle = '';\n    }\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ColorPicker.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ColorPicker.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./ColorPicker.vue?vue&type=template&id=1bf526e3&scoped=true&\"\nimport script from \"./ColorPicker.vue?vue&type=script&lang=ts&\"\nexport * from \"./ColorPicker.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./ColorPicker.vue?vue&type=style&index=0&id=1bf526e3&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1bf526e3\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.selectedFamily),expression:\"selectedFamily\"}],staticClass:\"font-family\",attrs:{\"data-qa\":\"font-name-selector\"},on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.selectedFamily=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},_vm._l((_vm.families),function(family){return _c('option',{key:family,domProps:{\"value\":family}},[_vm._v(\" \"+_vm._s(family)+\" \")])}),0)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\nimport { Component, Prop } from 'vue-property-decorator';\nimport Vue from 'vue';\n\n@Component({name: 'font-family-selector'})\nexport default class FontFamilySelector extends Vue {\n  @Prop({default: 'Lato'})\n  public value!: string;\n\n  public families = ['Lato', 'Sans', 'Serif', 'Courier', 'Courier New'];\n\n  get selectedFamily() {\n    return this.value;\n  }\n\n  set selectedFamily(newValue: string) {\n    this.$emit('input', newValue);\n    this.$emit('change', newValue);\n  }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FontNameSelector.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FontNameSelector.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./FontNameSelector.vue?vue&type=template&id=2e2433a7&\"\nimport script from \"./FontNameSelector.vue?vue&type=script&lang=ts&\"\nexport * from \"./FontNameSelector.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\nimport { Component, Prop } from 'vue-property-decorator';\nimport Vue from 'vue';\nimport { RibbonMenuItem } from '@/components/RibbonMenu';\nimport Ribbon from '@/components/Ribbon.vue';\nimport ControlBox from '@/components/ControlBox.vue';\nimport CellBorderStyle from '@/components/CellBorderStyle.vue';\nimport FontSizeSelector from '@/components/FontSizeSelector.vue';\nimport ActionGroup from '@/components/ActionGroup.vue';\nimport ColorPicker from '@/components/ColorPicker.vue';\nimport ActionButton from '@/components/ActionButton.vue';\nimport { Appearance, TextAlign } from '@/lib/core/Appearance';\nimport FontFamilySelector from '@/components/FontNameSelector.vue';\nimport { Color } from '@/lib/common/types';\n\n@Component({\n  name: 'RibbonMenu',\n  components: {\n    FontFamilySelector,\n    ActionButton, ColorPicker, ActionGroup, FontSizeSelector, CellBorderStyle, ControlBox, Ribbon,\n  },\n})\nexport default class RibbonMenu extends Vue {\n\n  get isLocalMode() {\n    return this.fileMode === 'local';\n  }\n\n  get activeStyle() {\n    return this.appearance || new Appearance();\n  }\n\n  get textAlignment() {\n    return [\n      {\n        name: 'left',\n        selected: this.activeStyle.textAlign === TextAlign.Left,\n      },\n      {\n        name: 'center',\n        selected: this.activeStyle.textAlign === TextAlign.Center,\n      },\n      {\n        name: 'right',\n        selected: this.activeStyle.textAlign === TextAlign.Right,\n      },\n    ];\n  }\n\n  get fontStyle() {\n    return [\n      {name: 'bold', selected: this.activeStyle.bold},\n      {name: 'italic', selected: this.activeStyle.italic},\n      {name: 'underline', selected: this.activeStyle.underline},\n    ];\n  }\n\n  get foreColor() {\n    return this.activeStyle.text;\n  }\n\n  set foreColor(color: string) {\n    this.onAction('fg-color', color);\n  }\n\n  get fillColor() {\n    return this.activeStyle.background;\n  }\n\n  set fillColor(color: string) {\n    this.onAction('bg-color', color);\n  }\n\n  get fontSize() {\n    return this.activeStyle.fontSize;\n  }\n\n  set fontSize(newSize: number) {\n    this.onAction('font-size', newSize);\n  }\n\n  get fontFamily() {\n    return this.activeStyle.fontName;\n  }\n\n  set fontFamily(newFont: string) {\n    this.onAction('font-name', newFont);\n  }\n  public active = 'menu-home';\n\n  @Prop()\n  public appearance!: Appearance;\n\n  @Prop({default: () => ({isMerged: true})})\n  public state!: { isMerged: boolean };\n\n  public borderColor: Color = 'black';\n\n  public menu: RibbonMenuItem[] = [\n    {name: 'menu-home', label: 'Home'},\n    {name: 'menu-formulas', label: 'Formulas'},\n    {name: 'menu-data', label: 'Data'},\n    {name: 'menu-view', label: 'View'},\n    {name: 'menu-info', label: 'About'},\n  ];\n  private fileMode = 'file';\n\n  public changeMode(newMode: string) {\n    this.fileMode = newMode;\n    this.$emit('mode-changed', newMode );\n  }\n\n  public onBorderChanged(borderStructure: string) {\n    this.onAction(borderStructure, this.borderColor);\n  }\n\n  public onAlign(alignment: string) {\n    this.onAction('align', alignment);\n  }\n\n  public toggleMerge() {\n    this.onAction(this.state.isMerged ? 'unmerge' : 'merge');\n  }\n\n  public onAction(actionName: string, args?: any) {\n    this.$emit('action', {actionName, args});\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./RibbonMenu.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./RibbonMenu.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./RibbonMenu.vue?vue&type=template&id=18ab77ce&scoped=true&\"\nimport script from \"./RibbonMenu.vue?vue&type=script&lang=ts&\"\nexport * from \"./RibbonMenu.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./RibbonMenu.vue?vue&type=style&index=0&id=18ab77ce&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"18ab77ce\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"formula-bar\",class:{active: _vm.active}},[_c('input',{staticClass:\"cell-name\",attrs:{\"type\":\"text\",\"placeholder\":\"SELECTION\"},domProps:{\"value\":_vm.label}}),_c('span',{staticClass:\"side\"},[_c('span',{staticClass:\"actions\"},[_c('i',{staticClass:\"fa fa-times cancel\",on:{\"click\":function($event){return _vm.$emit('abort')}}}),_c('i',{staticClass:\"fa fa-check commit\",on:{\"click\":function($event){return _vm.$emit('commit')}}})]),_vm._v(\"  \")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.formula),expression:\"formula\"}],staticClass:\"formula\",attrs:{\"id\":\"formula-input\",\"type\":\"text\"},domProps:{\"value\":(_vm.formula)},on:{\"focusin\":function($event){_vm.active=true},\"focusout\":function($event){_vm.active=false},\"input\":function($event){if($event.target.composing){ return; }_vm.formula=$event.target.value}}}),_vm._m(0)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"arrow\"},[_c('i',{staticClass:\"fas fa-angle-down\"})])}]\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop } from 'vue-property-decorator';\nimport Vue from 'vue';\n\n@Component({name: 'FormulaBar'})\nexport default class FormulaBar extends Vue {\n  public active = false;\n\n  @Prop()\n  public value!: string;\n\n  @Prop()\n  public label!: string;\n\n  get formula() {\n    return this.value;\n  }\n\n  set formula(newFormula: string) {\n    this.$emit('input', newFormula);\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./FormulaBar.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./FormulaBar.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./FormulaBar.vue?vue&type=template&id=88f8b63a&scoped=true&\"\nimport script from \"./FormulaBar.vue?vue&type=script&lang=ts&\"\nexport * from \"./FormulaBar.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./FormulaBar.vue?vue&type=style&index=0&id=88f8b63a&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"88f8b63a\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"canvas-container\",staticClass:\"open-sheet\"})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export class Cell {\n\n  public get isMerged() {\n    return this.reference !== null;\n  }\n\n  public get columnId() {\n    return this._columnId;\n  }\n\n  public get rowId() {\n    return this._rowId;\n  }\n\n  public get label() {\n    return this.formattedValue;\n  }\n\n  public get value() {\n    return this._value;\n  }\n\n  public set value(newValue) {\n    this.update(newValue, newValue);\n  }\n\n  public get top(): number {\n    if (this.isMerged && this.reference) {\n      return this.reference.top;\n    }\n\n    return this.rowId;\n  }\n\n  public get left(): number {\n    if (this.isMerged && this.reference) {\n      return this.reference.left;\n    }\n\n    return this.columnId;\n  }\n\n  public get bottom(): number {\n    if (this.isMerged && this.reference) {\n      return this.reference.bottom;\n    }\n\n    return this.rowId + this.rowSpan;\n  }\n\n  public get right(): number {\n    if (this.isMerged && this.reference) {\n      return this.reference.right;\n    }\n\n    return this.columnId + this.colSpan;\n  }\n\n  public static from(data: any): Cell {\n    const cell = new Cell(data.columnId, data.rowId);\n    cell.colSpan = data.colSpan;\n    cell.rowSpan = data.rowSpan;\n    cell.formattedValue = data.formattedValue;\n    cell.evaluatedValue = data.evaluatedValue;\n    cell._columnId = data._columnId;\n    cell._rowId = data._rowId;\n    cell._value = data._value;\n    cell.reference = data.reference && this.from(data.reference);\n    return cell;\n  }\n  public colSpan: number = 1;\n  public rowSpan: number = 1;\n\n  // merged cell has following value\n  public reference: Cell | null = null;\n\n  private formattedValue?: string;\n  private evaluatedValue?: string;\n  private _columnId: number;\n  private _rowId: number;\n  private _value: any = null;\n\n  public constructor(columnId: number, rowId: number) {\n    this._columnId = columnId;\n    this._rowId = rowId;\n  }\n\n  public update(newValue: any, evaluated: any): void {\n    this._value = newValue;\n    this.evaluatedValue = evaluated;\n    this.format();\n  }\n\n  public to(): any {\n    return {\n      colSpan: this.colSpan,\n      rowSpan: this.rowSpan,\n      formattedValue: this.formattedValue,\n      evaluatedValue: this.evaluatedValue,\n      _columnId: this._columnId,\n      _rowId: this._rowId,\n      _value: this._value,\n      reference: this.reference && this.reference.to(),\n    };\n  }\n\n  private format() {\n    this.formattedValue = this.evaluatedValue;\n  }\n}\n","export const SheetTitleHeight: number = 30;\nexport const SheetTitleWidth: number = 110;\nexport const ColumnHeaderHeight: number = 30;\nexport const ColumnDefaultWidth: number = 100;\nexport const RowHeaderWidth: number = 30;\nexport const RowDefaultHeight: number = 30;\n\nexport const COLOR_LIGHT = '#fff';\nexport const COLOR_GRAY  = '#ccc';\nexport const COLOR_LIGHT_GRAY  = '#fafafa';\nexport const COLOR_CREAM = '#fffdd0';\nexport const COLOR_0 = '#4CAF50';\nexport const COLOR_1 = '#00897b';\nexport const COLOR_2 = '#00796b';\nexport const COLOR_3 = '#00454d';\n","import { Cell } from './Cell';\nimport { Appearance, Border } from './Appearance';\nimport { ColumnDefaultWidth, RowDefaultHeight, SheetTitleWidth } from '../common/constants';\nimport { Evaluator, IDateProvider } from './formula/Evaluator';\n\n\nexport class CellSelection {\n  public left: number = 0;\n  public top: number = 0;\n  public right: number = 0;\n  public bottom: number = 0;\n\n  public rowId: number = 0;\n  public columnId: number = 0;\n\n  public get single() {\n    return this.right == this.left && this.top == this.bottom;\n  }\n\n  public toString() {\n    return `${this.top} ${this.left} - ${this.bottom} ${this.right}`;\n  }\n}\n\nexport class Sheet implements IDateProvider {\n\n  public get SelectionLabel() {\n    return this.getCellName(this.selection.columnId, this.selection.rowId);\n  }\n\n  public get SelectedValue() {\n    return this.selectedCell && this.selectedCell.value;\n  }\n\n  public get SelectedAppearance() {\n    return this.getAppearance(this.selection.columnId, this.selection.rowId);\n  }\n\n  get selectedCell() {\n    return this.getCell(this.selection.columnId, this.selection.rowId);\n  }\n\n  private get invalidSelection() {\n    return this.selectedCell && this.selectedCell.isMerged;\n  }\n\n  public get scrollColumn() {\n    return this.scrollX;\n  }\n\n  public get scrollRow() {\n    return this.scrollY;\n  }\n\n  public static get_columnName(column: number) {\n    const az = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\n    let columnString = '';\n    let columnNumber = column + 1;\n    while (columnNumber > 0) {\n      const currentLetterNumber = (columnNumber - 1) % 26;\n      const currentLetter = az[currentLetterNumber];\n      columnString = currentLetter + columnString;\n      columnNumber = (columnNumber - (currentLetterNumber + 1)) / 26;\n    }\n    return columnString;\n  }\n\n  public static load(sheet: any): Sheet {\n    const sh = new Sheet(sheet.title);\n    sh.fill(sheet.data);\n    sh.style(sheet.appearance);\n    sh.columnAppearance = sheet.columnAppearance;\n    sh.rowAppearance = sheet.rowAppearance;\n    sh.columnWidth = sheet.columnWidth;\n    sh.rowHeight = sheet.rowHeight;\n    sh.scrollX = sheet.scrollX;\n    sh.scrollY = sheet.scrollY;\n    sh.selection = sheet.selection;\n\n    return sh;\n  }\n  public defaultAppearance: Appearance = new Appearance();\n  public defaultRowHeight = 30;\n  public defaultColumnWidth = 100;\n  public selection: CellSelection;\n\n  private data: any[] = [];\n  private appearance: any[] = [];\n  private columnAppearance: Appearance[] = [];\n  private rowAppearance: Appearance[] = [];\n  private rowHeight: number[] = [];\n  private columnWidth: number[] = [];\n  private scrollX: number = 0;\n  private scrollY: number = 0;\n  private change_listeners: Array<() => void> = [];\n\n  constructor(public title: string) {\n    this.defaultAppearance.background = null;\n    this.defaultAppearance.fontName = 'Lato';\n    this.defaultAppearance.fontSize = 12;\n    this.defaultAppearance.horizontalBorder = null;\n    this.defaultAppearance.verticalBorder = null;\n    this.defaultAppearance.text = '#333333';\n\n\n    this.selection = new CellSelection();\n    this.selection.top = 0;\n    this.selection.left = 0;\n    this.selection.right = 0;\n    this.selection.bottom = 0;\n    this.selection.rowId = 0;\n    this.selection.columnId = 0;\n  }\n\n  public selectNextColumnCell() {\n    this.selection.columnId++;\n\n    if (this.selection.single) {\n      this.selection.right = this.selection.columnId;\n      this.selection.left = this.selection.columnId;\n      this.onChange();\n      return;\n    }\n\n    if (this.selection.columnId > this.selection.right) {\n      this.selection.columnId = this.selection.left;\n      if (this.selection.rowId == this.selection.bottom) {\n        this.selection.rowId = this.selection.top;\n      } else {\n        this.selectNextRowCell();\n      }\n\n    }\n\n    if (this.invalidSelection) { this.selectNextColumnCell(); }\n    this.onChange();\n  }\n\n  public selectPreviousColumnCell() {\n    if (this.selection.columnId == 0) { return; }\n    this.selection.columnId--;\n\n    if (this.selection.single) {\n      this.selection.right = this.selection.columnId;\n      this.selection.left = this.selection.columnId;\n      this.onChange();\n      return;\n    }\n\n    if (this.selection.columnId < this.selection.left) {\n      this.selection.columnId = this.selection.right;\n      if (this.selection.rowId == this.selection.top) {\n        this.selection.rowId = this.selection.bottom;\n      } else {\n        this.selectPreviousRowCell();\n      }\n    }\n\n    if (this.invalidSelection) { this.selectPreviousColumnCell(); }\n    this.onChange();\n  }\n\n  public selectNextRowCell() {\n\n    this.selection.rowId++;\n    if (this.selection.single) {\n      this.selection.top = this.selection.rowId;\n      this.selection.bottom = this.selection.rowId;\n      this.onChange();\n      return;\n    }\n\n    if (this.selection.rowId > this.selection.bottom) {\n      this.selection.rowId = this.selection.top;\n      if (this.selection.columnId == this.selection.right) {\n        this.selection.columnId = this.selection.left;\n      } else {\n        this.selectNextColumnCell();\n      }\n    }\n\n    if (this.invalidSelection) { this.selectNextRowCell(); }\n    this.onChange();\n  }\n\n  public selectPreviousRowCell() {\n    if (this.selection.rowId == 0) { return; }\n    this.selection.rowId--;\n    if (this.selection.single) {\n      this.selection.top = this.selection.rowId;\n      this.selection.bottom = this.selection.rowId;\n      this.onChange();\n      return;\n    }\n\n    if (this.selection.rowId < this.selection.top) {\n      this.selection.rowId = this.selection.bottom;\n      if (this.selection.columnId == this.selection.left) {\n        this.selection.columnId = this.selection.right;\n      } else {\n        this.selectPreviousColumnCell();\n      }\n    }\n\n    if (this.invalidSelection) { this.selectPreviousRowCell(); }\n    this.onChange();\n  }\n\n  public getEvaluatedValue(exp: any): any[] {\n    if (('' + exp).indexOf(':') != -1) {\n      const parts = exp.split(':');\n      const a = this.getCellPos(parts[0]);\n      const b = this.getCellPos(parts[1]);\n      const res = [];\n      for (let c = a.columnId; c <= b.columnId; c++) {\n        for (let r = a.rowId; r <= b.rowId; r++) {\n          res.push(this.getCellEvaluatedValue(c, r));\n        }\n      }\n      return res;\n    }\n\n    const {rowId, columnId} = this.getCellPos(exp);\n    return this.getCellEvaluatedValue(columnId, rowId);\n  }\n\n  public removeCell(columnId: number, rowId: number) {\n    if (this.data[columnId] && this.data[columnId][rowId]) {\n      this.data[columnId][rowId] = undefined;\n    }\n  }\n\n  public setCellValue(columnId: number, rowId: number, value: any, silent = false): any {\n    if (value == null) {\n      this.removeCell(columnId, rowId);\n      return;\n    }\n    const cell = this.forceGetCell(columnId, rowId);\n    if (value.startsWith('=')) {\n      const evaluatedValue = Evaluator.Eval(this, value);\n      cell.update(value, evaluatedValue);\n    } else {\n      cell.value = value;\n    }\n    if (!silent) {\n      this.updateDependees(columnId, rowId);\n      this.onChange();\n    }\n  }\n\n  public getColumnLeft(columnId: number) {\n    let result = 0;\n    for (let i = this.scrollColumn; i < columnId; i++) {\n      result += this.getColumnWidth(i);\n    }\n    return result;\n  }\n\n  public getColumnRight(columnId: number) {\n    return this.getColumnLeft(columnId) + this.getColumnWidth(columnId);\n  }\n\n  public getRowTop(rowId: number) {\n    let result = 0;\n    for (let i = this.scrollRow; i < rowId; i++) {\n      result += this.getRowHeight(i);\n    }\n    return result;\n  }\n\n  public getRowBottom(rowId: number) {\n    return this.getRowTop(rowId) + this.getRowHeight(rowId);\n  }\n\n  public findColumnIdByX(x: number) {\n    if (x < 0) { return 0; }\n    let colX = 0;\n    for (let colId = this.scrollColumn; ; colId++) {\n      if (colId > this.scrollColumn + 100) { return 0; }\n      const colW = this.getColumnWidth(colId);\n      if (x > colX && x < colX + colW) {\n        return colId;\n      }\n      colX += colW;\n    }\n  }\n\n  public findRowIdByY(y: number) {\n    let rowY = this.getRowHeight(this.scrollRow);\n    let rowId = this.scrollRow;\n    while (rowY < y) {\n      rowId++;\n      rowY += this.getRowHeight(rowId);\n    }\n    return rowId;\n  }\n\n\n  public findCellByXY(x: number, y: number) {\n    const colId = this.findColumnIdByX(x);\n    const rowId = this.findRowIdByY(y);\n    return this.getCell(colId, rowId);\n  }\n\n\n  public selectByXY(x1: number, y1: number, x2: number, y2: number): any {\n    const top = Math.min(y1, y2);\n    const left = Math.min(x1, x2);\n    const right = Math.max(x1, x2);\n    const bottom = Math.max(y1, y2);\n\n    const stop = this.findRowIdByY(top);\n    const sbottom = this.findRowIdByY(bottom);\n    const sleft = this.findColumnIdByX(left);\n    const sright = this.findColumnIdByX(right);\n    let rowId = this.findRowIdByY(y1);\n    let columnId = this.findColumnIdByX(x1);\n    const selectedCell = this.getCell(columnId, rowId);\n    if (selectedCell && selectedCell.reference && selectedCell.isMerged) {\n      rowId = selectedCell.reference.rowId;\n      columnId = selectedCell.reference.columnId;\n    }\n\n    let ftop = stop;\n    let fbottom = sbottom + 1;\n    let fleft = sleft;\n    let fright = sright + 1;\n\n    for (let x = sleft; x <= sright; x++) {\n      for (let y = stop; y <= sbottom; y++) {\n        const cell = this.getCell(x, y);\n        if (cell) {\n          ftop = Math.min(ftop, cell.top);\n          fleft = Math.min(fleft, cell.left);\n          fbottom = Math.max(fbottom, cell.bottom);\n          fright = Math.max(fright, cell.right);\n        }\n      }\n    }\n\n    this.selection.top = ftop;\n    this.selection.left = fleft;\n    this.selection.right = fright - 1;\n    this.selection.bottom = fbottom - 1;\n    this.selection.rowId = rowId;\n    this.selection.columnId = columnId;\n    this.onChange();\n  }\n\n  public scrollDown(): any {\n    this.scroll(this.scrollColumn, this.scrollRow + 1);\n  }\n\n  public scrollUp(): any {\n    this.scroll(this.scrollColumn, this.scrollRow - 1);\n  }\n\n  public scrollLeft(): any {\n    this.scroll(this.scrollColumn + 1, this.scrollRow);\n  }\n\n  public scrollRight(): any {\n    this.scroll(this.scrollColumn - 1, this.scrollRow);\n  }\n\n  public getCellHeight(cell: Cell): number {\n    let height = 0;\n    for (let i = cell.rowId; i < cell.rowId + cell.rowSpan; i++) {\n      height += this.getRowHeight(i);\n    }\n    return height;\n  }\n\n  public getCellWidth(cell: Cell): number {\n    let width = 0;\n    for (let i = cell.columnId; i < cell.columnId + cell.colSpan; i++) {\n      width += this.getColumnWidth(i);\n    }\n    return width;\n  }\n\n  public scroll(columnId: number, rowId: number) {\n    if (columnId < 0) { return; }\n    if (rowId < 0) { return; }\n    for (const x in this.data) {\n      for (const y in this.data[x]) {\n        const cell: Cell = this.data[x][y];\n        if (cell.columnId < parseInt(x)) {\n          columnId = cell.columnId + cell.colSpan;\n        }\n        if (cell.rowId < parseInt(y)) {\n          rowId = cell.rowId + cell.rowSpan;\n        }\n      }\n    }\n\n    this.scrollX = columnId;\n    this.scrollY = rowId;\n\n    this.onChange();\n  }\n\n  public merge(columnId: number, rowId: number, width: number, height: number) {\n    const cell = this.forceGetCell(columnId, rowId);\n    cell.colSpan = width;\n    cell.rowSpan = height;\n    this.setCell(columnId, rowId, cell);\n\n    for (let x = columnId; x < columnId + width; x++) {\n      for (let y = rowId; y < rowId + height; y++) {\n        if (y != rowId || x != columnId) {\n          const xcell = this.forceGetCell(x, y);\n          xcell.reference = cell;\n          this.setCell(x, y, xcell);\n        }\n      }\n    }\n\n    this.onChange();\n  }\n\n  public unmerge(columnId: number, rowId: number) {\n    const cell = this.getCell(columnId, rowId);\n    if (!cell || (cell.rowSpan == 1 && cell.colSpan == 1)) { return; }\n\n    for (let i = 0; i < cell.colSpan; i++) {\n      for (let j = 0; j < cell.rowSpan; j++) {\n        const cx = this.getCell(i + columnId, j + rowId);\n        if (!cx) { continue; }\n        cx.reference = null;\n        this.setCell(i + columnId, j + rowId, cx, true);\n      }\n    }\n\n    cell.rowSpan = 1;\n    cell.colSpan = 1;\n    this.setCell(columnId, rowId, cell, true);\n    this.onChange();\n\n  }\n\n  public forceGetCell(columnId: number, rowId: number) {\n    let cell = this.getCell(columnId, rowId);\n    if (!cell) {\n      cell = new Cell(columnId, rowId);\n      this.setCell(columnId, rowId, cell);\n    }\n\n    return cell;\n  }\n\n  public getCell(columnId: number, rowId: number): Cell | null {\n    if (!this.data[columnId] || !this.data[columnId][rowId]) {\n      return null;\n    }\n\n    return this.data[columnId][rowId];\n  }\n\n  public setCell(columnId: number, rowId: number, cell: Cell, silent = false) {\n    if (!this.data[columnId]) {\n      this.data[columnId] = [];\n    }\n\n    this.data[columnId][rowId] = cell;\n    if (!silent) { this.onChange(); }\n  }\n\n\n  public getColumnAppearance(columnId: number): Appearance {\n    return this.columnAppearance[columnId];\n  }\n\n  public getRowAppearance(rowId: number): Appearance {\n    return this.rowAppearance[rowId];\n  }\n\n  public getCellAppearance(columnId: number, rowId: number): Appearance | null {\n    if (!this.appearance[columnId] || !this.appearance[columnId][rowId]) {\n      return null;\n    }\n\n    return this.appearance[columnId][rowId];\n  }\n\n  public setCellAppearance(columnId: number, rowId: number, appearance: Appearance, silent = false) {\n    if (!this.appearance[columnId]) {\n      this.appearance[columnId] = [];\n    }\n\n    this.appearance[columnId][rowId] = appearance;\n    if (!silent) { this.onChange(); }\n  }\n\n  public setColumAppearance(columnId: number, Appearance: Appearance) {\n    this.columnAppearance[columnId] = Appearance;\n    this.onChange();\n  }\n\n  public setRowAppearance(rowId: number, Appearance: Appearance) {\n    this.rowAppearance[rowId] = Appearance;\n    this.onChange();\n  }\n\n  public getRowHeight(rowId: number): number {\n    return this.rowHeight[rowId] || this.defaultRowHeight;\n  }\n\n  public setRowHeight(row: number, height: number) {\n    this.rowHeight[row] = height;\n    this.onChange();\n  }\n\n  public getColumnWidth(columnId: number): number {\n    return this.columnWidth[columnId] || this.defaultColumnWidth;\n  }\n\n  public setColumnWidth(column: number, width: number): any {\n    this.columnWidth[column] = width;\n    this.onChange();\n  }\n\n  public getAppearance(columnId: number, rowId: number): Appearance {\n    const appearance = new Appearance();\n\n    const cell = this.getCellAppearance(columnId, rowId);\n    const col = this.getColumnAppearance(columnId);\n    const row = this.getRowAppearance(rowId);\n    const def = this.defaultAppearance;\n\n    appearance.background = (cell && cell.background) || (col && col.background) || (row && row.background) || def.background;\n    appearance.fontName = (cell && cell.fontName) || (col && col.fontName) || (row && row.fontName) || def.fontName;\n    appearance.fontSize = (cell && cell.fontSize) || (col && col.fontSize) || (row && row.fontSize) || def.fontSize;\n    appearance.horizontalBorder = (cell && cell.horizontalBorder) || (col && col.horizontalBorder) || (row && row.horizontalBorder) || def.horizontalBorder;\n    appearance.verticalBorder = (cell && cell.verticalBorder) || (col && col.verticalBorder) || (row && row.verticalBorder) || def.verticalBorder;\n    appearance.text = (cell && cell.text) || (col && col.text) || (row && row.text) || def.text;\n    appearance.textAlign = (cell && cell.textAlign) || (col && col.textAlign) || (row && row.textAlign) || def.textAlign;\n    appearance.textStyle = (cell && cell.textStyle) || (col && col.textStyle) || (row && row.textStyle) || def.textStyle;\n\n    return appearance;\n\n  }\n\n  public addOnChange(handler: () => void) {\n    this.change_listeners.push(handler);\n  }\n\n  public removeOnChange(handler: () => void) {\n    const ix = this.change_listeners.indexOf(handler);\n    if (ix >= 0) {\n      this.change_listeners.splice(ix, 1);\n    }\n  }\n\n  public getWidth(measure: (text: string) => number) {\n    return SheetTitleWidth;\n    // return Math.max(SheetTitleWidth, measure(this.title) + 10); TODO: use this\n  }\n\n  public save() {\n    return {\n      title: this.title,\n      data: this.data,\n      appearance: this.appearance,\n      columnAppearance: this.columnAppearance,\n      rowAppearance: this.rowAppearance,\n      rowHeight: this.rowHeight,\n      columnWidth: this.columnWidth,\n      scrollX: this.scrollX,\n      scrollY: this.scrollY,\n      selection: this.selection,\n    };\n  }\n\n  private getCellName(columnId: number, rowId: number) {\n    return `${Sheet.get_columnName(columnId)}${rowId + 1}`;\n  }\n\n  private getCellPos(name: string) {\n    const regex = /([a-zA-z]+)([0-9]+)/g;\n    if (!(/([a-zA-z]+)([0-9]+)/g).test(name)) {\n      throw new Error('invalid cell name ' + name);\n    }\n    const pos: any = regex.exec(name);\n    const columnId = this.getColumnIndex(pos[1]);\n    const rowId = parseInt(pos[2]) - 1;\n\n    return {rowId, columnId};\n  }\n\n  private getColumnIndex(name: string) {\n    let sum = 0;\n    let pwr = 1;\n    let st = 65;\n    for (let i = name.length - 1; i >= 0; i--) {\n      const ch = name.charCodeAt(i) - st;\n      sum += ch * pwr;\n      pwr *= 26;\n      st = 64;\n    }\n    return sum;\n  }\n\n  private getCellEvaluatedValue(columnId: number, rowId: number) {\n    const cell = this.getCell(columnId, rowId);\n    if (cell == null) {\n      return null;\n    }\n\n    return Evaluator.Eval(this, cell.value); // TODO: should be cached and check cycles\n\n  }\n\n  private updateDependees(columnId: number, rowId: number) {\n    // TODO:bad performance\n    for (const d of this.data) {\n      if (!d) { continue; }\n      for (const c of d) {\n        if (!c || !c.value) { continue; }\n        if (c.value.length && c.value[0] == '=') {\n          this.setCellValue(c.columnId, c.rowId, c.value, true);\n        }\n      }\n    }\n  }\n\n  private onChange() {\n    this.change_listeners.forEach((m) => m());\n  }\n\n  private fill(data: any) {\n    this.data = [];\n    for (const d of data) {\n      if (!d) { continue; }\n      for (const c of d) {\n        if (!c) { continue; }\n        const cell = Cell.from(c);\n        this.setCell(cell.columnId, cell.rowId, cell, true);\n      }\n    }\n  }\n\n  private style(app: any) {\n    this.appearance = [];\n    if (!app) { return; }\n    for (const d of app) {\n      if (!d) { continue; }\n      for (const c of d) {\n        if (!c) { continue; }\n        const a = Appearance.from(c);\n        const col = app.indexOf(d);\n        const row = d.indexOf(c);\n        this.setCellAppearance(col, row, a, true);\n      }\n    }\n  }\n}\n","export function clone(obj: any) {\n  return JSON.parse(JSON.stringify(obj));\n}\n\nexport function isComma(ch: string) {\n  return (ch === ',');\n}\n\nexport function isDigit(ch: string) {\n  return /\\d/.test(ch);\n}\n\nexport function isLetter(ch: string) {\n  return /[a-z]/i.test(ch);\n}\n\nexport function isOperator(ch: string) {\n  return /\\+|-|\\*|\\/|\\^/.test(ch);\n}\n\nexport function isLeftParenthesis(ch: string) {\n  return (ch === '(');\n}\n\nexport function isRightParenthesis(ch: string) {\n  return (ch == ')');\n}\n","import { OpenDocument } from './Document';\nimport { CommandHistory } from './CommandHistory';\nimport { Sheet } from './Sheet';\nimport { clone } from '../common/utils';\nimport { Color } from '../common/types';\nimport { Appearance, TextAlign } from './Appearance';\n\nexport class Commander {\n\n  private get ActiveSheet(): Sheet {\n    return this.doc.ActiveSheet;\n  }\n\n  private get Selection() {\n    return this.ActiveSheet.selection;\n  }\n\n  private get SelectedAppearance(): Appearance [] {\n    const sel = this.Selection;\n    const sheet = this.doc.ActiveSheet;\n    const apps = [];\n    for (let r = sel.top; r <= sel.bottom; r++) {\n      for (let c = sel.left; c <= sel.right; c++) {\n        const app = sheet.getCellAppearance(sel.columnId, sel.rowId);\n        if (app) {\n          apps.push(clone(app));\n        }\n      }\n    }\n    return apps;\n  }\n\n  private get SelectionData() {\n    const sel = this.Selection;\n    const sheet = this.doc.ActiveSheet;\n    const data = [];\n\n    for (let c = sel.left; c <= sel.right; c++) {\n      for (let r = sel.top; r <= sel.bottom; r++) {\n        const cell = sheet.getCell(c, r);\n        data.push(clone(cell));\n      }\n    }\n\n    return data;\n  }\n  private history: CommandHistory[] = [];\n  private commands: any = {};\n\n  public constructor(private doc: OpenDocument) {\n    this.commands.bold = () => this.appearance((app) => app.bold = !app.bold);\n    this.commands.italic = () => this.appearance((app) => app.italic = !app.italic);\n    this.commands.underline = () => this.appearance((app) => app.underline = !app.underline);\n    this.commands['font-size'] = (size: number) => this.appearance((app) => app.fontSize = size);\n    this.commands['font-name'] = (font: string) => this.appearance((app) => app.fontName = font);\n    this.commands['bg-color'] = (color: Color) => this.appearance((app) => app.background = color);\n    this.commands['fg-color'] = (color: Color) => this.appearance((app) => app.text = color);\n    this.commands['top-border'] = (color: Color) => this.topBorder(color);\n    this.commands['no-border'] = () => this.noBorder();\n    this.commands['left-border'] = (color: Color) => this.leftBorder(color);\n    this.commands['right-border'] = (color: Color) => this.rightBorder(color);\n    this.commands['bottom-border'] = (color: Color) => this.bottomBorder(color);\n    this.commands['outside-border'] = (color: Color) => this.outsideBorder(color);\n    this.commands['horizontal-border'] = (color: Color) => this.horizontalBorder(color);\n    this.commands['vertical-border'] = (color: Color) => this.verticalBorder(color);\n    this.commands['cross-border'] = (color: Color) => this.crossBorder(color);\n    this.commands['full-border'] = (color: Color) => {\n      this.topBorder(color, false);\n      this.leftBorder(color, false);\n      this.bottomBorder(color, false);\n      this.rightBorder(color, false);\n      this.appearance((app) => {\n        app.setVertical(color);\n        app.setHorizontal(color);\n      });\n    };\n    this.commands.merge = () => this.merge();\n    this.commands.unmerge = () => this.unmerge();\n    this.commands.align = (value: any) => this.appearance((app) => app.alignTextTo(value));\n    this.commands['change-value'] = (columnId: number, rowId: number, value: string) => this.changeValue(columnId, rowId, value);\n    this.commands['alter-column'] = (columnId: number, delta: number) => this.alterColumn(columnId, delta);\n    this.commands['alter-row'] = (rowId: number, delta: number) => this.alterRow(rowId, delta);\n  }\n\n  public do(commandName: string, ...args: any[]) {\n    if (!this.has(commandName)) {\n      console.warn(`command ${commandName} does not exsits!`);\n    }\n\n    this.commands[commandName](...args);\n  }\n\n  public undo() {\n    throw new Error('undo has not been implemented');\n  }\n\n  public redo() {\n    throw new Error('redo has not been implemented');\n  }\n\n  private has(commandName: string) {\n    return !!this.commands[commandName];\n  }\n\n  private outsideBorder(color: Color) {\n    this.logAppearanceOnlyCommand();\n    this.topBorder(color, false);\n    this.rightBorder(color, false);\n    this.bottomBorder(color, false);\n    this.leftBorder(color, false);\n  }\n\n  private horizontalBorder(color: Color) {\n    this.crossBorder(color, true, false);\n  }\n\n  private verticalBorder(color: Color) {\n    this.crossBorder(color, false, true);\n  }\n\n  private crossBorder(color: Color, horizontal = true, vertical = true) {\n    this.logAppearanceOnlyCommand();\n    const sel = this.Selection;\n    const sheet = this.doc.ActiveSheet;\n    for (let c = sel.left; c <= sel.right; c++) {\n      for (let r = sel.top; r <= sel.bottom; r++) {\n        const app = this.ActiveSheet.getCellAppearance(c, r) || new Appearance();\n        if (horizontal && r < sel.bottom) { app.setHorizontal(color); }\n        if (vertical && c < sel.right) { app.setVertical(color); }\n        this.ActiveSheet.setCellAppearance(c, r, app, false);\n      }\n    }\n  }\n\n  private noBorder() {\n    this.logAppearanceOnlyCommand();\n    this.topBorder(null, false);\n    this.leftBorder(null, false);\n    this.appearance((app) => {\n      app.setVertical(null);\n      app.setHorizontal(null);\n    });\n  }\n\n  private topBorder(color: Color, log = true) {\n    if (log) {\n      this.logAppearanceOnlyCommand();\n    }\n    const sel = this.Selection;\n    const sheet = this.doc.ActiveSheet;\n    const r = sel.top - 1;\n    for (let c = sel.left; c <= sel.right; c++) {\n      const app = this.ActiveSheet.getCellAppearance(c, r) || new Appearance();\n      app.setHorizontal(color);\n      this.ActiveSheet.setCellAppearance(c, r, app, false);\n    }\n  }\n\n  private leftBorder(color: Color, log = true) {\n    if (log) {\n      this.logAppearanceOnlyCommand();\n    }\n    const sel = this.Selection;\n    const sheet = this.doc.ActiveSheet;\n    const c = sel.left - 1;\n    for (let r = sel.top; r <= sel.bottom; r++) {\n      const app = this.ActiveSheet.getCellAppearance(c, r) || new Appearance();\n      app.setVertical(color);\n      this.ActiveSheet.setCellAppearance(c, r, app, false);\n    }\n  }\n\n  private rightBorder(color: Color, log = true) {\n    if (log) {\n      this.logAppearanceOnlyCommand();\n    }\n    const sel = this.Selection;\n    const sheet = this.doc.ActiveSheet;\n    const c = sel.right;\n    for (let r = sel.top; r <= sel.bottom; r++) {\n      const app = this.ActiveSheet.getCellAppearance(c, r) || new Appearance();\n      app.setVertical(color);\n      this.ActiveSheet.setCellAppearance(c, r, app, false);\n    }\n  }\n\n  private bottomBorder(color: Color, log = true) {\n    if (log) {\n      this.logAppearanceOnlyCommand();\n    }\n    const sel = this.Selection;\n    const sheet = this.doc.ActiveSheet;\n    for (let c = sel.left; c <= sel.right; c++) {\n      const app = sheet.getCellAppearance(c, sel.bottom) || new Appearance();\n      app.setHorizontal(color);\n      sheet.setCellAppearance(c, sel.bottom, app, false);\n    }\n  }\n\n  private logAppearanceOnlyCommand() {\n    const sel = this.Selection;\n    const historyItem: CommandHistory = {\n      selection: sel,\n      appearance: this.SelectedAppearance,\n    };\n\n    this.history.push(historyItem);\n  }\n\n  private logDataOnlyCommand() {\n    const sel = this.Selection;\n    const historyItem: CommandHistory = {\n      selection: sel,\n      data: this.SelectionData,\n    };\n\n    this.history.push(historyItem);\n  }\n\n  private alterColumn(column: number, delta: number) {\n    const w = this.doc.ActiveSheet.getColumnWidth(column);\n    this.history.push({\n      selection: column,\n      data: w,\n      meta: 'COLUMN',\n    });\n\n    this.doc.ActiveSheet.setColumnWidth(column, w + delta);\n  }\n\n  private alterRow(row: number, delta: number) {\n    const h = this.doc.ActiveSheet.getRowHeight(row);\n    this.history.push({\n      selection: row,\n      data: h,\n      meta: 'ROW',\n    });\n\n    this.doc.ActiveSheet.setRowHeight(row, h + delta);\n  }\n\n  private changeValue(columnId: number, rowId: number, value: string) {\n    this.logDataOnlyCommand();\n    if (columnId == null) { columnId = this.Selection.columnId; }\n    if (rowId == null) { rowId = this.Selection.rowId; }\n    this.ActiveSheet.setCellValue(columnId, rowId, value);\n  }\n\n  private merge() {\n    this.logDataOnlyCommand();\n    const sel = this.Selection;\n    const c = Math.min(sel.right, sel.left);\n    const r = Math.min(sel.top, sel.bottom);\n    const w = Math.abs(sel.right - sel.left) + 1;\n    const h = Math.abs(sel.top - sel.bottom) + 1;\n    this.ActiveSheet.merge(c, r, w, h);\n  }\n\n  private unmerge() {\n    this.logDataOnlyCommand();\n    const sel = this.Selection;\n    this.ActiveSheet.unmerge(sel.columnId, sel.rowId);\n  }\n\n  private appearance(method: (app: Appearance) => void): void {\n    this.logAppearanceOnlyCommand();\n    const sel = this.Selection;\n    for (let r = sel.top; r <= sel.bottom; r++) {\n      for (let c = sel.left; c <= sel.right; c++) {\n        const app = this.ActiveSheet.getCellAppearance(c, r) || new Appearance();\n        method(app);\n        this.ActiveSheet.setCellAppearance(c, r, app);\n      }\n    }\n  }\n\n}\n","import { Sheet } from './Sheet';\nimport { Commander } from './Commander';\n\nexport class OpenDocument {\n\n  public get ActiveSheet() {\n    return this.sheets[this.activeSheetIndex];\n  }\n\n  public get ActiveSheetIndex() {\n    return this.activeSheetIndex;\n  }\n\n  public set ActiveSheetIndex(index: number) {\n    if (index < 0 || index >= this.sheets.length) {\n      throw new Error('invalid sheet index');\n    }\n\n    this.activeSheetIndex = index;\n    this.onChange();\n  }\n\n  public get Sheets(): Sheet[] {\n    return this.sheets;\n  }\n\n  private sheets: Sheet[] = [];\n  private activeSheetIndex = 0;\n  private commander: Commander;\n  private change_listeners: Array<() => void> = [];\n\n  public constructor() {\n    this.init();\n    this.commander = new Commander(this);\n  }\n\n  public addSheet(name: string) {\n    const sheet = new Sheet(name);\n    sheet.addOnChange(() => this.onChange());\n    this.sheets.push(sheet);\n    this.onChange();\n  }\n\n  public addOnChange(handler: () => void) {\n    this.change_listeners.push(handler);\n  }\n\n  public removeOnChange(handler: () => void) {\n    const ix = this.change_listeners.indexOf(handler);\n    if (ix >= 0) {\n      this.change_listeners.splice(ix, 1);\n    }\n  }\n\n  public onChange() {\n    this.change_listeners.forEach((m) => m());\n  }\n\n  public execCommand(cmd: string, ...args: any[]) {\n    this.commander.do(cmd, ...args);\n  }\n\n  public save() {\n    return {\n      sheets: this.sheets.map((sh) => sh.save()),\n      activeSheetIndex: this.activeSheetIndex,\n    };\n  }\n\n  public load(obj: any) {\n    this.sheets = obj.sheets.map((sh: any) => Sheet.load(sh));\n    this.activeSheetIndex = obj.activeSheetIndex;\n    this.onChange();\n  }\n\n  private init() {\n    this.addSheet('Sheet1');\n    this.addSheet('Sheet2');\n    this.addSheet('Sheet3');\n  }\n}\n","export enum LayoutDirection {\n  LeftToRight = 1,\n  RightToLeft = 2,\n}\n","export class ContextMask {\n\n  private x: number = 0;\n  private y: number = 0;\n  private width: number = 0;\n  private height: number = 0;\n\n  constructor(left: number, top: number, width: number, height: number) {\n    this.x = left;\n    this.y = top;\n    this.width = width;\n    this.height = height;\n  }\n\n\n  public get_left() {\n    return this.x;\n  }\n\n  public set_left(value: number) {\n    this.x = value;\n  }\n\n  public get_top() {\n    return this.y;\n  }\n\n  public get_right() {\n    return this.x + this.width;\n  }\n\n  public get_bottom() {\n    return this.y + this.height;\n  }\n\n  public set_top(value: number) {\n    this.y = value;\n  }\n\n  public get_width() {\n    return this.width;\n  }\n\n  public set_width(value: number) {\n    this.width = value;\n  }\n\n  public get_height() {\n    return this.height;\n  }\n\n  public set_height(value: number) {\n    this.height = value;\n  }\n\n  public set_value(x: number, y: number, w: number, h: number) {\n    this.x = x;\n    this.y = y;\n    this.width = w;\n    this.height = h;\n  }\n\n  public get_combinedMask(x: number, y: number, w: number, h: number) {\n    const x2 = Math.min(x + w, this.get_right());\n    const y2 = Math.min(y + h, this.get_bottom());\n\n    w = Math.min(x2 - x, this.get_width());\n    h = Math.min(y2 - y, this.get_height());\n\n    x = Math.max(x, this.get_left());\n    y = Math.max(y, this.get_top());\n\n    return new ContextMask(x, y, w, h);\n  }\n\n}\n","import { TextAlign } from '../../core/Appearance';\nimport { LayoutDirection } from '@/lib/rendering/canvas/LayoutDirection';\nimport { Point } from '@/lib/rendering/canvas/Point';\nimport { ContextMask } from '@/lib/rendering/canvas/ContextMask';\n\n/**\n * Created by SiamandM on 6/16/2016.\n */\nexport class Context {\n\n  public direction: LayoutDirection = LayoutDirection.LeftToRight;\n  public textAlign: TextAlign = TextAlign.Left;\n  public fillStyle: any = '#fff';\n  public strokeStyle = '#000';\n  public strokeSize = 1;\n  public contentFillStyle = '#000';\n  public fontStyle = '';\n  public fontSize = 12;\n  public fontName = 'Tahoma';\n\n  private context2d: CanvasRenderingContext2D;\n  private width: number;\n  private height: number;\n  private currentMask!: ContextMask | null;\n  private maskStack: ContextMask[] = [];\n\n  constructor(context: CanvasRenderingContext2D, width: number, height: number) {\n    this.context2d = context;\n    this.width = width;\n    this.height = height;\n  }\n\n  public get_directed_x(x: number, width: number = 0) {\n    if (this.direction === LayoutDirection.LeftToRight) {\n      return x;\n    }\n    return this.width - x - width;\n  }\n\n  public get_textWidth(text: string) {\n    return this.context2d.measureText(text).width;\n  }\n\n  public save() {\n    this.context2d.save();\n    this.context2d.translate(-0.5, -0.5);\n    if (this.currentMask) {\n      const cmask = this.currentMask;\n\n      this.context2d.rect(cmask.get_left(), cmask.get_top(), cmask.get_width(), cmask.get_height());\n      this.context2d.clip();\n    }\n\n  }\n\n  public restore() {\n    this.context2d.restore();\n  }\n\n  public setMask(x: number, y: number, w: number, h: number, affectPreviousMask: boolean = false) {\n    x = this.get_directed_x(x, w);\n\n    if (this.currentMask) {\n      this.maskStack.push(this.currentMask);\n    }\n    if (affectPreviousMask && this.currentMask) {\n      this.currentMask = this.currentMask.get_combinedMask(x, y, w, h);\n    } else {\n      this.currentMask = new ContextMask(x, y, w, h);\n    }\n  }\n\n  public unmask() {\n    if (this.maskStack.length > 0) {\n      this.currentMask = (this.maskStack.pop() as ContextMask);\n    } else {\n      this.currentMask = null;\n    }\n  }\n\n  public clearRect(x: number, y: number, w: number, h: number) {\n    x = this.get_directed_x(x, w);\n    this.save();\n    this.context2d.clearRect(x, y, w, h);\n    this.restore();\n  }\n\n  public fillRect(x: number, y: number, w: number, h: number) {\n    x = this.get_directed_x(x, w);\n    this.save();\n    this.applyFill();\n    this.context2d.beginPath();\n    this.context2d.fillRect(x, y, w, h);\n    this.context2d.fill();\n    this.restore();\n  }\n\n  public strokeRect(x: number, y: number, w: number, h: number) {\n    x = this.get_directed_x(x, w);\n    this.save();\n    this.applyStroke();\n    this.context2d.beginPath();\n    this.context2d.strokeRect(x, y, w, h);\n    this.context2d.stroke();\n    this.restore();\n  }\n\n  public line(x1: number, y1: number, x2: number, y2: number) {\n    x1 = this.get_directed_x(x1);\n    x2 = this.get_directed_x(x2);\n\n    this.save();\n    this.applyStroke();\n    this.context2d.beginPath();\n    this.context2d.moveTo(x1, y1);\n    this.context2d.lineTo(x2, y2);\n    this.context2d.stroke();\n    this.restore();\n  }\n\n  public path(close: boolean, stroke: boolean, fill: boolean, ...points: Point[]) {\n    this.save();\n    this.applyStroke();\n    this.applyFill();\n    this.context2d.beginPath();\n    let point = points[0];\n    const drpx = this.get_directed_x(point.x);\n    this.context2d.moveTo(drpx, point.y);\n    for (let i = 1; i < points.length; i++) {\n      point = points[i];\n      const drx = this.get_directed_x(point.x);\n      this.context2d.lineTo(drx, point.y);\n    }\n    if (close) {\n      this.context2d.closePath();\n    }\n    if (fill) {\n      this.context2d.fill();\n    }\n    if (stroke) {\n      this.context2d.stroke();\n    }\n\n    this.restore();\n  }\n\n  public openPath(...points: Point[]) {\n    this.internalPath(false, true, false, points);\n  }\n\n  public closePath(...points: Point[]) {\n    this.internalPath(true, true, false, points);\n  }\n\n  public fillOpenPath(...points: Point[]) {\n    this.internalPath(false, true, true, points);\n  }\n\n  public fillClosePath(...points: Point[]) {\n    this.internalPath(true, false, true, points);\n  }\n\n  public rect(x: number, y: number, w: number, h: number) {\n    x = this.get_directed_x(x, w);\n    this.fillRect(x, y, w, h);\n    this.strokeRect(x, y, w, h);\n  }\n\n  public fillText(text: string, x: number, y: number, width: number) {\n    x = this.get_directed_x(x, width);\n    this.save();\n    this.applyContent();\n    let delta = 0;\n    const textWidth = this.get_textWidth(text);\n    if (this.textAlign === TextAlign.Center) {\n      delta = (width - textWidth) / 2;\n    } else if (this.textAlign === TextAlign.Right) {\n      delta = width - textWidth - 10; // TODO: fix that constant value [indent]\n    }\n    if (this.fontStyle && this.fontStyle.indexOf('underline') !== -1) {\n      this.rect(x, y + this.fontSize + 2, this.context2d.measureText(text).width, 0);\n    }\n\n    this.context2d.fillText(text, x + delta, y + this.fontSize);\n    this.restore();\n  }\n\n  public createGradient(x: number, y: number, w: number, h: number, ...stops: any[]) {\n    const grd = this.context2d.createLinearGradient(x, y, x + w, y + h);\n    for (const n of stops) {\n      grd.addColorStop(n[0], n[1]);\n    }\n    return grd;\n  }\n\n\n  private applyFill() {\n    this.context2d.fillStyle = this.fillStyle;\n  }\n\n  private applyStroke() {\n    this.context2d.strokeStyle = this.strokeStyle;\n    this.context2d.lineWidth = this.strokeSize;\n  }\n\n  private applyContent() {\n    const style = this.fontStyle.replace('underline', '');\n    this.context2d.fillStyle = this.contentFillStyle;\n    this.context2d.font = (`${this.fontStyle} ${this.fontSize}px ${this.fontName}`).trim();\n    this.context2d.textAlign = 'left';\n  }\n\n  private internalPath(close: boolean, stroke: boolean, fill: boolean, points: Point[]) {\n    const args: any = [close, stroke, fill];\n    for (const point of points) {\n      args.push(point);\n    }\n    this.path.apply(this, args);\n  }\n}\n","export class Point {\n\n  public x: number;\n  public y: number;\n\n  constructor(x: number = 0, y: number = 0) {\n    this.x = x;\n    this.y = y;\n  }\n}\n","import {\n  RowDefaultHeight,\n  ColumnHeaderHeight,\n  RowHeaderWidth,\n  SheetTitleHeight,\n  COLOR_3,\n  COLOR_1,\n  COLOR_LIGHT,\n  COLOR_CREAM,\n} from '../../common/constants';\nimport { DocumentRenderer } from '../DocumentRenderer';\nimport { OpenDocument } from '../../core/Document';\nimport { Context} from './Context';\nimport { TextAlign } from '../../core/Appearance';\nimport { Sheet } from '../../core/Sheet';\nimport { Point } from '@/lib/rendering/canvas/Point';\n\n\nexport class CanvasRenderer implements DocumentRenderer {\n\n  public get Element(): HTMLElement {\n    return this.container;\n  }\n\n  public width!: number;\n  public height!: number;\n  private canvas!: HTMLCanvasElement;\n  private rendering: boolean = false;\n  private renderFrameRate: number = 10; // FPS\n  private context!: Context;\n\n\n  public constructor(private container: HTMLElement, private document: OpenDocument) {\n    this.initialize();\n    document.addOnChange(() => this.render());\n  }\n\n  public initialize() {\n    this.createElements();\n    this.resize();\n    this.render();\n  }\n\n  public createElements() {\n    this.canvas = document.createElement('canvas');\n    this.container.appendChild(this.canvas);\n  }\n\n  public resize() {\n    const pixelRatio = window.devicePixelRatio;\n    this.width = this.container.clientWidth;\n    this.height = this.container.clientHeight;\n    if (pixelRatio > 1) {\n      this.canvas.width = this.width * pixelRatio;\n      this.canvas.height = this.height * pixelRatio;\n      this.canvas.style.width = this.width + 'px';\n      this.canvas.style.height = this.height + 'px';\n    } else {\n      this.canvas.width = this.width;\n      this.canvas.height = this.height;\n    }\n    this.render();\n  }\n\n  public get_context2D() {\n    const pixelRatio = window.devicePixelRatio;\n    this.canvas.width = this.canvas.width;\n    const context = this.canvas.getContext('2d') as CanvasRenderingContext2D;\n    context.scale(pixelRatio, pixelRatio);\n    return context;\n  }\n\n  public render() {\n    if (this.rendering) {\n      return;\n    }\n\n    this.rendering = true;\n    setTimeout(() => {\n      this.doRender();\n      this.rendering = false;\n    }, 1000 / this.renderFrameRate);\n\n  }\n\n  public doRender() {\n    console.log('%cRender', `color:${COLOR_1}`);\n    const context2d = this.get_context2D();\n    this.context = new Context(context2d, this.width, this.height);\n    this.renderSheetTitles();\n    this.renderSheet();\n  }\n\n  private renderTopCorner() {\n    this.context.fillStyle = '#ececec';\n    this.context.fontSize = 12;\n    const cornerWidth = RowHeaderWidth - 2;\n    this.context.fillClosePath(new Point(2, cornerWidth), new Point(cornerWidth, cornerWidth), new Point(cornerWidth, 1));\n\n  }\n\n  private renderSheetTitles() {\n    this.renderTopCorner();\n\n    this.context.strokeSize = 1;\n    const x1 = 0;\n    const y1 = this.height - SheetTitleHeight - .5;\n    const rHeight = SheetTitleHeight + 5;\n    const h = this.height - SheetTitleHeight - 0.5;\n    this.context.rect(x1, y1, this.width, rHeight);\n    this.context.fillStyle = this.context.createGradient(0, h, 0, SheetTitleHeight / 3, [0, '#f0f0f0'], [1, '#fff']);\n    this.context.fillRect(x1, y1, this.width, rHeight);\n    this.context.textAlign = TextAlign.Center;\n\n    let x = RowHeaderWidth;\n    const active = this.document.ActiveSheet;\n    const delta = 5;\n    for (const sh of this.document.Sheets) {\n      const sheetWidth = sh.getWidth((str) => this.context.get_textWidth(str));\n      this.context.strokeStyle = '#aaa';\n      this.context.fillStyle = '#fafafa';\n      this.context.fontStyle = 'italic';\n      if (sh === active) {\n        this.context.fillStyle = '#fff';\n        this.context.fontStyle = 'bold';\n      }\n      this.context.rect(x, h, sheetWidth, SheetTitleHeight - delta);\n      this.context.fillText(sh.title, x, h + delta, sheetWidth);\n      if (sh === active) {\n        this.context.fillStyle = COLOR_3;\n        this.context.fillRect(x, h + SheetTitleHeight - delta, sheetWidth, 2);\n        this.context.strokeStyle = COLOR_LIGHT;\n      }\n      this.context.line(x, h, x + sheetWidth, h);\n\n      x += sheetWidth + delta;\n    }\n    this.context.fontStyle = '';\n  }\n\n  private renderSheet() {\n    const width = this.width;\n    const height = this.height;\n\n    const sheetTitleHeight = SheetTitleHeight;\n    const maskHeight = height - sheetTitleHeight;\n    const context = this.context;\n\n    context.setMask(0, 0, width, height - (sheetTitleHeight + 1.5));\n    const lastRow = this.renderRows();\n    const lastColumn = this.renderColumns();\n    context.unmask();\n\n    context.setMask(ColumnHeaderHeight + .5, RowHeaderWidth, width, maskHeight - RowHeaderWidth - .5);\n    this.renderCells(lastColumn, lastRow);\n    context.unmask();\n  }\n\n  private renderRows() {\n    const context = this.context;\n    const height = this.height - RowHeaderWidth - SheetTitleHeight;\n    let cumulativeHeight = RowDefaultHeight;\n    const sheet = this.document.ActiveSheet;\n\n    let rw = sheet.scrollRow;\n    for (; cumulativeHeight < height; rw++) {\n      const rowHeight = sheet.getRowHeight(rw);\n      this.paintRow(cumulativeHeight, (rw + 1).toString());\n      cumulativeHeight += rowHeight;\n    }\n\n    return rw;\n  }\n\n  private paintRow(top: number, label: string): any {\n    const context = this.context;\n    context.save();\n    context.strokeSize = 1;\n    context.strokeStyle = '#ccc';\n    context.fillStyle = '#fafafa';\n    context.rect(0, top, RowHeaderWidth, this.height);\n    context.fillRect(0, top, RowHeaderWidth, this.height);\n    context.fontSize = 12;\n    context.textAlign = TextAlign.Center;\n    context.fillText(label, 0, top + (RowDefaultHeight - 12) / 2, RowHeaderWidth);\n    context.restore();\n  }\n\n  private renderColumns() {\n    const width = this.width;\n    const sheet = this.document.ActiveSheet;\n    let cumulativeWidth = RowHeaderWidth + .5;\n    let cl = sheet.scrollColumn;\n\n    for (; cumulativeWidth <= width; cl++) {\n      const columnWidth = sheet.getColumnWidth(cl);\n      this.paintColumn(cumulativeWidth, Sheet.get_columnName(cl), columnWidth);\n      cumulativeWidth += columnWidth;\n    }\n    return cl;\n  }\n\n  private paintColumn(left: number, label: string, columnWidth: number) {\n    const context = this.context;\n    context.strokeSize = 1;\n    context.strokeStyle = '#ccc';\n    context.fillStyle = '#fafafa';\n    context.fontName = 'Tahoma';\n    context.fontSize = 12;\n    context.rect(left, 0, this.width, ColumnHeaderHeight - 1);\n    context.fillRect(left, 0, this.width, ColumnHeaderHeight - 1);\n    context.fillText(label, left, 7, columnWidth);\n  }\n\n  private renderCells(lastColumn: number, lastRow: number) {\n    let x: number = 0;\n    let y: number = 0;\n\n    const sheet = this.document.ActiveSheet;\n    const cellsToPaint = [];\n    const context = this.context;\n    context.strokeStyle = '#eee';\n    context.strokeSize = 1;\n    for (let r = sheet.scrollRow - 1; r < lastRow; r++) {\n      const rowHeight = sheet.getRowHeight(r);\n      x = 0;\n      for (let c = sheet.scrollColumn; c <= lastColumn; c++) {\n        const columnWidth = sheet.getColumnWidth(c);\n        const cell = sheet.getCell(c, r);\n        const cellHeight = cell ? sheet.getCellHeight(cell) : sheet.getRowHeight(r);\n        const cellWidth = cell ? sheet.getCellWidth(cell) : sheet.getColumnWidth(c);\n        const appearance = sheet.getAppearance(c, r);\n        context.fillStyle = appearance.text;\n        this.paintCell(c, r, x, y);\n\n        if (y > 0 && (!cell || !cell.isMerged)) {\n          const horStyle = appearance.horizontalBorder;\n          const verStyle = appearance.verticalBorder;\n\n          context.strokeStyle = (horStyle && horStyle.color) || '#eeeeee';\n          if (appearance.background == null || horStyle != null) {\n            context.line(x + RowHeaderWidth, y + cellHeight, x + RowHeaderWidth + cellWidth, y + cellHeight);\n          }\n          context.strokeStyle = (verStyle && verStyle.color) || '#eeeeee';\n          if (appearance.background == null || verStyle != null) {\n            context.line(x + RowHeaderWidth + cellWidth, y, x + RowHeaderWidth + cellWidth, y + cellHeight);\n          }\n        }\n        x += columnWidth;\n      }\n      y += rowHeight;\n    }\n  }\n\n  private paintCell(columnId: number, rowId: number, x: number, y: number) {\n    const context = this.context;\n    const sheet = this.document.ActiveSheet;\n    const cell = sheet.getCell(columnId, rowId);\n    if (cell && cell.isMerged) { return; }\n\n    const appearance = sheet.getAppearance(columnId, rowId);\n    const left = x + ColumnHeaderHeight;\n    if (y < RowDefaultHeight) { return; }\n\n    if (appearance.fontSize) { context.fontSize = parseInt(appearance.fontSize + ''); }\n    if (appearance.fontName) { context.fontName = appearance.fontName; }\n    context.fontStyle = (appearance.textStyle) ? appearance.textStyle : '';\n\n    const cellWidth = cell ? sheet.getCellWidth(cell) : sheet.getColumnWidth(columnId);\n    const cellHeight = cell ? sheet.getCellHeight(cell) : sheet.getRowHeight(rowId);\n\n    context.setMask(left, y, cellWidth, cellHeight);\n    if (appearance.background) {\n      context.fillStyle = appearance.background;\n      context.fillRect(left, y, cellWidth, cellHeight);\n    }\n    if (cell && cell.label) {\n      context.contentFillStyle = appearance.text;\n      context.strokeStyle = appearance.text;\n      context.textAlign = appearance.textAlign;\n      context.fillText(cell.label, x + ColumnHeaderHeight + 5, y + 7, cellWidth);\n    }\n    context.unmask();\n  }\n\n}\n","import { OpenDocument } from '../core/Document';\nimport { UIHandlerController } from './UIHandlerControler';\nimport { ColumnHeaderHeight, RowHeaderWidth, SheetTitleHeight, COLOR_1, COLOR_2 } from '../common/constants';\nimport { Cell } from '../core/Cell';\nimport { Sheet } from '../core/Sheet';\nimport { TextAlign } from '../core/Appearance';\nimport { CellValue } from '@/lib/common/types';\n\n/**\n * Created by SiamandM on 6/23/2016.\n */\n/// <reference path=\"UIHandler.ts\"/>\n\nexport class CellEditor {\n\n  public get Value() {\n    if (this.editorElement.value == '') {\n      return null;\n    }\n\n    return this.editorElement.value;\n  }\n\n  public set Value(newValue: CellValue) {\n    if (this.editorElement) {\n      this.editorElement.value = newValue ? newValue + '' : '';\n    }\n  }\n\n  public get IsDirty() {\n    const cell = this.getCurrentCell();\n    return (cell.value != this.Value);\n  }\n\n  public get EditMode() {\n    return this.editMode;\n  }\n\n  public set EditMode(mode: boolean) {\n    this.editMode = mode;\n    if (mode) {\n      this.editorElement.readOnly = false;\n    } else {\n      this.editorElement.readOnly = true;\n    }\n    this.editorElement.focus();\n  }\n\n  private websheet: OpenDocument;\n  private editorArea!: HTMLDivElement;\n  private selectionElement!: HTMLElement;\n  private editorElement!: HTMLInputElement;\n  private anchorElement!: HTMLSpanElement;\n  private editMode = false;\n\n  constructor(public controler: UIHandlerController) {\n    this.websheet = controler.websheet;\n    this.initialize();\n    this.select();\n  }\n\n  public initialize() {\n    this.editorArea = document.createElement('div');\n    this.editorArea.style.position = 'absolute';\n    this.editorArea.style.top = ColumnHeaderHeight + 'px';\n    this.editorArea.style.left = RowHeaderWidth + 'px';\n    this.editorArea.style.bottom = SheetTitleHeight + 'px';\n    this.editorArea.style.right = '0px';\n    this.editorArea.style.overflow = 'visible';\n    this.controler.renderer.Element.appendChild(this.editorArea);\n\n    this.selectionElement = document.createElement('div');\n    this.selectionElement.style.position = 'absolute';\n    this.selectionElement.style.border = `solid 2px ${COLOR_1}`;\n    this.selectionElement.style.overflow = 'hidden';\n    this.selectionElement.style.background = 'rgba(0,0,0,.1)';\n    this.selectionElement.style.transitionDuration = '.1s';\n    this.editorArea.appendChild(this.selectionElement);\n\n    this.editorElement = document.createElement('input');\n    this.editorElement.type = 'text';\n    this.editorElement.style.display = 'block';\n    this.editorElement.style.zIndex = '10000';\n    this.editorElement.style.position = 'absolute';\n    this.editorElement.style.background = '#fff';\n    this.editorElement.style.textIndent = '3px';\n    this.editorElement.style.border = 'none';\n\n    const forceEditMode = () => {\n      if (!this.EditMode) {\n        this.EditMode = true;\n      }\n    };\n\n    this.editorElement.addEventListener('click', forceEditMode);\n    this.editorElement.addEventListener('change', forceEditMode);\n    this.editorElement.addEventListener('touchstart', forceEditMode);\n\n    this.selectionElement.appendChild(this.editorElement);\n\n    this.anchorElement = document.createElement('span');\n    this.anchorElement.style.position = 'absolute';\n    this.anchorElement.style.right = '0';\n    this.anchorElement.style.bottom = '0';\n    this.anchorElement.style.width = '6px';\n    this.anchorElement.style.height = '6px';\n    this.anchorElement.style.borderRadius = '2px';\n    this.anchorElement.style.border = 'solid 1px #fff';\n    this.anchorElement.style.background = COLOR_2;\n    this.anchorElement.style.zIndex = '10000';\n    this.anchorElement.style.cursor = 'cell';\n    this.editorArea.appendChild(this.anchorElement);\n\n    this.websheet.addOnChange(() => {\n      const value = this.websheet.ActiveSheet.SelectedValue;\n      if (value != this.Value) {\n        this.Value = value;\n      }\n\n      this.updateEditorAppearance();\n      this.select(true);\n    });\n\n  }\n\n  public disableAnimation() {\n    this.selectionElement.style.transitionDuration = '';\n    this.anchorElement.style.transitionDuration = '';\n  }\n\n  public enableAnimation() {\n    this.selectionElement.style.transitionDuration = '.1s';\n    this.anchorElement.style.transitionDuration = '.1s';\n  }\n\n  public deselect() {\n    const cell = this.getCurrentCell();\n    if (this.IsDirty) {\n      this.controler.websheet.execCommand('change-value', cell.columnId, cell.rowId, this.Value);\n    }\n  }\n\n  public updateEditorAppearance() {\n    const app = this.getCurrentAppearance();\n\n    this.editorElement.style.textAlign = this.getTextAlign(app.textAlign);\n    this.editorElement.style.fontStyle = app.italic ? 'italic' : '';\n    this.editorElement.style.fontWeight = app.bold ? 'bold' : '';\n    this.editorElement.style.background = app.background;\n    this.editorElement.style.fontFamily = app.fontName;\n    this.editorElement.style.fontSize = `${app.fontSize}px`;\n    this.editorElement.style.color = app.text;\n    this.editorElement.style.textDecoration = app.underline ? 'underline' : '';\n  }\n\n  public select(animation = true) {\n    if (animation) {\n      this.enableAnimation();\n    } else {\n      this.disableAnimation();\n    }\n\n    this.updateEditorAppearance();\n\n    const sheet = this.controler.websheet.ActiveSheet;\n    const selection = sheet.selection;\n\n    const x1 = sheet.getColumnLeft(selection.left);\n    const y1 = sheet.getRowTop(selection.top);\n    const x2 = sheet.getColumnRight(selection.right);\n    const y2 = sheet.getRowBottom(selection.bottom);\n\n    const w = x2 - x1;\n    const h = y2 - y1;\n\n    this.selectionElement.style.left = (x1 - 2) + 'px';\n    this.selectionElement.style.top = (y1 - 2) + 'px';\n    this.selectionElement.style.width = (w - 2) + 'px';\n    this.selectionElement.style.height = (h - 2) + 'px';\n\n    const selectedCell = this.getCurrentCell();\n\n    const editorY = sheet.getRowTop(selection.rowId);\n    const editorX = sheet.getColumnLeft(selection.columnId);\n\n    this.editorElement.style.left = (editorX - x1) + 'px';\n    this.editorElement.style.top = (editorY - y1) + 'px';\n    this.editorElement.style.width = (sheet.getCellWidth(selectedCell) - 3) + 'px';\n    this.editorElement.style.height = (sheet.getCellHeight(selectedCell) - 3) + 'px';\n\n    this.editorElement.focus();\n\n    this.anchorElement.style.left = `${x2 - 5}px`;\n    this.anchorElement.style.top = `${y2 - 5}px`;\n\n  }\n\n  private getCurrentCell() {\n    const sheet = this.controler.websheet.ActiveSheet;\n    const selection = sheet.selection;\n    return sheet.getCell(selection.columnId, selection.rowId) || new Cell(selection.columnId, selection.rowId);\n  }\n\n  private getCurrentAppearance() {\n    const sheet = this.controler.websheet.ActiveSheet;\n    const selection = sheet.selection;\n    return sheet.getAppearance(selection.columnId, selection.rowId);\n  }\n\n  private getTextAlign(textAlign: TextAlign) {\n    if (textAlign == TextAlign.Center) { return 'center'; }\n    if (textAlign == TextAlign.Left) { return 'left'; }\n    if (textAlign == TextAlign.Right) { return 'right'; }\n    return '';\n  }\n\n}\n","///<reference path=\"../core/Sheet.ts\"/>\n///<reference path=\"./CellEditor.ts\"/>\n\nimport { Sheet } from '../core/Sheet';\nimport { UIHandlerController } from './UIHandlerControler';\n\n// import {CellEditor} from \"./CellEditor\"\n/**\n * Created by SiamandM on 6/17/2016.\n */\n\nexport interface IUIHandler {\n  click(): void;\n\n  dblClick(): void;\n\n  mouseDown(x: number, y: number): void;\n\n  mouseMove(x: number, y: number): void;\n\n  mouseUp(x: number, y: number): void;\n\n  mouseWheel(dx: number, dy: number): void;\n\n  keyDown(evt: any): void;\n\n  keyPress(evt: any): void;\n\n  keyUp(evt: any): void;\n}\n\nexport class UIHandler implements IUIHandler {\n  constructor(protected controller: UIHandlerController) {\n\n  }\n\n  public click() {\n  }\n\n  public dblClick() {\n  }\n\n  public mouseDown(x: number, y: number) {\n  }\n\n  public mouseMove(x: number, y: number) {\n  }\n\n  public mouseUp(x: number, y: number) {\n  }\n\n  public mouseWheel(dx: number, dy: number) {\n  }\n\n  public keyDown(evt: KeyboardEvent) {\n  }\n\n\n  public keyPress(evt: any) {\n  }\n\n  public keyUp(evt: any) {\n  }\n\n  get locked() {\n    return this.controller.locked;\n  }\n\n  public lock() {\n    this.controller.lock(this);\n  }\n\n  public unlock() {\n    this.controller.unlock();\n  }\n\n}\n","import { UIHandler } from './UIHandler';\nimport { SheetTitleHeight, RowHeaderWidth, SheetTitleWidth } from '../common/constants';\n\nexport class WebSheetUIHandler extends UIHandler {\n\n  public mouseUp(x: number, y: number) {\n    if (y < this.controller.renderer.Element.clientHeight - SheetTitleHeight) {\n      return;\n    }\n\n    const j = Math.floor((x - RowHeaderWidth) / (SheetTitleWidth + 5));\n    const n = (x - RowHeaderWidth) % (SheetTitleWidth + 5);\n    if (n < SheetTitleWidth && j < this.controller.websheet.Sheets.length) {\n      this.controller.changeActiveSheet(j);\n    }\n  }\n\n\n}\n","import { UIHandler } from './UIHandler';\nimport { ColumnHeaderHeight, RowHeaderWidth, SheetTitleHeight } from '../common/constants';\nimport { UIHandlerController } from '@/lib/editor/UIHandlerControler';\nimport { Sheet } from '@/lib/core/Sheet';\n\nexport class SheetUIHandler extends UIHandler {\n\n  private wheelDeltaX: number = 0;\n  private wheelDeltaY: number = 0;\n\n  private oldX!: number;\n  private oldY!: number;\n  private sheet: Sheet;\n\n  constructor(controller: UIHandlerController) {\n    super(controller);\n    this.sheet = controller.websheet.ActiveSheet;\n  }\n\n  public mouseWheel(dx: number, dy: number) {\n\n    this.wheelDeltaX += dx;\n    this.wheelDeltaY += dy;\n\n    const websheet = this.controller.websheet;\n    const sheet = websheet.ActiveSheet;\n    const delta = 120;\n\n    if (this.wheelDeltaX > delta) {\n      sheet.scrollRight();\n      this.wheelDeltaX = 0;\n    } else if (this.wheelDeltaX < -delta) {\n      sheet.scrollLeft();\n      this.wheelDeltaX = 0;\n    }\n\n    if (this.wheelDeltaY > delta) {\n      sheet.scrollUp();\n      this.wheelDeltaY = 0;\n    } else if (this.wheelDeltaY < -delta) {\n      sheet.scrollDown();\n      this.wheelDeltaY = 0;\n    }\n    this.controller.renderer.render();\n    this.controller.select();\n\n  }\n\n  public mouseDown(x: number, y: number) {\n    this.oldX = x;\n    this.oldY = y;\n  }\n\n  public mouseUp(x: number, y: number) {\n    this.selectCell(x, y);\n  }\n\n  public keyPress(evt: KeyboardEvent) {\n    if (evt.key == 'Enter') {\n      if (!this.controller.EditMode) {\n        this.controller.EditMode = true;\n        return;\n      } else {\n        this.controller.commit();\n        this.controller.EditMode = false;\n      }\n      if (evt.shiftKey) {\n        this.sheet.selectPreviousRowCell();\n      } else {\n        this.sheet.selectNextRowCell();\n      }\n    }\n  }\n\n  public keyDown(evt: KeyboardEvent) {\n    if (evt.key == 'Tab') {\n      this.controller.deselect();\n      if (evt.shiftKey) {\n        this.sheet.selectPreviousColumnCell();\n      } else {\n        this.sheet.selectNextColumnCell();\n      }\n      evt.preventDefault();\n      this.controller.select(true);\n    }\n    if (this.controller.EditMode) {\n      return;\n    }\n    if (evt.key == 'ArrowRight' || evt.key == 'ArrowLeft' || evt.key == 'ArrowUp' || evt.key == 'ArrowDown') {\n      this.controller.deselect();\n      if (evt.key == 'ArrowRight') {\n        this.sheet.selectNextColumnCell();\n      } else if (evt.key == 'ArrowLeft') {\n        this.sheet.selectPreviousColumnCell();\n      } else if (evt.key == 'ArrowUp') {\n        this.sheet.selectPreviousRowCell();\n      } else if (evt.key == 'ArrowDown') {\n        this.sheet.selectNextRowCell();\n      }\n      evt.preventDefault();\n      this.controller.select(true);\n    }\n  }\n\n  public dblClick() {\n    if (!this.controller.EditMode) {\n      this.controller.EditMode = true;\n    }\n  }\n\n  private selectCell(x: number, y: number) {\n    if (y < ColumnHeaderHeight || x < RowHeaderWidth) {\n      return;\n    }\n    if (y > this.controller.renderer.Element.clientHeight - SheetTitleHeight) {\n      return;\n    }\n    const sheet = this.controller.websheet.ActiveSheet;\n    const x1 = this.oldX - RowHeaderWidth;\n    const y1 = this.oldY - ColumnHeaderHeight;\n    const x2 = x - RowHeaderWidth;\n    const y2 = y - ColumnHeaderHeight;\n    this.controller.deselect();\n    sheet.selectByXY(x1, y1, x2, y2);\n    this.controller.select(true);\n  }\n\n}\n","import { UIHandler } from './UIHandler';\nimport { RowHeaderWidth, ColumnHeaderHeight } from '../common/constants';\n\nconst delta = 4;\n\nexport class ResizeHandler extends UIHandler {\n\n  private col: any;\n  private row: any;\n  private oldX!: number;\n  private oldY!: number;\n  private engaged = false;\n\n  public mouseMove(x: number, y: number) {\n    const c = this.hitColumn(x - RowHeaderWidth, y);\n    const r = this.hitRow(x, y - ColumnHeaderHeight);\n    if (c !== false) {\n      this.controller.changeCursor('col-resize');\n    } else if (r !== false) {\n      this.controller.changeCursor('row-resize');\n    } else if (!this.engaged) {\n      this.controller.resetCursor();\n    }\n  }\n\n  public mouseDown(x: number, y: number) {\n    this.col = this.hitColumn(x - RowHeaderWidth, y);\n    this.row = this.hitRow(x, y - ColumnHeaderHeight);\n    this.oldX = x;\n    this.oldY = y;\n    if (this.col !== false || this.row !== false) {\n      this.lock();\n\n      if (this.col !== false) {\n        this.controller.changeCursor('col-resize');\n      } else if (this.row !== false) {\n        this.controller.changeCursor('row-resize');\n      }\n      this.engaged = true;\n    } else {\n      this.engaged = false;\n    }\n  }\n\n  public mouseUp(x: number, y: number) {\n    if (!this.engaged) { return; }\n    if (this.col !== false) {\n      this.controller.alterColumn(this.col, x - this.oldX);\n      this.controller.resetCursor();\n    }\n\n    if (this.row !== false) {\n      this.controller.alterRow(this.row, y - this.oldY);\n      this.controller.resetCursor();\n    }\n\n    this.unlock();\n  }\n\n  private hitRow(x: number, y: number): any {\n    if (x > RowHeaderWidth) { return false; }\n    const rowH = (r: any) => this.controller.websheet.ActiveSheet.getRowHeight(r);\n    let j = 0;\n    for (let i = rowH(j++); i < y + delta; i += rowH(j++)) {\n      if ((y > (i - delta)) && (y < (i + delta))) {\n        return j - 1;\n      }\n    }\n\n    return false;\n  }\n\n  private hitColumn(x: number, y: number): any {\n    if (y > ColumnHeaderHeight) { return false; }\n    const colW = (c: any) => this.controller.websheet.ActiveSheet.getColumnWidth(c);\n    let j = 0;\n    for (let i = colW(j++); i < x + delta; i += colW(j++)) {\n      if ((x > (i - delta)) && (x < (i + delta))) {\n        return j - 1;\n      }\n    }\n\n    return false;\n  }\n}\n","import { UIHandler } from './UIHandler';\nimport { CellEditor } from './CellEditor';\nimport { WebSheetUIHandler } from './DocumentHandler';\nimport { SheetUIHandler } from './SheetUIHandler';\nimport { OpenDocument } from '../core/Document';\nimport { DocumentRenderer } from '../rendering/DocumentRenderer';\nimport { ResizeHandler } from './ResizeHandler';\n\nexport class UIHandlerController {\n\n  public get EditMode() {\n    return this.cellEditor.EditMode;\n  }\n\n  public set EditMode(mode: boolean) {\n    this.cellEditor.EditMode = mode;\n  }\n\n  get locked() {\n    return !!this.lockedOn;\n  }\n\n  private handlers: UIHandler[] = [];\n  private lockedOn: UIHandler | null = null;\n  private cellEditor!: CellEditor;\n\n  constructor(public websheet: OpenDocument, public renderer: DocumentRenderer) {\n    this.cellEditor = new CellEditor(this);\n    this.addHandlers();\n    this.attachEvents();\n    websheet.addOnChange(() => this.cellEditor.updateEditorAppearance());\n  }\n\n  public select(animation: boolean = true) {\n    this.cellEditor.select(animation);\n  }\n\n  public deselect() {\n    this.cellEditor.deselect();\n  }\n\n  public alterColumn(columnId: number, delta: number) {\n    this.websheet.execCommand('alter-column', columnId, delta);\n  }\n\n  public alterRow(rowId: number, delta: number) {\n    this.websheet.execCommand('alter-row', rowId, delta);\n  }\n\n  public lock(uiHandler: UIHandler) {\n    this.lockedOn = uiHandler;\n  }\n\n  public unlock() {\n    this.lockedOn = null;\n  }\n\n  public resetCursor() {\n    this.renderer.Element.style.cursor = '';\n  }\n\n  public changeCursor(cursor: string) {\n    this.renderer.Element.style.cursor = cursor;\n  }\n\n  public attachEvents() {\n    const element = this.renderer.Element;\n    const overlay = document.createElement('div');\n    overlay.style.position = 'absolute';\n    overlay.style.top = '0';\n    overlay.style.left = '0';\n    overlay.style.right = '0';\n    overlay.style.bottom = '0';\n    overlay.style.zIndex = '9999';\n    element.appendChild(overlay);\n\n    const controler = this;\n\n    const getXY = function(evt: MouseEvent) {\n      const x = evt.offsetX || evt.layerX || (evt.clientX - element.offsetLeft);\n      const y = evt.offsetY || evt.layerY || (evt.clientY - element.offsetTop);\n\n      return {x, y};\n    };\n\n    const getTouchXY = function(evt: TouchEvent) {\n      const touch = evt.touches.length ? evt.touches[0] : evt.changedTouches[0];\n      const x = touch.clientX - element.offsetLeft;\n      const y = touch.clientY - element.offsetTop;\n      return {x, y};\n    };\n\n    overlay.addEventListener('touchstart', (evt: TouchEvent) => {\n      if (evt.touches.length == 1) {\n        const pos = getTouchXY(evt);\n        controler.mouseDown(pos.x, pos.y);\n        evt.preventDefault();\n      }\n    });\n\n    overlay.addEventListener('touchmove', (evt: TouchEvent) => {\n        const pos = getTouchXY(evt);\n        controler.mouseMove(pos.x, pos.y);\n    });\n\n    overlay.addEventListener('touchend', (evt: TouchEvent) => {\n        const pos = getTouchXY(evt);\n        controler.mouseUp(pos.x, pos.y);\n    });\n\n    overlay.addEventListener('touchcancel', (evt: TouchEvent) => {\n      const pos = getTouchXY(evt);\n      controler.mouseUp(pos.x, pos.y);\n    });\n\n    overlay.addEventListener('mousedown', (evt: MouseEvent) => {\n      const pos = getXY(evt);\n      controler.mouseDown(pos.x, pos.y);\n    });\n\n    overlay.addEventListener('mousemove', (evt: MouseEvent) => {\n      const pos = getXY(evt);\n      controler.mouseMove(pos.x, pos.y);\n    });\n\n    overlay.addEventListener('mouseup', (evt: MouseEvent) => {\n      const pos = getXY(evt);\n      controler.mouseUp(pos.x, pos.y);\n    });\n\n    overlay.addEventListener('click', (evt: MouseEvent) => controler.click());\n    overlay.addEventListener('dblclick', (evt: MouseEvent) => controler.dblClick());\n    overlay.addEventListener('mousewheel', (evt: any) => {\n      const dx = evt.wheelDeltaX;\n      const dy = evt.wheelDeltaY;\n      controler.mouseWheel(dx, dy);\n      evt.preventDefault();\n      evt.stopPropagation();\n      return false;\n    });\n\n    window.addEventListener('keydown', (evt: any) => controler.keyDown(evt));\n    window.addEventListener('keypress', (evt: any) => controler.keyPress(evt));\n    window.addEventListener('keyup', (evt: any) => controler.keyUp(evt));\n    window.addEventListener('resize', () => this.renderer.resize());\n\n  }\n\n  public click() {\n    if (this.lockedOn) {\n      this.lockedOn.click();\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].click();\n    }\n  }\n\n  public dblClick() {\n    if (this.lockedOn) {\n      this.lockedOn.dblClick();\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].dblClick();\n    }\n  }\n\n  public mouseDown(x: number, y: number) {\n    if (this.lockedOn) {\n      this.lockedOn.mouseDown(x, y);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].mouseDown(x, y);\n    }\n  }\n\n  public mouseMove(x: number, y: number) {\n    if (this.lockedOn) {\n      this.lockedOn.mouseMove(x, y);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].mouseMove(x, y);\n    }\n  }\n\n  public mouseUp(x: number, y: number) {\n    if (this.lockedOn) {\n      this.lockedOn.mouseUp(x, y);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].mouseUp(x, y);\n    }\n  }\n\n  public mouseWheel(dx: number, dy: number) {\n    if (this.lockedOn) {\n      this.lockedOn.mouseWheel(dx, dy);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].mouseWheel(dx, dy);\n    }\n  }\n\n  public keyDown(evt: any) {\n    if (this.lockedOn) {\n      this.lockedOn.keyDown(evt);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].keyDown(evt);\n    }\n  }\n\n  public keyPress(evt: any) {\n    if (this.lockedOn) {\n      this.lockedOn.keyPress(evt);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].keyPress(evt);\n    }\n  }\n\n  public keyUp(evt: any) {\n    if (this.lockedOn) {\n      this.lockedOn.keyUp(evt);\n      return;\n    }\n\n    for (let i = 0; i < this.handlers.length; i++) {\n      this.handlers[i].keyUp(evt);\n    }\n  }\n\n  public changeActiveSheet(index: number) {\n    this.cellEditor.deselect();\n    this.websheet.ActiveSheetIndex = index;\n    this.cellEditor.select(false);\n  }\n\n  public commit() {\n    this.cellEditor.deselect();\n    this.cellEditor.select(false);\n  }\n\n  private addHandlers() {\n    this.handlers.push(new WebSheetUIHandler(this));\n    this.handlers.push(new SheetUIHandler(this));\n    this.handlers.push(new ResizeHandler(this));\n  }\n}\n","import { OpenDocument } from './core/Document';\nimport { DocumentRenderer } from './rendering/DocumentRenderer';\nimport { CanvasRenderer } from './rendering/canvas/CanvasRendering';\nimport { UIHandlerController } from './editor/UIHandlerControler';\n\nexport class UI {\n\n  get isMerged() {\n    const cell = this.selectedCell;\n    if (!cell) { return false; }\n    return (cell.colSpan > 1) || (cell.rowSpan > 1);\n  }\n\n  public get selectedCell() {\n    return this.document.ActiveSheet.selectedCell;\n  }\n\n  public get SelectedCellLabel() {\n    return this.document.ActiveSheet.SelectionLabel;\n  }\n\n  public get SelectedValue() {\n    return this.document.ActiveSheet.SelectedValue;\n  }\n\n  public get SelectedAppearance() {\n    return this.document.ActiveSheet.SelectedAppearance;\n  }\n\n  private handlers: Array<(doc: OpenDocument) => void> = [];\n  private document: OpenDocument = new OpenDocument();\n  private readonly render: DocumentRenderer | null = null;\n  private uiController: UIHandlerController;\n\n  public constructor(private element: HTMLElement) {\n    this.render = new CanvasRenderer(element, this.document);\n    this.uiController = new UIHandlerController(this.document, this.render);\n    this.document.addOnChange(() => this.raiseOnChangeEventListener());\n    this.render.render();\n\n    (element as any).openDocument = this.document;\n  }\n\n  public execCmd(cmd: string, ...args: any[]) {\n    console.log(`the command _${cmd}_ executed.`);\n    this.uiController.commit();\n    this.document.execCommand(cmd, ...args);\n  }\n\n  public addOnChangeEventListener(handler: (doc: OpenDocument) => void) {\n    this.handlers.push(handler);\n  }\n\n  public removeOnChangeEventListener(handler: (doc: OpenDocument) => void) {\n    const ix = this.handlers.indexOf(handler);\n    if (ix != -1) {\n      this.handlers.splice(ix, 1);\n    }\n  }\n\n  public save() {\n    return JSON.stringify(this.document.save());\n  }\n\n  public load(data: any) {\n    const obj = JSON.parse(data);\n    this.document.load(obj);\n  }\n\n  private raiseOnChangeEventListener() {\n    this.handlers.forEach((handler) => handler(this.document));\n  }\n}\n","\n\n\n\n\nimport { Component } from 'vue-property-decorator';\nimport Vue from 'vue';\nimport { UI } from '@/lib/UI';\nimport { OpenDocument } from '@/lib/core/Document';\n\n@Component({name: 'OpenSheet'})\nexport default class OpenSheet extends Vue {\n  private ui!: UI;\n\n  public execute(command: string, args?: any) {\n    this.ui.execCmd(command, args);\n  }\n\n  public load(file: string) {\n    this.ui.load(file);\n  }\n\n  public mounted() {\n    this.ui = new UI(this.$refs['canvas-container'] as HTMLElement);\n    this.$emit('ready', this.ui);\n    this.ui.addOnChangeEventListener((doc: OpenDocument) => {\n      this.$emit('change', doc);\n    });\n  }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./OpenSheet.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./OpenSheet.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./OpenSheet.vue?vue&type=template&id=6835bc7c&scoped=true&\"\nimport script from \"./OpenSheet.vue?vue&type=script&lang=ts&\"\nexport * from \"./OpenSheet.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./OpenSheet.vue?vue&type=style&index=0&id=6835bc7c&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6835bc7c\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_vm._v(\"Sheets1 | Sheet 2 | Sheet 3\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div>Sheets1 | Sheet 2 | Sheet 3</div>\n</template>\n\n<script>\n  export default {\n    name: \"SheetSelector\"\n  }\n</script>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SheetSelector.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SheetSelector.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SheetSelector.vue?vue&type=template&id=0be19af6&\"\nimport script from \"./SheetSelector.vue?vue&type=script&lang=js&\"\nexport * from \"./SheetSelector.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"status-bar\"})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\nexport default {\n  name: 'StatusBar',\n};\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./StatusBar.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./StatusBar.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./StatusBar.vue?vue&type=template&id=2c4dd48e&scoped=true&\"\nimport script from \"./StatusBar.vue?vue&type=script&lang=ts&\"\nexport * from \"./StatusBar.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./StatusBar.vue?vue&type=style&index=0&id=2c4dd48e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2c4dd48e\",\n  null\n  \n)\n\nexport default component.exports","\nimport { Component, Vue } from 'vue-property-decorator';\nimport RibbonMenu from '@/RibbonMenu.vue';\nimport FormulaBar from '@/FormulaBar.vue';\nimport OpenSheet from '@/OpenSheet.vue';\nimport SheetSelector from '@/SheetSelector.vue';\nimport StatusBar from '@/StatusBar.vue';\nimport { OpenDocument } from '@/lib/core/Document';\nimport { UI } from '@/lib/UI';\nimport { Appearance } from '@/lib/core/Appearance';\n\n@Component({\n  components: {\n    StatusBar,\n    SheetSelector,\n    OpenSheet,\n    FormulaBar,\n    RibbonMenu,\n  },\n})\nexport default class App extends Vue {\n  private uiManager!: UI;\n  private appearance: Appearance = new Appearance();\n  private fileMode: 'local' | 'file' = 'file';\n  private state = {\n    isMerged: false,\n    label: 'A1',\n    value: null,\n    originalValue: null,\n  };\n\n  public onReady(ui: UI) {\n    this.uiManager = ui;\n  }\n\n  public onChange(doc: OpenDocument) {\n    this.appearance = doc.ActiveSheet.SelectedAppearance;\n    this.state.isMerged = this.uiManager.isMerged;\n    this.state.label = doc.ActiveSheet.SelectionLabel;\n    this.state.value = doc.ActiveSheet.SelectedValue;\n    this.state.originalValue = doc.ActiveSheet.SelectedValue;\n\n    if (this.fileMode === 'local') {\n      localStorage.setItem('data', JSON.stringify(doc.save()));\n    }\n  }\n\n  public onCommit() {\n    if (this.state.value !== this.state.originalValue) {\n      this.uiManager.execCmd('change-value', null, null, this.state.value);\n    }\n  }\n\n  public onAbort() {\n    this.state.value = this.state.originalValue;\n  }\n\n  public onAction({actionName, args}: { actionName: string, args: any }) {\n    if (actionName === 'save-ows') {\n      this.onSave();\n      return;\n    } else if (actionName === 'load-ows') {\n      this.onLoad();\n      return;\n    }\n    this.uiManager.execCmd(actionName, args);\n  }\n\n  public onModeChanged(newMode: 'file' | 'local') {\n    if (this.fileMode === 'file' && localStorage.getItem('data') !== null) {\n      (this.$refs.sheet as any).load(localStorage.getItem('data'));\n    }\n    this.fileMode = newMode;\n  }\n\n  public onLoad() {\n    const win = window as any;\n    const ui = this.uiManager;\n\n    if (win.File && win.FileReader && win.FileList && win.Blob) {\n      const f = document.createElement('input');\n      f.type = 'file';\n      f.accept = '.ows';\n      f.addEventListener('change', function(evt: any) {\n        const file = evt.target.files[0];\n        const reader = new FileReader();\n        reader.addEventListener('load', function(loadEvt: any) {\n          const rawData = loadEvt.target.result;\n          ui.load(rawData);\n        });\n        reader.readAsText(file, 'utf8');\n      });\n      f.click();\n    } else {\n      alert('The File APIs are not fully supported in this browser.');\n    }\n  }\n\n  public onSave() {\n    const content = this.uiManager.save();\n    const uriContent = 'data:application/octet-stream,' + encodeURIComponent(content);\n    const a = document.createElement('a');\n    a.download = 'document.ows';\n    a.href = uriContent;\n    a.target = '_blank';\n    a.click();\n  }\n\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=98553306&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","/* tslint:disable:no-console */\n\nimport { register } from 'register-service-worker';\n\nif (process.env.NODE_ENV === 'production') {\n  register(`service-worker.js`, {\n    ready() {\n      console.log(\n        'App is being served from cache by a service worker.\\n' +\n        'For more details, visit https://goo.gl/AFskqB',\n      );\n    },\n    registered() {\n      console.log('Service worker has been registered.');\n    },\n    cached() {\n      console.log('Content has been cached for offline use.');\n    },\n    updatefound() {\n      console.log('New content is downloading.');\n    },\n    updated() {\n      console.log('New content is available; please refresh.');\n    },\n    offline() {\n      console.log('No internet connection found. App is running in offline mode.');\n    },\n    error(error) {\n      console.error('Error during service worker registration:', error);\n    },\n  });\n}\n","import Vue from 'vue';\nimport App from './App.vue';\nimport './registerServiceWorker';\n\nVue.config.productionTip = false;\n\nnew Vue({\n  render: (h) => h(App),\n}).$mount('#app');\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ribbon.vue?vue&type=style&index=0&id=244e0240&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Ribbon.vue?vue&type=style&index=0&id=244e0240&lang=scss&scoped=true&\""],"sourceRoot":""}